# <font color =red>ã€0ã€‘RockyåŸºç¡€æ“ä½œ</font>

## ã€1ã€‘Rockyå¿˜è®°è´¦æˆ·å¯†ç 
æ­¤æ•™ç¨‹é€‚ç”¨äºRocky Linuxï¼Œå…¶ä½™å‘è¡Œç‰ˆè‡ªè¡Œå°è¯•æˆ–è‡ªå·±å»æ‰¾æ•™ç¨‹
ä½¿ç”¨rootè´¦æˆ·ä¸¾ä¾‹
é¦–å…ˆé‡å¯ä½ çš„linuxè™šæ‹Ÿæœº
![4ed62914f7d7261ed7b6ed531588be90.png](https://s1.imagehub.cc/images/2023/12/04/4ed62914f7d7261ed7b6ed531588be90.png)
å½“å‡ºç°è¿™ä¸ªç•Œé¢æ—¶ï¼ŒæŒ‰ä¸‹"e"é”®
å¯ä»¥çœ‹ä¸‹æ–¹ç¬¬2è¡Œå•å¼•å·å†…çš„é”®ä½ï¼Œæ˜¯ä»€ä¹ˆé”®æŒ‰ä»€ä¹ˆé”®å°±å¯ä»¥
![57f6732fb219d3ff3e1b48e6dcd51e51.png](https://s1.imagehub.cc/images/2023/12/04/57f6732fb219d3ff3e1b48e6dcd51e51.png)
å‡ºç°è¿™ä¸ªç•Œé¢å°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œäº†
![e4cea1e6e25e5f919ae36908af898515.png](https://s1.imagehub.cc/images/2023/12/04/e4cea1e6e25e5f919ae36908af898515.png)
ç„¶ååœ¨ç¬¬6è¡Œæœ«å°¾çš„"rhgb quiet"ä¸­é—´å†™å…¥`init=/bin/bash`
![3334f396d55ec3afe3b964d022d5a166.png](https://s1.imagehub.cc/images/2023/12/04/3334f396d55ec3afe3b964d022d5a166.png)
ä¿®æ”¹å¥½åï¼š
![478925bd5f6091599fb63b95b77d14ac.png](https://s1.imagehub.cc/images/2023/12/04/478925bd5f6091599fb63b95b77d14ac.png)
å†æŠŠç¬¬5è¡Œè¡Œé¦–çš„"ro"ä¿®æ”¹ä¸º`rw`
![90aff59ae1299e96da5a20562c2c0c90.png](https://s1.imagehub.cc/images/2023/12/04/90aff59ae1299e96da5a20562c2c0c90.png)
ä¿®æ”¹å¥½åï¼š
![d58b392ee0557eb164a2933b27b4885d.png](https://s1.imagehub.cc/images/2023/12/04/d58b392ee0557eb164a2933b27b4885d.png)
ä¸¤å¤„å…¨éƒ¨ä¿®æ”¹å®Œæ¯•åï¼ŒæŒ‰ä¸‹Ctrl+Xæ¥å¯åŠ¨å½“å‰ä¿®æ”¹å®Œæˆçš„é…ç½®
æ¥åˆ°æ­¤å¤„ç•Œé¢åï¼Œç›´æ¥è¾“å…¥`paawd`æ›´æ”¹rootè´¦æˆ·å¯†ç 
![56dabb66b0d44119a59b99041fc909d1.png](https://s1.imagehub.cc/images/2023/12/04/56dabb66b0d44119a59b99041fc909d1.png)
è¾“å…¥`passwd`åï¼Œè¾“å…¥2éå¯†ç ï¼Œæç¤º"updated successfully"å³ä¿®æ”¹æˆåŠŸ
![df180eee2b8d11c6273abf003aca78ad.png](https://s1.imagehub.cc/images/2023/12/04/df180eee2b8d11c6273abf003aca78ad.png)
å¦‚æœæ˜¯ä¿®æ”¹å…¶ä»–è´¦æˆ·çš„å¯†ç ï¼Œé‚£å°±è¾“å…¥`passwd username`å³å¯
å¦‚æœè¿˜å¼€å¯äº†SELinuxï¼Œé‚£ä¹ˆè¿˜è¦è®¾ç½®SElinuxé‡å¯æ ‡è®°
å‘½ä»¤ï¼š`touch /.autorelabel`
ç„¶åé‡å¯å°±ä¿®æ”¹å¥½äº†
å‘½ä»¤ï¼š`exec /sbin/init`
é‡å¯å®Œæ¯•åï¼Œè¾“å…¥rootç”¨æˆ·ååŠåˆšåˆšä¿®æ”¹çš„å¯†ç ï¼Œå°±èƒ½æˆåŠŸç™»å…¥äº†
![259744e5ddf4862ae91be0b132630379.png](https://s1.imagehub.cc/images/2023/12/04/259744e5ddf4862ae91be0b132630379.png)

## ã€2ã€‘ä¿®æ”¹ä¸»æœºåç§°
**1-ä¸´æ—¶ä¿®æ”¹ä¸»æœºåç§°ï¼š**
å‘½ä»¤ï¼š`hostname name`
åœ¨ä¸‹ä¸€æ¬¡è¿æ¥æ—¶ç”Ÿæ•ˆ
![e0c7352996f7de02376aa61434b205dc.png](https://s1.imagehub.cc/images/2023/12/05/e0c7352996f7de02376aa61434b205dc.png)
é‡æ–°è¿æ¥åç”Ÿæ•ˆï¼š
![05cafeccda9e4b0853733c62675c907a.png](https://s1.imagehub.cc/images/2023/12/05/05cafeccda9e4b0853733c62675c907a.png)
é‡å¯åå¤±æ•ˆï¼š
![f94d6814486f1b725158adfe037de42a.png](https://s1.imagehub.cc/images/2023/12/05/f94d6814486f1b725158adfe037de42a.png)

**2-æ°¸ä¹…ä¿®æ”¹ä¸»æœºåç§°ï¼š**
1):ä¿®æ”¹ä¸»æœºåç§°é…ç½®æ–‡ä»¶
ç›´æ¥åœ¨hostnameæ–‡ä»¶å†…å†™å…¥åç§°å³å¯
`vi /etc/hostname`

2):å‘½ä»¤ä¿®æ”¹
1ï¼š`hostnamectl set-hostname --static "hostname"`
2ï¼š`hostnamectl set-hostname hostname`
è¿™ä¸¤è¡Œä»£ç éƒ½å¯ä»¥ä¿®æ”¹ä¸»æœºåç§°ï¼Œç¬¬1è¡Œæ˜¯æŠŠä¸»æœºåå’Œæ˜µç§°éƒ½ä¿®æ”¹ä¸ºä¸€è‡´äº†
ç¬¬2è¡Œä»…ä»…æ˜¯ä¿®æ”¹ä¸»æœºåç§°ï¼Œå¹¶æ²¡æœ‰ä¿®æ”¹ä¸»æœºæ˜µç§°
ä¿®æ”¹ä¸»æœºæ˜µç§°å‘½ä»¤ï¼š`hostnamectl set-hostname --pretty "name"`
![97897a155871a2c1af43a736610865a2.png](https://s1.imagehub.cc/images/2023/12/05/97897a155871a2c1af43a736610865a2.png)
æŸ¥çœ‹ä¸»æœºåå‘½ä»¤ï¼š`hostnamectl`æˆ–`hostname`å‡å¯
![e0bde274ea535091a6151d1d42c01ad4.png](https://s1.imagehub.cc/images/2023/12/05/e0bde274ea535091a6151d1d42c01ad4.png)

3):å›¾å½¢åŒ–ç•Œé¢ä¿®æ”¹
å‘½ä»¤ï¼š`nmtui`
ä½¿ç”¨å°ç®­å¤´é€‰æ‹©åˆ°"è®¾ç½®ç³»ç»Ÿä¸»æœºå"ï¼Œç„¶åå›è½¦
![9ce30cd852cce8737a6db7723f6437d3.png](https://s1.imagehub.cc/images/2023/12/05/9ce30cd852cce8737a6db7723f6437d3.png)
è¾“å…¥ä¸»æœºå
![f02255b72fee85b4dc9cc4adfc382c56.png](https://s1.imagehub.cc/images/2023/12/05/f02255b72fee85b4dc9cc4adfc382c56.png)
ç„¶åç”¨å°æ–¹å‘é”®é€‰æ‹©åˆ°"ç¡®å®š"ï¼Œå›è½¦å³å¯
![473c3695ff1cdfb35cd93d19fb5d1bb2.png](https://s1.imagehub.cc/images/2023/12/05/473c3695ff1cdfb35cd93d19fb5d1bb2.png)
![9d5b7b6bd5d47b061104708d337844b5.png](https://s1.imagehub.cc/images/2023/12/05/9d5b7b6bd5d47b061104708d337844b5.png)

## ã€3ã€‘å…³é—­SELinux
**1-ä»€ä¹ˆæ˜¯SELinuxï¼š**
è‡ªè¡Œè·³è½¬ï¼š
[çŸ¥ä¹-ä¸€æ–‡å½»åº•æ˜ç™½linuxä¸­çš„selinuxåˆ°åº•æ˜¯ä»€ä¹ˆ](https://zhuanlan.zhihu.com/p/165974960 "çŸ¥ä¹-ä¸€æ–‡å½»åº•æ˜ç™½linuxä¸­çš„selinuxåˆ°åº•æ˜¯ä»€ä¹ˆ")
[çº¢å¸½-ä»€ä¹ˆæ˜¯SELinuxï¼Ÿ](https://www.redhat.com/zh/topics/linux/what-is-selinux#:~:text=%E5%AE%89%E5%85%A8%E5%A2%9E%E5%BC%BA%E5%9E%8B%20Linux%EF%BC%88SELinux%EF%BC%89%E7%94%B1%E7%BE%8E%E5%9B%BD%E5%9B%BD%E5%AE%B6%E5%AE%89%E5%85%A8%E5%B1%80%EF%BC%88NSA%EF%BC%89%E5%88%A9%E7%94%A8%20Linux,%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9D%97%EF%BC%88LSM%EF%BC%89%E5%BC%80%E5%8F%91%E8%80%8C%E6%88%90%EF%BC%8C%E6%98%AF%E4%B8%80%E7%A7%8D%E9%87%87%E7%94%A8%E5%AE%89%E5%85%A8%E6%9E%B6%E6%9E%84%E7%9A%84%20Linux%20%E7%B3%BB%E7%BB%9F%EF%BC%8C%E8%83%BD%E5%A4%9F%E8%AE%A9%E7%AE%A1%E7%90%86%E5%91%98%E6%9B%B4%E5%A5%BD%E5%9C%B0%E7%AE%A1%E6%8E%A7%E5%93%AA%E4%BA%9B%E4%BA%BA%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E7%B3%BB%E7%BB%9F%E3%80%82 "çº¢å¸½-ä»€ä¹ˆæ˜¯SELinuxï¼Ÿ")

**2-æŸ¥çœ‹SELinuxçŠ¶æ€ï¼š**
å‘½ä»¤ï¼š`cat /etc/selinux/config`
æˆ–`cat /etc/sysconfig/selinux`
æˆ–`getenforce`
cat /etc/selinux/configï¼š
![97e5aade9ab412a28380afe1aea7ba5a.png](https://s1.imagehub.cc/images/2023/12/05/97e5aade9ab412a28380afe1aea7ba5a.png)
cat /etc/sysconfig/selinuxï¼š
![329eeba84f69e44d0d01a3a5c4c5a131.png](https://s1.imagehub.cc/images/2023/12/05/329eeba84f69e44d0d01a3a5c4c5a131.png)
getenforceï¼š
![b6b3d1672c550a56a1af206cc7d270a2.png](https://s1.imagehub.cc/images/2023/12/05/b6b3d1672c550a56a1af206cc7d270a2.png)
**SELinuxçŠ¶æ€æœ‰3ç§ï¼š**
|SELinuxè¿è¡ŒçŠ¶æ€|å¤‡æ³¨|setenforceé€‰é¡¹|
|---|---|---|
|enforcing|æ‰§è¡Œä¸­|1|
|permissive|ä¸æ‰§è¡Œä½†äº§ç”Ÿè­¦å‘Š|0|
|disabled|å…³é—­|/|

**2-ä¸´æ—¶å…³é—­SELinuxï¼š**
é‡å¯åå¤±æ•ˆ
å‘½ä»¤ï¼š`setenforce 0`

**3-æ°¸ä¹…å…³é—­SELinuxï¼š**
ç¼–å†™SELinuxé…ç½®æ–‡ä»¶`vi /etc/sysconfig/selinux`æˆ–`vi /etc/selinux/config`
å°†22è¡Œçš„`enforcing`ä¿®æ”¹ä¸º`disabled`å³å¯
![b77038efaad236aaa5ffbc84a5a96f04.png](https://s1.imagehub.cc/images/2023/12/05/b77038efaad236aaa5ffbc84a5a96f04.png)
é‡å¯åç”Ÿæ•ˆ
![9b86b4f26bfb4685c84ac71e1bbee732.png](https://s1.imagehub.cc/images/2023/12/05/9b86b4f26bfb4685c84ac71e1bbee732.png)

## ã€4ã€‘æ›´æ¢yumæº
Rockyé»˜è®¤çš„yumæºæœ‰æ—¶ä¸æ˜¯å›½å†…é•œåƒï¼Œå¯¼è‡´yumåœ¨çº¿å®‰è£…æˆ–æ›´æ–°æ—¶é€Ÿåº¦ä¸æ˜¯å¾ˆç†æƒ³ï¼Œè¿™æ—¶å€™éœ€è¦å°†yumæºè®¾ç½®ä¸ºå›½å†…é•œåƒç«™ç‚¹
### ã€1ã€‘é˜¿é‡Œé•œåƒæº
é¦–å…ˆæ‰“å¼€é˜¿é‡ŒRocky Linuxé•œåƒç«™
[é˜¿é‡Œäº‘-Rocky Linuxé•œåƒç«™](https://developer.aliyun.com/mirror/rockylinux?spm=a2c6h.13651102.0.0.6bd71b11GzHnmv "é˜¿é‡Œäº‘-Rocky Linuxé•œåƒç«™")
ç„¶åå¤åˆ¶å…¶æä¾›çš„ä»£ç 
![e4c1b7316fd60f61e144889513323946.png](https://s1.imagehub.cc/images/2023/12/06/e4c1b7316fd60f61e144889513323946.png)
**CVå·¥ç¨‹å¸ˆç¦åˆ©ï¼š**

```
sed -e 's|^mirrorlist=|#mirrorlist=|g' \
    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.aliyun.com/rockylinux|g' \
    -i.bak \
    /etc/yum.repos.d/rocky-*.repo
dnf makecache
```
ç„¶åç¼–å†™ä¸€ä¸ªshè„šæœ¬æ–‡ä»¶ï¼Œå¹¶æŠŠåˆšåˆšå¤åˆ¶çš„ä»£ç å¤åˆ¶è¿›å»
`vi 1.sh`
æ›¿æ¢æ—¶éœ€è¦æ ¹æ®è‡ªå·±ç³»ç»Ÿå®é™…æ–‡ä»¶ä¿®æ”¹æœ€åä¸€è¡Œ
cdåˆ°`/etc/yum.repos.d`ï¼Œ`ls`ä¸€ä¸‹ï¼Œå¦‚æœé‡Œé¢çš„æ–‡ä»¶æ˜¯å¤§Rå°±ä¿æŒä¸å˜ï¼Œåƒæˆ‘çš„å°±æ˜¯å°rï¼Œå°±éœ€è¦æŠŠå¤§Ræ”¹æˆå°rï¼Œå¦åˆ™åŸæ¥çš„Rocky-*.repoä¼šæŠ¥é”™
![92c861d57d69409c422c2e070ddf7424.png](https://s1.imagehub.cc/images/2023/12/07/92c861d57d69409c422c2e070ddf7424.png)
![3d64bb24e7d9127c288caed558a0a599.png](https://s1.imagehub.cc/images/2023/12/06/3d64bb24e7d9127c288caed558a0a599.png)
è¿è¡Œè„šæœ¬ï¼š`sh 1.sh`
æ¸…é™¤ç¼“å­˜ï¼š`yum clean all`
ç”Ÿæˆæ–°ç¼“å­˜ï¼š`yum makecache`
å‡çº§è½¯ä»¶ï¼š`yum -y update`
![a0b0be2f05fd9e5336cc80467e4cd6f6.png](https://s1.imagehub.cc/images/2023/12/06/a0b0be2f05fd9e5336cc80467e4cd6f6.png)

### ã€2ã€‘ä¸Šæµ·äº¤å¤§é•œåƒæº
é¦–å…ˆæ‰“å¼€ä¸Šæµ·äº¤é€šå¤§å­¦Rocky Linuxé•œåƒç«™
[ä¸Šæµ·äº¤é€šå¤§å­¦-è½¯ä»¶æºé•œåƒæœåŠ¡](https://mirror.sjtu.edu.cn/docs/rocky "ä¸Šæµ·äº¤é€šå¤§å­¦-è½¯ä»¶æºé•œåƒæœåŠ¡")
å¤åˆ¶ä¸Šäº¤å¤§æä¾›çš„ä»£ç 
![18eec41e2d2c0a63b3cc631c994e4a59.png](https://s1.imagehub.cc/images/2023/12/06/18eec41e2d2c0a63b3cc631c994e4a59.png)	
**CVå·¥ç¨‹å¸ˆç¦åˆ©ï¼š**
```
sed -e 's|^mirrorlist=|#mirrorlist=|g' \
    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.sjtug.sjtu.edu.cn/rocky|g' \
    -i.bak \
    /etc/yum.repos.d/Rocky-*.repo
```
ç„¶åç¼–å†™shè„šæœ¬æ–‡ä»¶ï¼Œå¤åˆ¶ä»£ç è¿›å»ï¼Œå†å¡«å†™è‡ªå·±ç¯å¢ƒçš„å®é™…è·¯å¾„
`vi sh-shangjiaoda.sh`
![5d057429a6ef37ed29f60c70866b2afc.png](https://s1.imagehub.cc/images/2023/12/06/5d057429a6ef37ed29f60c70866b2afc.png)
ç„¶ååœ¨æœ«å°¾å†™å…¥`dnf makecache`
![5cb573cafb5ff56fe6eed0498e11d3ee.png](https://s1.imagehub.cc/images/2023/12/06/5cb573cafb5ff56fe6eed0498e11d3ee.png)
è¿è¡Œå³å¯
![b7ac3784b27a96487a8b63be5ecc5956.png](https://s1.imagehub.cc/images/2023/12/06/b7ac3784b27a96487a8b63be5ecc5956.png)

### ã€3ã€‘æµ™æ±Ÿå¤§å­¦é•œåƒæº
[æµ™æ±Ÿå¤§å­¦-å¼€æºè½¯ä»¶é•œåƒç«™-Rocky Linux](http://mirrors.zju.edu.cn/docs/rocky/ "æµ™æ±Ÿå¤§å­¦-å¼€æºè½¯ä»¶é•œåƒç«™Rocky Linux")
å¤åˆ¶å¯¹åº”ç‰ˆæœ¬çš„å‘½ä»¤å³å¯ï¼Œæ›´æ¢æ­¥éª¤å’Œä¸Šé¢ä¸¤ä¸ªå¤§åŒå°å¼‚ï¼Œå°±ä¸ç»†è¯´äº†
Rocky LinuxæŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ï¼š`cat /etc/rocky-release`
![cf84ca23cb587af4f696e8c649de704f.png](https://s1.imagehub.cc/images/2023/12/06/cf84ca23cb587af4f696e8c649de704f.png)

**Rocky Linux9ï¼š**
```
sed -e 's|^mirrorlist=|#mirrorlist=|g' \
    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.zju.edu.cn/rocky|g' \
    -i.bak \
    /etc/yum.repos.d/rocky-extras.repo \
    /etc/yum.repos.d/rocky.repo
```
**Rocky Linux8ï¼š**
```
sed -e 's|^mirrorlist=|#mirrorlist=|g' \
    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.zju.edu.cn/rocky|g' \
    -i.bak \
    /etc/yum.repos.d/Rocky-AppStream.repo \
    /etc/yum.repos.d/Rocky-BaseOS.repo \
    /etc/yum.repos.d/Rocky-Extras.repo \
    /etc/yum.repos.d/Rocky-PowerTools.repo
```
### ã€4ã€‘ä¸­ç§‘å¤§é•œåƒæº
[ä¸­ç§‘å¤§-Rocky Linuxæº](https://mirrors.ustc.edu.cn/help/rocky.html "ä¸­ç§‘å¤§-Rocky Linuxæº")
å¤åˆ¶å¯¹åº”ç‰ˆæœ¬çš„å‘½ä»¤å³å¯ï¼Œæ›´æ¢æ­¥éª¤å¤§åŒå°å¼‚ï¼Œå°±ä¸ç»†è¯´äº†
![5bcece9801bd3a57c1e98b93c926b846.png](https://s1.imagehub.cc/images/2023/12/06/5bcece9801bd3a57c1e98b93c926b846.png)

**Rocky Linux9ï¼š**
```
sed -e 's|^mirrorlist=|#mirrorlist=|g' \
    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.ustc.edu.cn/rocky|g' \
    -i.bak \
    /etc/yum.repos.d/rocky-extras.repo \
    /etc/yum.repos.d/rocky.repo
```
**Rocky Linux8ï¼š**
```
sed -e 's|^mirrorlist=|#mirrorlist=|g' \
    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.ustc.edu.cn/rocky|g' \
    -i.bak \
    /etc/yum.repos.d/Rocky-AppStream.repo \
    /etc/yum.repos.d/Rocky-BaseOS.repo \
    /etc/yum.repos.d/Rocky-Extras.repo \
    /etc/yum.repos.d/Rocky-PowerTools.repo
```

# <font color=red>ã€1ã€‘DNSæœåŠ¡å™¨æ­å»º</font>

## ã€1ã€‘DNSä»‹ç»ï¼š
DNSè¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº†ï¼Œæ„Ÿå…´è¶£çš„è¯å°±å»çœ‹è¿™ç¯‡æ–‡ç« 
ä¼ é€é—¨ï¼š[çŸ¥ä¹-ä»€ä¹ˆæ˜¯DNSï¼Ÿ](https://zhuanlan.zhihu.com/p/186028919 "çŸ¥ä¹-ä»€ä¹ˆæ˜¯DNSï¼Ÿ")

## ã€2ã€‘å®‰è£…DNSï¼š
`yum -y install bind*`

## ã€3ã€‘é…ç½®DNS Config
### ã€3.1ã€‘é…ç½®named.conf
`vi /etc/named.conf`
æŠŠå·¦å›¾çº¢æ¡†å†…çš„11è¡Œå’Œ19è¡Œçš„å†…å®¹å…¨éƒ¨æ›¿æ¢ä¸º"any"
![named.conf-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/named.conf-former-and-after.png)
### ã€3.2ã€‘é…ç½®named.rfc1912.zones
`vi /etc/named.rfc1912.zones`
<font color=red>å·¦è¾¹çº¢æ¡†å†…çš„16è¡Œè‡³34è¡Œå†…å®¹å…¨éƒ¨åˆ é™¤</font>ï¼Œåªç•™ä¸‹å€’æ•°ä¸¤æ®µå†…å®¹
<font color=DeepSkyBlue>å³è¾¹è“æ¡†åŒå¼•å·å†…å¡«å†™åŸŸå</font>
<font color=Blue>æ·±è“è‰²åŒå¼•å·å¡«å†™æ­£å‘è§£ææ–‡ä»¶æ–‡ä»¶å</font>
<font color=yellow>é»„è‰²åŒå¼•å·å¡«å†™åå‘IP</font>  åå‘IPåªå†™åˆ°ç½‘ç»œä½ï¼Œä¸å†™ä¸»æœºä½ï¼Œä¾‹å¦‚ä½ çš„ç½‘ç»œä½æ˜¯192.168.100ï¼Œé‚£ä¹ˆè¿™é‡Œçš„åå‘IPå°±å¡«100.168.192
<font color=DarkOrange>æ©™è‰²åŒå¼•å·å¡«å†™åå‘è§£ææ–‡ä»¶æ–‡ä»¶å</font>
![named.rfc1912.zones-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/named.rfc1912.zones-former-and-after.png)

### ã€3.3ã€‘å¤åˆ¶æ­£åå‘è§£ææ–‡ä»¶
å»åˆ°/var/namedå†…
[![var-named-ls.png](https://s1.imagehub.cc/images/2023/09/05/var-named-ls.png)](https://www.imagehub.cc/image/rktY1e)
è¿™ä¸¤ä¸ªæ–‡ä»¶å¤åˆ¶å“ªä¸ªéƒ½å¯ä»¥ï¼Œæˆ‘è¿™é‡Œå°±å¤åˆ¶localhostæ–‡ä»¶äº†

å¤åˆ¶æ­£å‘è§£ææ–‡ä»¶ninework.com.a
> `cp -p named.localhost ninework.com.a`

å¤åˆ¶åå‘è§£ææ–‡ä»¶ninework.com.fx
> `cp -p named.localhost ninework.com.fx`

cpé€‰é¡¹è¯´æ˜ï¼š
åŸé“¾æ¥ï¼šhttps://www.runoob.com/linux/linux-comm-cp.html
![Description-of-the-cp-option.png](https://s1.imagehub.cc/images/2023/09/05/Description-of-the-cp-option.png)
![After-copying.png](https://s1.imagehub.cc/images/2023/09/05/After-copying.png)
### ã€3.3ã€‘ç¼–è¾‘DNSæ­£å‘è§£ææ–‡ä»¶
`vi /var/named/ninework.com.a`
![ninework.com.a-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/ninework.com.a-former-and-after.png)
<font color=red>çº¢æ¡†å†…å¡«å†™åŸŸåå¹¶åœ¨æœ«å°¾åŠ ä¸Šè‹±æ–‡ç‚¹`.`</font>
<font color=DeepSkyBlue>è“æ¡†å†…å¡«å†™è™šæ‹Ÿæœºæœ¬æœºIPåœ°å€</font>
### ã€3.4ã€‘ç¼–è¾‘DNSåå‘è§£ææ–‡ä»¶
![ninework.com.fx-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/ninework.com.fx-former-and-after.png)
<font color=red>å·¦è¾¹çº¢æ¡†å†…æ›¿æ¢ä¸ºåŸŸå</font>
<font color=DeepSkyBlue>è“è‰²æ¡†å†…çš„æ˜¯IPV4çš„ä¸»æœºä½ï¼Œæ³¨æ„æ¯æ¡è·ŸåŸŸåæœ‰å…³çš„è®°å½•éƒ½æœ‰è‹±æ–‡ç‚¹`.`</font>
### ã€3.5ã€‘é‡å¯Bind
<font color=red>Bindçš„è¿›ç¨‹åå«named</font>
`systemctl restart named`
### ã€3.6ã€‘è™šæ‹ŸæœºDNSæŒ‡å‘æœ¬åœ°
ç½‘å¡çš„é…ç½®æ–‡ä»¶å­˜åœ¨äº`/etc/NetworkManager/system-connections/ens33.nmconnection`å†…
<font color=red>çº¢æ¡†å†…çš„å†…å®¹æ˜¯DNS</font>
![ens33-config-Former-and-After.png](https://s1.imagehub.cc/images/2023/09/05/ens33-config-Former-and-After.png)
### ã€3.7ã€‘åŠ è½½æ¿€æ´»ç½‘å¡é…ç½®æ–‡ä»¶
åŠ è½½ç½‘å¡é…ç½®æ–‡ä»¶
> `nmcli connection load  /etc/NetworkManager/system-connections/ens33.nmconnection`

æ¿€æ´»ç½‘å¡é…ç½®æ–‡ä»¶
> `nmcli connection up  /etc/NetworkManager/system-connections/ens33.nmconnection`

![nmcil-load-up.png](https://s1.imagehub.cc/images/2023/09/05/nmcil-load-up.png)
## ã€4ã€‘éªŒè¯ç¯èŠ‚
### ã€4.1ã€‘éªŒè¯
è¾“å…¥`nslookup`éªŒè¯DNSæ˜¯å¦é…ç½®æˆåŠŸ
![nslookup.png](https://s1.imagehub.cc/images/2023/09/05/nslookup.png)
è¾“å…¥åŸŸåå’ŒIPåï¼Œè¦æ˜¯éƒ½èƒ½è§£æçš„åˆ°ï¼ŒDNSé…ç½®æ‰ç®—æˆåŠŸ
### <font color=red>ã€4.2ã€‘é”™è¯¯æƒ…å†µ</font>
***<font color=red>ä»¥ä¸‹æƒ…å†µå…¨æ˜¯é…ç½®é”™è¯¯çš„æƒ…å†µï¼š</font>***
[1]
![error-1.png](https://s1.imagehub.cc/images/2023/09/05/error-1.png)
[2]
![error-2.png](https://s1.imagehub.cc/images/2023/09/05/error-2.png)
[3]
![error-3.png](https://s1.imagehub.cc/images/2023/09/05/error-3.png)

# <font color=red>ã€2ã€‘ DNSä¸»ä»æœåŠ¡å™¨é…ç½®</font>
## ã€1ã€‘ç¯å¢ƒä»‹ç»
|ä¸»æœºåç§°|IP|DNSæŒ‡å‘|æ‰®æ¼”è§’è‰²|ç³»ç»Ÿç‰ˆæœ¬|
|---|---|---|---|---|
|Rocky-Master|192.168.10.181|192.168.10.181|DNSä¸»æœåŠ¡å™¨|Rocky_boot_9.1|
|Rocky-Slave|192.168.10.182|192.168.10.181|DNSä»æœåŠ¡å™¨|Rocky_boot_9.1|
|Rocky-Client|192.168.10.183|192.168.10.181|DNSå®¢æˆ·ç«¯|Rocky_boot_9.1|

## ã€2ã€‘ä¿®æ”¹ç½‘å¡é…ç½®æ–‡ä»¶
å‘½ä»¤ï¼š`vi /etc/NetworkManager/system-connections/ens33.nmconnection `
DNSæŒ‡å‘æœ¬æœº
![d03d16090e948999f5e9af88a7548526.png](https://s1.imagehub.cc/images/2023/11/02/d03d16090e948999f5e9af88a7548526.png)

æ¿€æ´»ç½‘å¡é…ç½®ï¼š
`nmcli connection load /etc/NetworkManager/system-connections/ens33.nmconnection`
`nmcli connection up /etc/NetworkManager/system-connections/ens33.nmconnection`
![bb8d9283fab5298e7151b52f8962f127.png](https://s1.imagehub.cc/images/2023/11/02/bb8d9283fab5298e7151b52f8962f127.png)

## ã€3ã€‘Masterä¿®æ”¹ä¸»æœºå
å‘½ä»¤ï¼š`vi /etc/hostname`
ä¿®æ”¹å®Œæˆåï¼Œé‡å¯ç”Ÿæ•ˆ
![683a34b086665d01026e3eb6a5994499.png](https://s1.imagehub.cc/images/2023/11/02/683a34b086665d01026e3eb6a5994499.png)

## ã€4ã€‘Masterå®‰è£…Bind
å‘½ä»¤ï¼š`yum -y install bind*`
![2c9ddc35fc1439139d65c865425bcae8.png](https://s1.imagehub.cc/images/2023/11/02/2c9ddc35fc1439139d65c865425bcae8.png)

## ã€5ã€‘Masterä¿®æ”¹Bindä¸»é…ç½®æ–‡ä»¶

å‘½ä»¤ï¼š`vi /etc/named.conf`
**1-ç¬¬11è¡Œï¼š**
æŠŠç¬¬11è¡Œçš„`127.0.0.1`æ›¿æ¢ä¸º`any`æˆ–æœ¬æœºIPåœ°å€
![93fd80e8157a1efee9baba263c9c024b.png](https://s1.imagehub.cc/images/2023/11/02/93fd80e8157a1efee9baba263c9c024b.png)

**2-ç¬¬19è¡Œï¼š**
æ›´æ”¹19è¡Œçš„`localhost`ä¸º`any`æˆ–æœ¬æœºIPåœ°å€
![040b2f2ccd69d5d7cdce541610292ccd.png](https://s1.imagehub.cc/images/2023/11/02/040b2f2ccd69d5d7cdce541610292ccd.png)

## ã€6ã€‘Masterä¿®æ”¹åŒºåŸŸé…ç½®æ–‡ä»¶
å»ºè®®å¤‡ä»½ä¸€ä¸‹åŒºåŸŸé…ç½®æ–‡ä»¶
å¤‡ä»½å‘½ä»¤ï¼š`cp -p /etc/named.rfc1912.zones /etc/named.rfc1912.zones.bak`

ä¿®æ”¹åŒºåŸŸé…ç½®æ–‡ä»¶
å‘½ä»¤ï¼š`vi /etc/named.rfc1912.zones`
æˆ‘è¿™é‡Œåªç•™ä¸‹äº†35-45è¡Œï¼Œå…¶ä»–è¡Œå†…å®¹å¯¹äºæœ¬èŠ‚æ¥è¯´ä½œç”¨ä¸å¤§ï¼Œçœ‹ä¸ªäººå–œå¥½åˆ é™¤
![7eedb813f96d456db429746458c52c3b.png](https://s1.imagehub.cc/images/2023/11/02/7eedb813f96d456db429746458c52c3b.png)
åˆ é™¤åçš„å†…å®¹æ¯”è¾ƒç®€æ´æ˜äº†
![2c0b03af18c53b79233d3b3fa6147e5f.png](https://s1.imagehub.cc/images/2023/11/02/2c0b03af18c53b79233d3b3fa6147e5f.png)

**1-ç¬¬1è¡Œï¼š**
æŠŠzoneåŒå¼•å·å†…çš„å†…å®¹æ›¿æ¢ä¸ºä½ çš„åŸŸå
![dab02056a8579dc5c1708e39e6b26d59.png](https://s1.imagehub.cc/images/2023/11/02/dab02056a8579dc5c1708e39e6b26d59.png)

**2-ç¬¬3è¡Œï¼š**
fileåŒå¼•å·å†…æ›¿æ¢ä¸ºæ­£å‘è§£ææ–‡ä»¶å
![307c5bd087a9872c0e5c7f3c82654359.png](https://s1.imagehub.cc/images/2023/11/02/307c5bd087a9872c0e5c7f3c82654359.png)

**3-ç¬¬4è¡Œï¼š**
æŠŠèŠ±æ‹¬å·å†…çš„`none`æ›¿æ¢ä¸ºDNSä»æœåŠ¡å™¨çš„IPåœ°å€
![f0e7c4946790fd685ce724cecc728367.png](https://s1.imagehub.cc/images/2023/11/02/f0e7c4946790fd685ce724cecc728367.png)

**4-ç¬¬7è¡Œï¼š**
åœ¨ç¬¬7è¡Œçš„`.in`å‰å¡«å†™åå‘ç½‘ç»œä½IPåœ°å€
![a9751861e166f58f314d183bbed823ba.png](https://s1.imagehub.cc/images/2023/11/02/a9751861e166f58f314d183bbed823ba.png)

ä¸çŸ¥é“è‡ªå·±çš„ç½‘ç»œä½IPï¼Ÿ
å‘½ä»¤ï¼š`ifconfig`
ç¬¬6è¡Œçš„`inet`åé¢çš„4æ®µç‚¹åˆ†åè¿›åˆ¶å°±æ˜¯ä½ çš„IPåœ°å€ï¼Œå‰3æ®µæ˜¯ä½ çš„ç½‘ç»œä½åœ°å€
<font color=red>åå‘åœ°å€å¡«å†™æ—¶è¦ä»åå‘å‰å†™</font>
ä¾‹ï¼š192.168.1=1.168.192
![c5251bd962ace6af852f33fe3ba1f413.png](https://s1.imagehub.cc/images/2023/11/02/c5251bd962ace6af852f33fe3ba1f413.png)

**5-ç¬¬9è¡Œï¼š**
åœ¨ç¬¬9è¡Œçš„fileåŒå¼•å·å†…å¡«å†™åå‘è§£ææ–‡ä»¶çš„æ–‡ä»¶å
![7bfd21d76e3faa2c67b7beb8e0f2c41b.png](https://s1.imagehub.cc/images/2023/11/02/7bfd21d76e3faa2c67b7beb8e0f2c41b.png)

**6-ç¬¬10è¡Œï¼š**
åœ¨ç¬¬10è¡Œçš„allow-updateåè¾¹çš„èŠ±æ‹¬å·å†…å¡«å†™DNSä»æœåŠ¡å™¨IPåœ°å€
![ed290445e5b97d1d3a80f93fa2bec7d9.png](https://s1.imagehub.cc/images/2023/11/02/ed290445e5b97d1d3a80f93fa2bec7d9.png)

## ã€7ã€‘ä¿®æ”¹æ­£å‘è§£ææ–‡ä»¶
å»åˆ°var/namedå†…ï¼š`cd /var/named`
å¤åˆ¶æ¨¡æ¿ï¼š
`cp -p named.localhost a`
`cp -p named.localhost fx`
![42b1c5b951cb2ce5d08a4d169c0ca401.png](https://s1.imagehub.cc/images/2023/11/02/42b1c5b951cb2ce5d08a4d169c0ca401.png)
ä¿®æ”¹æ­£å‘è§£ææ–‡ä»¶ï¼š`vi a`
![93a0634917d5adbb9605e31be2183c0c.png](https://s1.imagehub.cc/images/2023/11/02/93a0634917d5adbb9605e31be2183c0c.png)
ä¿®æ”¹åå‘è§£ææ–‡ä»¶ï¼š`vi fx`
![44ff57b285205190ca32ee88d06f6007.png](https://s1.imagehub.cc/images/2023/11/02/44ff57b285205190ca32ee88d06f6007.png)

## ã€8ã€‘é‡å¯BindæœåŠ¡
é‡å¯Bind:`systemctl restart named`
æŸ¥çœ‹BindçŠ¶æ€ï¼š`systemctl status named`
![c3aab82651754abcc92d17b5b5337698.png](https://s1.imagehub.cc/images/2023/11/02/c3aab82651754abcc92d17b5b5337698.png)

## ã€9ã€‘Slaveå®‰è£…Bind
å‘½ä»¤ï¼š`yum -y install bind*`
![16e5cfb2a1ded26e6a701c3db7bb497f.png](https://s1.imagehub.cc/images/2023/11/02/16e5cfb2a1ded26e6a701c3db7bb497f.png)

## ã€10ã€‘Slaveä¿®æ”¹Bindä¸»é…ç½®æ–‡ä»¶
å‘½ä»¤ï¼š`vi /etc/named.conf`
**1-ç¬¬11è¡Œï¼š**
æŠŠ11è¡Œå†…çš„èŠ±æ‹¬å·å†…çš„å†…å®¹ä¿®æ”¹ä¸º`any`
![4d4a92c84b9b3714110d93afbc963fae.png](https://s1.imagehub.cc/images/2023/11/02/4d4a92c84b9b3714110d93afbc963fae.png)

**2-ç¬¬19è¡Œï¼š**
æŠŠ19è¡ŒèŠ±æ‹¬å·å†…çš„`localhost`ä¿®æ”¹ä¸º`any`
![24f2440d3e1679acd8fe01c9bac46c0b.png](https://s1.imagehub.cc/images/2023/11/02/24f2440d3e1679acd8fe01c9bac46c0b.png)

## ã€11ã€‘Slaveä¿®æ”¹åŒºåŸŸé…ç½®æ–‡ä»¶
å‘½ä»¤ï¼š`vi /etc/named.rfc1912.zones`
ä¿ç•™35-45è¡Œå†…å®¹
![e205e89b0fa7a52523c2ecf7a6a7297d.png](https://s1.imagehub.cc/images/2023/11/02/e205e89b0fa7a52523c2ecf7a6a7297d.png)
![d00a97023d5eecb1ff9dc28cf5c25956.png](https://s1.imagehub.cc/images/2023/11/02/d00a97023d5eecb1ff9dc28cf5c25956.png)

**1-ç¬¬1è¡Œï¼š**
æŠŠç¬¬1è¡ŒåŒå¼•å·å†…çš„å†…å®¹æ›¿æ¢ä¸ºä½ çš„åŸŸå
![b889741a26848819f017fecbe6229a8b.png](https://s1.imagehub.cc/images/2023/11/02/b889741a26848819f017fecbe6229a8b.png)

**2-ç¬¬2è¡Œ:**
æŠŠtypeåè¾¹çš„`master`ä¿®æ”¹ä¸º`slave`
![f3f439b6146c06eed2c15625c086f3f7.png](https://s1.imagehub.cc/images/2023/11/02/f3f439b6146c06eed2c15625c086f3f7.png)

**3-ç¬¬3è¡Œï¼š**
æŠŠç¬¬3è¡ŒåŒå¼•å·å†…çš„å†…å®¹ä¿®æ”¹ä¸ºåå‘è§£ææ–‡ä»¶çš„æ–‡ä»¶å
![97b71590838b7e970747504dc2ca8e17.png](https://s1.imagehub.cc/images/2023/11/02/97b71590838b7e970747504dc2ca8e17.png)

**4-ç¬¬5è¡Œï¼š**
ç¬¬4è¡Œçš„å†…å®¹ä¸æ¶‰åŠï¼Œå¯ä»¥æ³¨é‡Šæ‰
åœ¨ç¬¬5è¡Œå†…æ·»åŠ ä¸€æ¡æŒ‡å‘masterçš„IPè®°å½•
`master {192.168.10.181;};`
![de0fd728adea4f5ac50f20d65ab28d59.png](https://s1.imagehub.cc/images/2023/11/03/de0fd728adea4f5ac50f20d65ab28d59.png)

**5-ç¬¬8è¡Œï¼š**
åœ¨ç¬¬8è¡ŒåŒå¼•å·å†…æ·»åŠ åå‘ç½‘ç»œä½IP
![60eb8dcf9b9877b116956822856adcc1.png](https://s1.imagehub.cc/images/2023/11/03/60eb8dcf9b9877b116956822856adcc1.png)

**6-ç¬¬9è¡Œï¼š**
æŠŠç¬¬9è¡Œçš„ç±»å‹ç”±`master`ä¿®æ”¹ä¸º`slave`
![ddeb7094aba8dcf1a90eba96e7e1d15c.png](https://s1.imagehub.cc/images/2023/11/03/ddeb7094aba8dcf1a90eba96e7e1d15c.png)

**7-ç¬¬10è¡Œï¼š**
æŒ‡å‘åå‘è§£ææ–‡ä»¶
ç¬¬11è¡Œä¸æ¶‰åŠï¼Œå¯ä»¥æ³¨é‡Šæ‰
![71a0163d93c65d3940947de227783360.png](https://s1.imagehub.cc/images/2023/11/03/71a0163d93c65d3940947de227783360.png)

**8-ç¬¬12è¡Œï¼š**
æ·»åŠ æŒ‡å‘masterçš„IPè®°å½•
`masters {192.168.10.181;};`
![e5df3968cc32e9223d55e9ff8d6e84b8.png](https://s1.imagehub.cc/images/2023/11/03/e5df3968cc32e9223d55e9ff8d6e84b8.png)

## ã€12ã€‘éªŒæ”¶ç¯èŠ‚
3å°ä¸»æœºå‡å…³é—­é˜²ç«å¢™å’ŒSELinux
`systemctl stop firewalld`
`setenforce 0`

Clientè¾“å…¥`nslookup`
ç„¶åè¾“å…¥`Rocky-Slave`å’Œ`192.168.10.182`
è‹¥éƒ½èƒ½è§£æå‡ºæ¥ï¼Œé‚£ä¹ˆDNSä¸»ä»æœåŠ¡å™¨é…ç½®æˆåŠŸ
![134285ba521b8af8edda938555d3a14e.png](https://s1.imagehub.cc/images/2023/11/03/134285ba521b8af8edda938555d3a14e.png)

# <font color=red>ã€3ã€‘Apache+SSLæœåŠ¡å™¨é…ç½®</font>
**è¯´æ˜ï¼š**
å½“å‰Apacheéœ€è¦DNSæ”¯æŒï¼Œæ‰€ä»¥åœ¨åšApacheäº‹å…ˆå‰å°±è¦åšå¥½DNS
![nslookup-verify.png](https://s1.imagehub.cc/images/2023/09/05/nslookup-verify.png)
## ã€1ã€‘å®‰è£…Apache
`yum -y install httpd`
## ã€2ã€‘ç¼–å†™Apacheé…ç½®æ–‡ä»¶
Apacheé…ç½®æ–‡ä»¶å­˜åœ¨äº`/etc/httpd/conf/httpd.conf`
### ã€2.1ã€‘ç¬¬ä¸€å¤„-124è¡Œ
è¿™é‡Œå­˜æ”¾çš„æ˜¯ç«™ç‚¹æ ¹ç›®å½•ï¼Œç½‘ç«™ä¸Šçš„æ–‡ä»¶éƒ½å­˜æ”¾äºè¯¥ç›®å½•ä¸‹
![httpd.conf-124row-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/httpd.conf-124row-former-and-after.png)
### ã€2.2ã€‘ç¬¬äºŒå¤„-129è¡Œ
![httpd.conf-129row-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/httpd.conf-129row-former-and-after.png)
### ã€2.3ã€‘ç¬¬ä¸‰å¤„-136è¡Œ
![httpd.conf-136row-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/httpd.conf-136row-former-and-after.png)
### ã€2.4ã€‘ç¬¬å››å¤„-169è¡Œ
<font color=DeepSkyBlue>è¿™é‡Œå¯ä»¥æ”¹ä¹Ÿå¯ä»¥ä¸æ”¹ï¼Œçœ‹è‡ªå·±å¿ƒæƒ…å§ï¼Œä¸æ”¹çš„è¯ï¼Œåˆ›å»ºç½‘ç«™æ ¹æ–‡ä»¶çš„æ—¶å€™è®°å¾—ä¹Ÿè¦å†™"index.html"</font>
![httpd.conf-169row-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/httpd.conf-169row-former-and-after.png)
## ã€3ã€‘åˆ›å»ºç«™ç‚¹æ ¹ç›®å½•
ç”±äºhttpd.confé‡Œéƒ½æ˜¯æŒ‡å®šçš„/www/webç›®å½•ï¼Œæ‰€ä»¥è¦æ·»åŠ -pé€‰é¡¹
`mkdir -p /www/web`
## ã€4ã€‘åˆ›å»ºç«™ç‚¹æ ¹æ–‡ä»¶
å¦‚æœä½ ä¹‹å‰åœ¨httpd.conf 169è¡Œæ˜¯ç¼ºçœå€¼çš„è¯ï¼Œé‚£å°±æŠŠ`web.html`æ›¿æ¢ä¸ºç¼ºçœå€¼çš„`index.html`ï¼Œæˆ‘è¿™é‡Œæ”¹è¿‡åå­—äº†ï¼Œé‚£æˆ‘å°±åˆ›å»º`web.html`äº†
`touch /www/web/web.html`
## ã€5ã€‘ç¼–å†™ç«™ç‚¹æ ¹æ–‡ä»¶
åˆ›å»ºå¥½ç«™ç‚¹æ ¹æ–‡ä»¶åï¼Œé‡Œé¢æ²¡æœ‰ä»»ä½•å†…å®¹ï¼Œè¿™æ—¶å€™å»é‡Œè¾¹éšä¾¿å†™ç‚¹å†…å®¹
`vi /www/web/web.html`
## ã€6ã€‘SSLè¯ä¹¦
### ã€6.1ã€‘å®‰è£…SSLè¯ä¹¦
`yum -y install mod_ss`
### ã€6.2ã€‘ç”ŸæˆSSLè¯ä¹¦
æ— è„‘æŒ‰å›è½¦å°±è¡Œ
`openssl req -newkey rsa:2048 -nodes -keyout server.key -x509 -days 365 -out server.crt`
![httpd.conf-169row-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/httpd.conf-169row-former-and-after.png)
### ã€6.3ã€‘å¤åˆ¶SSLè¯ä¹¦åŠç§˜é’¥
æŠŠè¿™ä¸¤ä»½SSLè¯ä¹¦åŠç§˜é’¥å¤åˆ¶åˆ°/etc/pki/tls/certsåŠ/privateç›®å½•å†…
![Snipaste_2023-09-03_16-48-43.png](https://s1.imagehub.cc/images/2023/09/05/Snipaste_2023-09-03_16-48-43.png)
`cp server.crt /etc/pki/tls/certs/server.crt`
`cp server.key /etc/pki/tls/private/server.key`
### ã€6.4ã€‘ä¿®æ”¹SSLé…ç½®æ–‡ä»¶
`vi /etc/httpd/conf.d/ssl/conf`
æŠŠ"local"æ›¿æ¢ä¸º"server"å³å¯
![ssl.conf-85and-93-row-former-and-after.png](https://s1.imagehub.cc/images/2023/09/05/ssl.conf-85and-93-row-former-and-after.png)
## ã€7ã€‘é‡å¯æœåŠ¡
é‡å¯Apache
`systemctl restart httpd`
é‡å¯SSL
`service sshd restart`
## ã€8ã€‘å…³é—­é˜²ç«å¢™åŠSELinux
å…³é—­é˜²ç«å¢™ï¼š
`systemctl stop firewalld`

å…³é—­SELinuxï¼š
`setenforce 0`
## ã€9ã€‘éªŒè¯
### ã€9.1ã€‘IPåœ°å€éªŒè¯
æ‰“å¼€æµè§ˆå™¨è¾“å…¥è™šæ‹ŸæœºIPåœ°å€
`192.168.10.181`
![The-IP-address-method-is-successfully-verified.png](https://s1.imagehub.cc/images/2023/09/05/The-IP-address-method-is-successfully-verified.png)
### ã€9.2ã€‘åŸŸåéªŒè¯
è¾“å…¥åŸŸååï¼Œå¯ä»¥çœ‹åˆ°å¹¶ä¸æ˜¯æˆ‘ä»¬çš„HTML
![Domain-name-method-validation-failed.png](https://s1.imagehub.cc/images/2023/09/05/Domain-name-method-validation-failed.png)
è¿™æ˜¯å› ä¸ºå®¿ä¸»æœºçš„DNSæ˜¯223.6.6.6ï¼Œç”µè„‘è·‘åˆ°é˜¿é‡Œçš„DNSæœåŠ¡å™¨ä¸Šæ‰¾"www.ninework.com"è¿™ä¸ªç½‘ç«™å»äº†
æ‰¾åˆ°äº†å°±æ˜¾ç¤ºä½ è¾“å…¥çš„åŸŸåï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å°±ä¼šåƒä¸‹é¢è¿™æ ·ï¼š
![This-website-cannot-be-accessed.png](https://s1.imagehub.cc/images/2023/09/05/This-website-cannot-be-accessed.png)
<font color=red>
è¿™é‡Œå»ºè®® *é™¤è·Ÿè™šæ‹Ÿæœºæœ‰æ•°æ®æµé€šçš„ç½‘å¡å¤–å…¨éƒ¨ç¦ç”¨*
æˆ‘ç”¨çš„æ˜¯æ¡¥æ¥æ¨¡å¼ï¼Œæ‰€ä»¥VMçš„2ä¸ªè™šæ‹Ÿç½‘å¡ä¹Ÿç¦ç”¨äº†
å¦‚æœä½ æ˜¯VM NATæ¨¡å¼ï¼Œé‚£å°±ç¦ç”¨ä¸Šç½‘å¡ï¼Œæ‰“å¼€VMè™šæ‹Ÿç½‘å¡
</font>

![ncpa.cpl.png](https://s1.imagehub.cc/images/2023/09/05/ncpa.cpl.png)
æŠŠDNSæŒ‡å‘è™šæ‹Ÿæœºåå°±å¯ä»¥è®¿é—®åˆ°æˆ‘ä»¬çš„ninework.comç«™ç‚¹äº†
![The-domain-name-method-is-successfully-verified.png](https://s1.imagehub.cc/images/2023/09/05/The-domain-name-method-is-successfully-verified.png)
## ã€10ã€‘åŸç†è®²è§£
è¯¥è®²è§£é¢å‘ç½‘ç»œ/æœåŠ¡å™¨å°ç™½ï¼Œäº†è§£DNSçš„å°±ä¸ç”¨çœ‹äº†
### ã€10.1ã€‘DNSæŒ‡å‘å…¬ç½‘DNSæœåŠ¡å™¨
DNS=223.6.6.6çš„æ—¶å€™ï¼Œç”µè„‘ä¼šå‘é˜¿é‡ŒDNSæœåŠ¡å™¨æœå¯»æ˜¯å¦æœ‰"www.ninework.com"è¿™ä¸ªç½‘ç«™ï¼Œäº‹å®ä¸Šæ˜¯æœ‰è¿™ä¸ªç½‘ç«™çš„ï¼Œåªä¸è¿‡ä¸æ˜¯æˆ‘ä»¬åˆšæ‰æ­å»ºçš„ç½‘ç«™
![www.ninework.com-Erection-address.png](https://s1.imagehub.cc/images/2023/09/05/www.ninework.com-Erection-address.png)
ç»è¿‡æŸ¥è¯¢åï¼Œè¿™ä¸ªç«™ç‚¹æ˜¯æ¶è®¾åœ¨ç¾å›½äºšé©¬é€Šçš„æœåŠ¡å™¨ç«™ç‚¹ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„å†…ç½‘ç«™ç‚¹
~~æˆ‘ä»¬å±€åŸŸç½‘å†…çš„ç½‘ç«™ä¹Ÿä¸å¯èƒ½å‡ºç°åœ¨é˜¿é‡Œçš„DNSæœåŠ¡å™¨é‡Œï¼Œå› ä¸ºè™šæ‹Ÿæœºå¹¶æ²¡æœ‰å…¬ç½‘IPï¼Œå…¬ç½‘è®¿é—®ä¸åˆ°æˆ‘ä»¬å±€åŸŸç½‘é‡Œçš„ç½‘ç«™~~
### ã€10.2ã€‘DNSæŒ‡å‘å†…ç½‘DNSæœåŠ¡å™¨
DNS=192.168.10.181çš„æ—¶å€™ï¼Œç”µè„‘å°±ä¼šå‘è™šæ‹Ÿæœºæ‰¾å¯»æ˜¯å¦æœ‰"www.ninework.com"è¿™ä¸ªç½‘ç«™ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåšApacheè¦äº‹å…ˆåšå¥½DNSï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸åšDNSï¼Œåªä¸è¿‡æ— æ³•ç”¨åŸŸåè®¿é—®ç½¢äº†ã€‚æ‰¾åˆ°è¿™ä¸ªç½‘ç«™åï¼ŒDNSæŠŠåŸŸåè§£ææˆIPåœ°å€ï¼Œç„¶åç”µè„‘è·å–åˆ°åŸŸåçš„IPåœ°å€åï¼Œå°±èƒ½æ‰“å¼€ç½‘ç«™äº†ï¼Œè¾“IPè®¿é—®å’Œè¾“åŸŸåè®¿é—®çš„ä¸œè¥¿éƒ½æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œåªä¸è¿‡IPåœ°å€ä¸å¥½è®°ï¼ŒåŸŸåå°±å¾ˆå¥½è®°
### ã€10.3ã€‘ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿ~~https~~
è·³è½¬è¿™ä¸ªé“¾æ¥ï¼Œè®²çš„å¾ˆé€šé€ï¼š
https://www.bilibili.com/video/BV1uY4y1D7Ng/?vd_source=f66e9fe7694284f598a5e2b8a3b6c586

# <font color=red>ã€4ã€‘MailæœåŠ¡å™¨æ­å»º</font>
## ã€å‰æœŸå‡†å¤‡å·¥ä½œã€‘
### ã€1ã€‘ä¿®æ”¹ä¸»æœºå
éœ€è¦ä¿è¯æœåŠ¡å™¨ä¸»æœºåç§°ä¸å‘ä¿¡åŸŸåä¿æŒä¸€è‡´
ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹/etc/hostnameæ–‡ä»¶
`hostnamectl set-hostname mail.`

### ã€2ã€‘å…³é—­é˜²ç«å¢™
`systemctl stop firewalld`
## ã€1ã€‘é…ç½®DNSï¼š  
### ã€1.1ã€‘å®‰è£…DNSï¼š
> `yum -y install bind*`

![Install-DNS.png](https://s1.imagehub.cc/images/2023/09/05/Install-DNS.png)
### ã€1.2ã€‘é…ç½®named.confï¼š  
cdåˆ°etcï¼š  
`cd /etc`
![cd-etc.png](https://s1.imagehub.cc/images/2023/09/05/cd-etc.png)
ç¼–è¾‘named.confæ–‡ä»¶ï¼š
`vi named.conf`
![Edit-the-named.conf-file.png](https://s1.imagehub.cc/images/2023/09/05/Edit-the-named.conf-file.png)
æŠŠçº¢æ¡†å†…åœˆå‡ºçš„èŠ±æ‹¬å·å†…çš„å†…å®¹æ›¿æ¢ä¸º"any"ï¼š 
![Replace-the-two-places-with-any.png](https://s1.imagehub.cc/images/2023/09/05/Replace-the-two-places-with-any.png)
æ›¿æ¢åï¼š  
![After-replacement.png](https://s1.imagehub.cc/images/2023/09/05/After-replacement.png)
### ã€1.3ã€‘é…ç½®named.rfc1912.zonesæ–‡ä»¶ï¼š  
æŠŠ16-34è¡Œçš„å†…å®¹åˆ æ‰ï¼š
![named.rfc1912.zones.png](https://s1.imagehub.cc/images/2023/09/05/named.rfc1912.zones.png)
æŠŠçº¢åœˆå†…çš„å†…å®¹æ¢æˆåŸŸåï¼Œè“åœˆå†…çš„"0"æ¢æˆåå‘çš„ç½‘ç»œä½IPV4åœ°å€ï¼š
ç„¶å18å’Œ24è¡Œåˆ†åˆ«æŒ‡å‘æ­£å‘è§£ææ–‡ä»¶å’Œåå‘è§£ææ–‡ä»¶(a fx) 
![named.rfc1912.zones-after.png](https://s1.imagehub.cc/images/2023/09/05/named.rfc1912.zones-after.png)
![named.rfc1912.zones-after-the-change.png](https://s1.imagehub.cc/images/2023/09/05/named.rfc1912.zones-after-the-change.png)

### ã€1.4ã€‘ç¼–å†™aæ–‡ä»¶åŠfxæ–‡ä»¶ï¼š  
é¦–å…ˆcdåˆ°var/namedå†…ï¼š
> `cd /var/named`  

ç„¶åå¤åˆ¶ä¸¤ä»½æ–‡ä»¶ï¼š
> `cp -p named.localhost a`
> `cp -p named.localhost fx`

![Copy-two-files-in-the-var-folder.png](https://s1.imagehub.cc/images/2023/09/05/Copy-two-files-in-the-var-folder.png)
é¦–å…ˆç¼–è¾‘aæ–‡ä»¶ï¼š
> `vi a`

![a-file.png](https://s1.imagehub.cc/images/2023/09/05/a-file.png)
ç„¶åä¿®æ”¹fxæ–‡ä»¶ï¼š
> `vi fx`

![fx-file.png](https://s1.imagehub.cc/images/2023/09/05/fx-file.png)
### ã€1.5ã€‘é…ç½®è™šæ‹ŸæœºDNS
è™šæ‹Ÿæœºç½‘å¡çš„DNSé¡»æŒ‡å‘è‡ªå·±æ‰å¯ä»¥ï¼Œæ‰€ä»¥è¦ä¿®æ”¹è™šæ‹Ÿæœºç½‘å¡DNSï¼š
> `vi /etc/NetworkManager/system-connections/ens33.nmconnection`  

![The-DNS-of-the-virtual-machine-NIC-points-to-itself.png](https://s1.imagehub.cc/images/2023/09/05/The-DNS-of-the-virtual-machine-NIC-points-to-itself.png)
### ã€1.6ã€‘é‡å¯ç½‘å¡
> `systemctl restart NetworkManager`
### ã€1.7ã€‘é‡å¯Bind
> `systemctl restart named`

### ã€1.8ã€‘éªŒè¯
è¾“å…¥`nslookup`éªŒè¯ï¼š
![nslookup-verifyd1090d8ffa42d5aa.png](https://s1.imagehub.cc/images/2023/09/05/nslookup-verifyd1090d8ffa42d5aa.png)
è¾“å…¥åŸŸåå’ŒIPåï¼Œä¸æŠ¥é”™æˆ–è€…æ²¡æœ‰å‡ºç°åˆ«çš„IPåœ°å€å°±æ˜¯é…ç½®å¥½äº†

## ã€2ã€‘é…ç½®postfix
### ã€2.1ã€‘å®‰è£…postfix
> `yum -y install postfix`

### ã€2.2ã€‘ç¼–è¾‘postfixé…ç½®æ–‡ä»¶
postfixé…ç½®æ–‡ä»¶å­˜æ”¾äº`vim /etc/postfix/main.cf`ä¸­
#### ã€2.2.1ã€‘ç¬¬ä¸€å¤„
æ‰“å¼€main.cfåï¼Œå…ˆä¿®æ”¹ç¬¬ä¸€å¤„å†…å®¹
æ‰¾åˆ°94è¡Œ,å–æ¶ˆæ³¨é‡Š(#)
ç„¶ååè¾¹è·Ÿä¸ŠmailåŸŸå
![94-row.png](https://s1.imagehub.cc/images/2023/09/05/94-row.png)
#### ã€2.2.2ã€‘ç¬¬äºŒå¤„
æ‰¾åˆ°102è¡Œï¼Œå–æ¶ˆæ³¨é‡Š(#)
åè¾¹è·ŸåŸŸå
![102-row.png](https://s1.imagehub.cc/images/2023/09/05/102-row.png)
#### ã€2.2.3ã€‘ç¬¬ä¸‰å¤„
æ‰¾åˆ°118è¡Œï¼Œå–æ¶ˆæ³¨é‡Š(#)
![118-row.png](https://s1.imagehub.cc/images/2023/09/05/118-row.png)
#### ã€2.2.4ã€‘ç¬¬å››å¤„
æ‰¾åˆ°132è¡Œï¼Œå–æ¶ˆæ³¨é‡Š(#)
![132-row.png](https://s1.imagehub.cc/images/2023/09/05/132-row.png)
#### ã€2.2.5ã€‘ç¬¬äº”å¤„
æ‰¾åˆ°135è¡Œï¼Œåœ¨è¡Œé¦–åŠ æ³¨é‡Š
![135-row.png](https://s1.imagehub.cc/images/2023/09/05/135-row.png)
#### ã€2.2.6ã€‘ç¬¬å…­å¤„
æ‰¾åˆ°183è¡Œï¼Œåœ¨è¡Œé¦–åŠ æ³¨é‡Š
æ‰¾åˆ°184è¡Œï¼Œå–æ¶ˆæ³¨é‡Š(#)
![183-184-row.png](https://s1.imagehub.cc/images/2023/09/05/183-184-row.png)

## ã€3ã€‘é…ç½®dovecot
### ã€3.1ã€‘å®‰è£…dovecot
> `yum -y install dovecot`

### ã€3.2ã€‘ç¼–è¾‘dovecoté…ç½®æ–‡ä»¶
dovecoté…ç½®æ–‡ä»¶å­˜æ”¾äº`/etc/dovecot/dovecot.conf`ä¸­
#### ã€3.2.1ã€‘ç¬¬ä¸€å¤„
æ‰¾åˆ°24è¡Œï¼Œå–æ¶ˆè¡Œé¦–æ³¨é‡Š
å¹¶åœ¨25è¡Œæ·»åŠ ä¸€è¡Œ
`disable_plaintext_auth = no`
å…è®¸ç”¨æˆ·ä½¿ç”¨æ˜æ–‡è¿›è¡Œå¯†ç éªŒè¯
![dovecot-24-25-row.png](https://s1.imagehub.cc/images/2023/09/05/dovecot-24-25-row.png)

#### ã€3.2.2ã€‘ç¬¬äºŒå¤„
æ‰¾åˆ°49è¡Œçš„login_trusted_networksï¼Œæ ¹æ®éœ€è¦æ¥é€‰æ‹©å–æ¶ˆæ³¨é‡Šå¹¶é…ç½®å…è®¸ç™»å½•çš„ç½‘æ®µåœ°å€
æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œé™åˆ¶åªæœ‰æ¥è‡ªäºæŸä¸ªç½‘æ®µçš„ç”¨æˆ·æ‰èƒ½ä½¿ç”¨ç”µå­é‚®ä»¶ç³»ç»Ÿã€‚å¦‚æœæƒ³å…è®¸æ‰€æœ‰äººéƒ½èƒ½ä½¿ç”¨ï¼Œåˆ™ä¸ç”¨ä¿®æ”¹æœ¬å‚æ•°
æˆ‘è¿™é‡Œå°±é™åˆ¶10æ®µç”¨æˆ·æ‰èƒ½ä½¿ç”¨mail
![dovecot-49-row.png](https://s1.imagehub.cc/images/2023/09/05/dovecot-49-row.png)
### ã€3.3ã€‘é…ç½®10-ssl.conf
è¿™æ­¥æŒ‰éœ€é…ç½®ï¼Œå¦‚æœéœ€è¦SSLè¯ä¹¦ï¼Œé‚£ç›´æ¥è¿›è¡Œä¸‹ä¸€æ­¥å³å¯ï¼Œå¦‚æœè¿™æ­¥é»˜è®¤çš„è¯ï¼ŒOutlookæ— æ³•æ¥å—é‚®ä»¶
10-SSL.confé…ç½®æ–‡ä»¶å­˜åœ¨äº`/etc/dovecot/conf.d/10-ssl.conf`
![10-ssl.conf.png](https://s1.imagehub.cc/images/2023/09/05/10-ssl.conf.png)
### ã€3.4ã€‘é…ç½®10-mail.conf
åœ¨å­é…ç½®æ–‡ä»¶/etc/dovecot/conf.d/10-mail.conf ä¸­ï¼Œæ‰¾åˆ°mail_locationå¹¶æŠŠæ³¨é‡Šå»æ‰å³å¯
`vim /etc/dovecot/conf.d/10-mail.conf`
![10-mail.conf-25.png](https://s1.imagehub.cc/images/2023/09/05/10-mail.conf-25.png)

## ã€4ã€‘é‡å¯å·¥ä½œ
é‡å¯bind
`systemctl restart named`
é‡å¯postfix
`systemctl restart postfix`
é‡å¯dovecot
`systemctl restart dovecot`

## ã€5ã€‘åˆ›å»ºmailç™»å½•ç”¨æˆ·
### ã€5.1ã€‘åˆ›å»ºç”¨æˆ·åŠè®¾ç½®å¯†ç 
åˆ›å»ºspace7ç”¨æˆ·
`useradd space7`
ä¸ºspace7ç”¨æˆ·è®¾ç½®ç™»å½•å¯†ç 
`echo "123456" | passwd --stdin space7`
![Set-a-login-password-for-space7-users.png](https://s1.imagehub.cc/images/2023/09/05/Set-a-login-password-for-space7-users.png)
### ã€5.2ã€‘åˆ›å»ºä¿å­˜é‚®ä»¶ç›®å½•
å…ˆåˆ‡æ¢åˆ°åˆšæ‰åˆ›å»ºçš„space7ç”¨æˆ·
`su - space7`
åœ¨space7å®¶ç›®å½•ä¸­åˆ›å»ºç”¨äºä¿å­˜é‚®ä»¶çš„ç›®å½•
`mkdir -p mail/.imap/INBOX`

## ã€6ã€‘éªŒæ”¶
### ã€6.1ã€‘å®‰è£…s-nail
å®‰è£…s-nailï¼Œå¦åˆ™ä¼šå‡ºç°`-bash: mailï¼šæœªæ‰¾åˆ°å‘½ä»¤`çš„æŠ¥é”™
`yum -y install s-nail`
### ã€6.2ã€‘ä½¿ç”¨rootè´¦æˆ·ç»™å…¶ä»–ç”¨æˆ·å‘é€é‚®ä»¶
ç„¶åä½¿ç”¨rootè´¦æˆ·ç»™space7ç”¨æˆ·å‘é€ä¸€å°æ ‡é¢˜ä¸º"Hello"çš„é‚®ä»¶
`echo "I am Ikun" | mail -s "Hello" space7@ninework.com`
ç„¶ååˆ‡æ¢åˆ°space7ç”¨æˆ·
`su - space7`
è¾“å…¥`mail`æŸ¥çœ‹æ”¶ä»¶ç®±
![from-root-mail-tospace7.png](https://s1.imagehub.cc/images/2023/09/05/from-root-mail-tospace7.png)
### ã€6.3ã€‘ä½¿ç”¨FoxmailéªŒè¯
å¡«å†™è´¦æˆ·å¯†ç åŠæœåŠ¡å™¨åç§°
æœåŠ¡å™¨åç§°å‡æ˜¯mail.+åŸŸå
![Foxmail-verify.png](https://s1.imagehub.cc/images/2023/09/05/Foxmail-verify.png)
å®¿ä¸»DNSé¡»æŒ‡å‘è™šæ‹ŸæœºDNS
![IPV4-PROPERTIESf90069f4b771e0dd.png](https://s1.imagehub.cc/images/2023/09/05/IPV4-PROPERTIESf90069f4b771e0dd.png)
ç‚¹å‡»åˆ›å»ºåå°±èƒ½ç™»å½•æˆåŠŸäº†
![Account-login-successful.png](https://s1.imagehub.cc/images/2023/09/05/Account-login-successful.png)
![Verifying.png](https://s1.imagehub.cc/images/2023/09/05/Verifying.png)

# <font color=red>ã€5ã€‘RsyslogæœåŠ¡å™¨æ­å»º</font>
## ã€1.1ã€‘rsyslogä»‹ç»ï¼š
rsyslog æ˜¯ä¸€ä¸ªå¿«é€Ÿå¤„ç†æ”¶é›†ç³»ç»Ÿæ—¥å¿—çš„å¼€æºç¨‹åºï¼Œæä¾›äº†é«˜æ€§èƒ½ã€å®‰å…¨åŠŸèƒ½å’Œæ¨¡å—åŒ–è®¾è®¡ã€‚rsyslog æ˜¯ syslog çš„å‡çº§ç‰ˆï¼Œå®ƒå°†å¤šç§æ¥æºè¾“å…¥è¾“å‡ºè½¬æ¢ç»“æœåˆ°ç›®çš„åœ°ï¼Œ rsyslog è¢«å¹¿æ³›ç”¨äº Linux ç³»ç»Ÿä»¥é€šè¿‡ TCP/UDP åè®®è½¬å‘æˆ–æ¥æ”¶æ—¥å¿—æ¶ˆæ¯
## ã€1.2ã€‘rsyslogç¯å¢ƒï¼š
é•œåƒç‰ˆæœ¬ï¼šRocky Linux 9.1 boot
server ipï¼š192.168.10.171
client ipï¼š192.168.10.172
å‡å…³é—­firewallåŠselinux
## ã€2ã€‘é…ç½®server
### ã€2.1ã€‘å®‰è£…rsyslog
`yum -y install rsyslog`
### ã€2.2ã€‘ä¿®æ”¹server rsyslog config
rsyslogé…ç½®æ–‡ä»¶å­˜åœ¨äº`/etc/rsyslog.conf`
`vim /etc/rsyslog.conf`
çº¢åœˆå†…çš„çš„UDPä¼ è¾“ï¼Œç»¿åœˆå†…çš„æ˜¯TCPä¼ è¾“ï¼Œçœ‹æƒ…å†µä½¿ç”¨ï¼Œç”¨å“ªä¸ªå°±æŠŠ"module"å’Œ"input"å¼€å¤´çš„2æ®µå†…å®¹å–æ¶ˆæ³¨é‡Šå³å¯
![server-rsyslog-config.png](https://s1.imagehub.cc/images/2023/09/05/server-rsyslog-config.png)
### ã€2.3ã€‘é‡å¯server rsyslog
`systemctl restart rsyslog`
### ã€2.4ã€‘å…³é—­serveré˜²ç«å¢™åŠSELinux
å…³é—­é˜²ç«å¢™ï¼š
`systemctl stop firewalld`
ä¸´æ—¶å…³é—­SELinux(ä¸‹æ¬¡é‡å¯ä¼šå†æ¬¡å¯åŠ¨SELinux)
`setenforce 0`
## ã€3ã€‘é…ç½®client
### ã€3.1ã€‘å®‰è£…rsyslog
`yum -y install rsyslog`
### ã€3.2ã€‘ä¿®æ”¹client rsyslog config
`vim /etc/rsyslog.conf`
æ‰¾åˆ°"local7.*"ï¼Œä¸€èˆ¬åœ¨60å¤šè¡Œï¼Œåœ¨"local7"ä¸‹è¾¹å¡«å†™æœåŠ¡å™¨ç«¯IPåœ°å€åŠç«¯å£
`*.*                                                     @192.168.10.181:514`(æŒ‰7ä¸‹Tabé”®)
æ³¨ï¼šå¦‚æœä½ serverç«¯å–æ¶ˆæ³¨é‡Šçš„æ˜¯TCPï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œå°±åŠ 2ä¸ª@ï¼Œ2ä¸ª@ä»£è¡¨TCPä¼ è¾“ï¼Œ1ä¸ª@ä»£è¡¨UDPä¼ è¾“
`*.*                                                     @@192.168.10.181:514`
![client-rsyslog-config-1.png](https://s1.imagehub.cc/images/2023/09/05/client-rsyslog-config-1.png)
### ã€3.3ã€‘å…¶ä»–è®°å½•å†…å®¹
[rsyslog other client config](https://www.123pan.com/s/OG4rVv-q2eJH.html) æå–ç :WL95
ä¸Šè¾¹çš„æ–‡ä»¶æ˜¯rsyslogè®°å½•å…¶ä»–æ—¥å¿—å†…å®¹çš„å‘½ä»¤ï¼Œå¯ä»¥æŒ‰éœ€å¤åˆ¶å¹¶åŠ åœ¨rsyslog.confæ–‡ä»¶æœ«
![Demonstrates-additional-client-configurations.png](https://s1.imagehub.cc/images/2023/09/05/Demonstrates-additional-client-configurations.png)
### ã€3.4ã€‘é‡å¯client rsyslog
`systemctl restart rsyslog`
### ã€3.5ã€‘å…³é—­client é˜²ç«å¢™å’ŒSELinux
å…³é—­é˜²ç«å¢™ï¼š
`systemctl stop firewalld`
ä¸´æ—¶å…³é—­SELinux(ä¸‹æ¬¡é‡å¯ä¼šå†æ¬¡å¯åŠ¨SELinux)
`setenforce 0`
## ã€4ã€‘éªŒæ”¶ç¯èŠ‚
### ã€4.1ã€‘clientç»™serverå‘é€loggerä¿¡æ¯
<font color=red>è¯´æ˜ï¼š</font>
ç”±äºæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯TCPä¼ è¾“ï¼Œæ‰€ä»¥ç»™serverå‘é€loggerä¿¡æ¯çš„å‘½ä»¤å°±æ˜¯`logger "test"`
loggeråè¾¹ç›´æ¥è·Ÿä¸ŠåŒå¼•å·å†…å®¹å°±è¡Œ

å¦‚æœèµ°çš„æ˜¯UDPï¼Œé‚£å°±åœ¨`logger`åè¾¹è·Ÿä¸Š`-d`é€‰é¡¹ï¼Œä¹Ÿå°±æ˜¯
`logger -d "test"`
![client-logger.png](https://s1.imagehub.cc/images/2023/09/05/client-logger.png)
### ã€4.2ã€‘serveréªŒè¯loggerä¿¡æ¯
clientå‘é€çš„loggerä¿¡æ¯å­˜åœ¨äº/var/log/messageså†…ï¼Œæ‰€ä»¥ç”¨tailå‘½ä»¤æŸ¥çœ‹messageså10è¡Œå†…å®¹å°±å¯ä»¥äº†
`tail /var/log/messages`
å¯ä»¥çœ‹åˆ°serverè¿™é‡Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨clientå‘é€çš„loggerä¿¡æ¯`I am Ikun`
![Server-side-acceptance.png](https://s1.imagehub.cc/images/2023/09/05/Server-side-acceptance.png)

# <font color=red>ã€6ã€‘KeepAliveé…ç½®</font>
**KeepAliveç®€ä»‹ï¼š**
Keepalivedä¸€ä¸ªåŸºäºVRRP åè®®æ¥å®ç°çš„ LVS æœåŠ¡é«˜å¯ç”¨æ–¹æ¡ˆï¼Œå¯ä»¥åˆ©ç”¨å…¶æ¥è§£å†³å•ç‚¹æ•…éšœã€‚ä¸€ä¸ªLVSæœåŠ¡ä¼šæœ‰2å°æœåŠ¡å™¨è¿è¡ŒKeepalivedï¼Œä¸€å°ä¸ºä¸»æœåŠ¡å™¨ï¼ˆMASTERï¼‰ï¼Œä¸€å°ä¸ºå¤‡ä»½æœåŠ¡å™¨ï¼ˆBACKUPï¼‰ï¼Œä½†æ˜¯å¯¹å¤–è¡¨ç°ä¸ºä¸€ä¸ªè™šæ‹ŸIPï¼Œä¸»æœåŠ¡å™¨ä¼šå‘é€ç‰¹å®šçš„æ¶ˆæ¯ç»™å¤‡ä»½æœåŠ¡å™¨ï¼Œå½“å¤‡ä»½æœåŠ¡å™¨æ”¶ä¸åˆ°è¿™ä¸ªæ¶ˆæ¯çš„æ—¶å€™ï¼Œå³ä¸»æœåŠ¡å™¨å®•æœºçš„æ—¶å€™ï¼Œ å¤‡ä»½æœåŠ¡å™¨å°±ä¼šæ¥ç®¡è™šæ‹ŸIPï¼Œç»§ç»­æä¾›æœåŠ¡ï¼Œä»è€Œä¿è¯äº†é«˜å¯ç”¨æ€§
[keepaliveå®˜ç½‘](https://www.keepalived.org "keepaliveå®˜ç½‘")
## ã€1ã€‘æµ‹è¯•ç¯å¢ƒ
|åç§°|IP|ä¼˜å…ˆçº§|
|---|---|---|
|server1|192.168.10.181|100|
|server2|192.168.10.182|99|
KeepAliveè™šæ‹ŸIP|192.168.10.180|/|
## ã€2ã€‘KeepAliveå®‰è£…
- `yum -y install keepalived`
## ã€3ã€‘é…ç½®KeepAlive
- KeepAliveé…ç½®æ–‡ä»¶è·¯å¾„ï¼š`/etc/keepalived/keepalived.conf`
### ã€1ã€‘é…ç½®server1
- 12è¡Œ
"router_id"åä¿®æ”¹ä¸ºè‡ªå·±å–œæ¬¢çš„åç§°
![1-1.png](https://s1.imagehub.cc/images/2023/10/14/1-1.png)
- 14è¡Œ
åˆ é™¤14è¡Œå†…å®¹
![2-1.png](https://s1.imagehub.cc/images/2023/10/14/2-1.png)
- 20è¡Œ
"interface"åè¾¹å†™ä¸Šç½‘å¡åç§°
![3-1.png](https://s1.imagehub.cc/images/2023/10/14/3-1.png)
ä¸çŸ¥é“ç½‘å¡åç§°ï¼Ÿ
é”®å…¥`ifconfig`
![49dae13fd0846a525.png](https://s1.imagehub.cc/images/2023/10/14/49dae13fd0846a525.png)
- 29è¡Œ
åˆ é™¤ç°æœ‰çš„IPåœ°å€ï¼Œè¾“å…¥KeepAliveè™šæ‹ŸIPåœ°å€
![5-1.png](https://s1.imagehub.cc/images/2023/10/14/5-1.png)
- 19è¡Œçš„"state MASTER"çš„MASTERæ˜¯ä¸»KeepAliveï¼Œé»˜è®¤å°±è¡Œï¼Œä¸ç”¨ä¿®æ”¹
![69bccd4bb0fc04c88.png](https://s1.imagehub.cc/images/2023/10/14/69bccd4bb0fc04c88.png)
- 22è¡Œçš„"priority"æ˜¯ä¼˜å…ˆæƒï¼Œä¼˜å…ˆæƒå€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜
é»˜è®¤å°±æ˜¯100ï¼Œ
![7210147c82a327444.png](https://s1.imagehub.cc/images/2023/10/14/7210147c82a327444.png)
- ä¿å­˜å¹¶é€€å‡º
![8605e0155765df3b3.png](https://s1.imagehub.cc/images/2023/10/14/8605e0155765df3b3.png)
- é‡å¯KeepAliveæœåŠ¡
`systemctl restart keepalived.service`
### ã€2ã€‘é…ç½®server2
- 12è¡Œ
ä¿®æ”¹åç§°
![97265c8e23581a761.png](https://s1.imagehub.cc/images/2023/10/14/97265c8e23581a761.png)
- 14è¡Œ
åˆ é™¤"vrrp_strict"
![10-1.png](https://s1.imagehub.cc/images/2023/10/14/10-1.png)
- 19è¡Œ
æ›´æ”¹æœåŠ¡å™¨æ‰®æ¼”è§’è‰²ä¸ºBACKUP
![11-1.png](https://s1.imagehub.cc/images/2023/10/14/11-1.png)
- 20è¡Œ
ä¿®æ”¹ç½‘å¡åç§°
![12-1.png](https://s1.imagehub.cc/images/2023/10/14/12-1.png)
- 22è¡Œ
ä¿®æ”¹æœåŠ¡å™¨ä¼˜å…ˆçº§ï¼Œserver1ä¼˜å…ˆçº§æ˜¯100ï¼Œserver2ä¼˜å…ˆçº§åªè¦æ¯”100ä½å°±è¡Œ
![13-1.png](https://s1.imagehub.cc/images/2023/10/14/13-1.png)
- é”®å…¥KeepAliveè™šæ‹ŸIP
![14-1.png](https://s1.imagehub.cc/images/2023/10/14/14-1.png)
- é‡å¯KeepAliveæœåŠ¡
`systemctl restart keepalived.service`
## ã€4ã€‘åˆ›å»ºHTTPç«™ç‚¹
**1-åˆ›å»ºwebä¸»é¡µæ–‡ä»¶**
- åˆ›å»ºhttpç«™ç‚¹è·¯å¾„
`mkdir -p /www/web`
- åˆ›å»ºwebä¸»é¡µæ–‡ä»¶
`touch /www/web/web.html`
- éšä¾¿åœ¨é‡Œè¾¹å†™ç‚¹å†…å®¹
![15-5.png](https://s1.imagehub.cc/images/2023/10/14/15-5.png)

**2-ä¿®æ”¹httpdé…ç½®æ–‡ä»¶**
- 124è¡Œ
![15-1.png](https://s1.imagehub.cc/images/2023/10/14/15-1.png)
- 129è¡Œ
![15-2.png](https://s1.imagehub.cc/images/2023/10/14/15-2.png)
- 136è¡Œ
![15-3.png](https://s1.imagehub.cc/images/2023/10/14/15-3.png)
- 169è¡Œ
![15-4.png](https://s1.imagehub.cc/images/2023/10/14/15-4.png)

**3-é‡å¯httpæœåŠ¡**
`systemctl restart httpd`

**4-server2é…ç½®http**
server2ä¹Ÿæ˜¯å¦‚æ³•ç‚®åˆ¶ï¼Œåªä¸è¿‡ä¸ºäº†åŒºåˆ†server1å’Œserver2ï¼Œweb.htmlçš„å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯åœ¨å®é™…ç”Ÿæ´»ä¸­ï¼Œå®ƒä»¬çš„å†…å®¹æ˜¯ä¸€è‡´çš„
![15-6.png](https://s1.imagehub.cc/images/2023/10/14/15-6.png)
## ã€5ã€‘éªŒæ”¶ç¯èŠ‚
**1-å…³é—­é˜²ç«å¢™**
`systemctl stop firewalld.service`

**2-å…³é—­SELinux**
`setenforce 0`

**3-æµè§ˆå™¨éªŒè¯**
- æµè§ˆå™¨å†…è¾“å…¥KeepAliveè™šæ‹ŸIPåï¼Œå¯ä»¥çœ‹åˆ°æ˜¯server1æ¥ç®¡çš„httpæœåŠ¡
å¦‚æœè¿™æ—¶å€™æ˜¯server2æ¥ç®¡çš„æœåŠ¡ï¼Œé‚£è¯´æ˜é…ç½®æ–‡ä»¶æ˜¯é”™è¯¯çš„
![16-1.png](https://s1.imagehub.cc/images/2023/10/14/16-1.png)

**4-æ¨¡æ‹Ÿå®•æœº**
- ç„¶ååœæ­¢server1çš„keepaliveæœåŠ¡ï¼Œæ¨¡æ‹Ÿserver1å®•æœº
`systemctl stop keepalived.service`
- æŸ¥çœ‹keepaliveæ˜¯ä¸æ˜¯æ­»æ‰äº†
`systemctl status keepalived.service`
![Snipaste_2023-10-14_18-37-19.png](https://s1.imagehub.cc/images/2023/10/14/Snipaste_2023-10-14_18-37-19.png)
- è¿™æ—¶å€™åˆ·æ–°ç½‘é¡µï¼Œå¯ä»¥çœ‹åˆ°server2å·²ç»æ¥æ›¿äº†httpæœåŠ¡
![16-2.png](https://s1.imagehub.cc/images/2023/10/14/16-2.png)

**5-é‡æ–°æ¥ç®¡**
- ç„¶åserver1 keepaliveæœåŠ¡é‡æ–°å¯åŠ¨
`systemctl start keepalived.service`
- keepaliveæ´»åŠ¨
![Snipaste_2023-10-14_18-40-59.png](https://s1.imagehub.cc/images/2023/10/14/Snipaste_2023-10-14_18-40-59.png)
- server1é‡æ–°æ¥ç®¡httpæœåŠ¡
![16-3.png](https://s1.imagehub.cc/images/2023/10/14/16-3.png)


# <font color=red>ã€7ã€‘Chronyæ—¶é—´åŒæ­¥é…ç½®</font>
**ç¯å¢ƒä»‹ç»ï¼š**
|åç§°|IP|æ‰®æ¼”è§’è‰²|é•œåƒç‰ˆæœ¬|
|---|---|---|---|
|Rocky-server|192.168.10.181|chrony server|Rocky Linux Boot 9.1|
|Rocky-client|192.168.10.182|chrony client|Rocky Linux Boot 9.1|

## ã€1ã€‘serverå®‰è£…chrony
`yum -y install chrony`
![e0594fdee12ab0ead40923c4b9bf0b48.png](https://s1.imagehub.cc/images/2023/11/01/e0594fdee12ab0ead40923c4b9bf0b48.png)

## ã€2ã€‘serverä¿®æ”¹chronyé…ç½®æ–‡ä»¶
å‘½ä»¤ï¼š`vi /etc/chrony.conf`

**1-ç¬¬3è¡Œï¼š**
æŠŠç¬¬ä¸‰è¡Œçš„å†…å®¹æ³¨é‡Šæ‰ï¼Œè¯¥è¡Œç”¨äºå¡«å†™å¤–ç½‘æ—¶é—´æœåŠ¡å™¨ç½‘å€
![6910e3629f5c87cf29c2bcd1bae0b1ee.png](https://s1.imagehub.cc/images/2023/11/01/6910e3629f5c87cf29c2bcd1bae0b1ee.png)

**2-ç¬¬4è¡Œï¼š**
æ ¼å¼ï¼šserver IP iburst
å¡«å†™æœ¬åœ°chronyæ—¶é—´åŒæ­¥æœåŠ¡å™¨
![5e5c35a289966213df67bed64104b7c1.png](https://s1.imagehub.cc/images/2023/11/01/5e5c35a289966213df67bed64104b7c1.png)

**3-ç¬¬27è¡Œï¼š**
å–æ¶ˆæ³¨é‡Šallow
ç„¶ååè¾¹å¡«å†™å…è®¸å“ªäº›æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯åˆ°è¿™å°æ—¶é—´æœåŠ¡å™¨æ¥åŒæ­¥æ—¶é—´ï¼Œå¯ä»¥æ˜¯æŸä¸ªç½‘æ®µæˆ–å…·ä½“çš„IP
![eec05d2e14d9d3215a80ee2526a0c778.png](https://s1.imagehub.cc/images/2023/11/01/eec05d2e14d9d3215a80ee2526a0c778.png)

**4-ç¬¬30è¡Œï¼š**
å–æ¶ˆæ³¨é‡Šlocal startum 10
å¦åˆ™NTP synchronized: ä¸ºno
å–æ¶ˆæ‰åå˜ä¸ºNTP synchronized:yes
![a1a4b63680c099475698213dde594ebc.png](https://s1.imagehub.cc/images/2023/11/01/a1a4b63680c099475698213dde594ebc.png)

## ã€2ã€‘é‡å¯chronyæœåŠ¡
å‘½ä»¤ï¼š`systemctl restart chronyd`
![3e2fbccc58bb6b41a2403266b8901ae5.png](https://s1.imagehub.cc/images/2023/11/01/3e2fbccc58bb6b41a2403266b8901ae5.png)
åŠ å…¥å¼€æœºè‡ªå¯ï¼š`systemctl enable chronyd`

## ã€3ã€‘æ£€æŸ¥é…ç½®
å‘½ä»¤ï¼š
`netstat -antulp|grep chronyd`
`ss -antulp|grep chronyd`
![c7e1264f53bde977dac44dd56554f4c3.png](https://s1.imagehub.cc/images/2023/11/01/c7e1264f53bde977dac44dd56554f4c3.png)

## ã€4ã€‘clientä¸‹è½½chrony
å‘½ä»¤ï¼š
`yum -y install chrony`
![1e836fd7ab5d9f8235dfae4b92877a20.png](https://s1.imagehub.cc/images/2023/11/01/1e836fd7ab5d9f8235dfae4b92877a20.png)

## ã€5ã€‘clientä¿®æ”¹chronyé…ç½®æ–‡ä»¶
å‘½ä»¤ï¼š
`vi /etc/chrony.conf`
**1-ç¬¬3è¡Œï¼š**
æ³¨é‡Šæ‰ç¬¬ä¸‰è¡Œï¼Œè¯¥è¡Œä¸ºå¡«å†™ç½‘ç»œæ—¶é—´æœåŠ¡å™¨ç½‘å€
![594de402cc14cd5297725d8b85f736b3.png](https://s1.imagehub.cc/images/2023/11/01/594de402cc14cd5297725d8b85f736b3.png)

**2-ç¬¬4è¡Œï¼š**
ç¬¬å››è¡Œå¡«å†™æœ¬åœ°chronyæœåŠ¡å™¨åœ°å€ï¼ŒæŒ‡å‘chrony server
![3f2c3155cd8d63e7205fd17783e3355a.png](https://s1.imagehub.cc/images/2023/11/01/3f2c3155cd8d63e7205fd17783e3355a.png)

## ã€6ã€‘é‡å¯chronyæœåŠ¡
é‡å¯chronyæœåŠ¡ï¼š
`systemctl restart chronyd`
å°†chronyåŠ å…¥å¼€æœºè‡ªå¯ï¼š
`systemctl enable chronyd`
![c7e06abb4d54b2b0b261ff2f748d6162.png](https://s1.imagehub.cc/images/2023/11/01/c7e06abb4d54b2b0b261ff2f748d6162.png)

## ã€7ã€‘å…³é—­é˜²ç«å¢™åŠSELinux
serverå’Œclientå‡å…³é—­
`systemctl stop firewalld`
`setenforce 0`

## ã€8ã€‘æ£€æŸ¥çŠ¶æ€
`timedatectl`
![68eaebc788137bc08c7d91468ef1a174.png](https://s1.imagehub.cc/images/2023/11/01/68eaebc788137bc08c7d91468ef1a174.png)

## ã€9ã€‘æŸ¥çœ‹æ—¶é—´æºä¿¡æ¯
**serverï¼š**
`chronyc sources -v`
![bf5e6a8b80af891518827b5650d8695a.png](https://s1.imagehub.cc/images/2023/11/01/bf5e6a8b80af891518827b5650d8695a.png)

**clientï¼š**
`chronyc sources -v`
![25de26ec99cb5deffe0033c1dd15f50b.png](https://s1.imagehub.cc/images/2023/11/01/25de26ec99cb5deffe0033c1dd15f50b.png)

## ã€10ã€‘éªŒæ”¶ç¯èŠ‚
æŸ¥çœ‹å½“å‰serveræ—¶é—´ï¼š
`date`
![c9c3149913204343851c8999c2ce38be.png](https://s1.imagehub.cc/images/2023/11/01/c9c3149913204343851c8999c2ce38be.png)
æŸ¥çœ‹å½“å‰clientæ—¶é—´ï¼š
![0c367b59ea5a27ee3c9f951fe6c1bda8.png](https://s1.imagehub.cc/images/2023/11/01/0c367b59ea5a27ee3c9f951fe6c1bda8.png)
ä¿®æ”¹serveræ—¶é—´ä¸º08:00
`date -s "2023-11-1 08:00:00"`
![9a7a1361f10d1e9104fcbb7c7df0bba4.png](https://s1.imagehub.cc/images/2023/11/01/9a7a1361f10d1e9104fcbb7c7df0bba4.png)
ç­‰å¾…å®¢æˆ·ç«¯è‡ªåŠ¨åŒæ­¥
åŒæ­¥æ—¶é—´è¾ƒä¸ºç¼“æ…¢ï¼Œæˆ‘è¿™é‡Œç”¨äº†7åˆ†é’Ÿæ‰åŒæ­¥è¿‡æ¥
![5b0e642c03b050f2a4a873ab41be114c.png](https://s1.imagehub.cc/images/2023/11/01/5b0e642c03b050f2a4a873ab41be114c.png)
åŒæ­¥æˆåŠŸåï¼ŒSystem clock synchronizedä¼šå˜ä¸º"yes"
![ed977597acf935de02291225a947b5dd.png](https://s1.imagehub.cc/images/2023/11/01/ed977597acf935de02291225a947b5dd.png)

# <font color=red>ã€8ã€‘FTPæœåŠ¡é…ç½®</font>
**1-FTPæœåŠ¡æ¦‚è¿°ï¼š**
1. FTPæ˜¯File Transfer Protocolï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰çš„è‹±æ–‡ç®€ç§°ï¼Œå®ƒå·¥ä½œåœ¨OSIæ¨¡å‹çš„ç¬¬ä¸ƒå±‚ï¼ŒTCPæ¨¡å‹çš„ç¬¬å››å±‚ä¸Šï¼Œä½¿ç”¨TCPä¼ è¾“è€Œä¸æ˜¯UDPï¼Œè¿™æ ·FTPå®¢æˆ·åœ¨å’ŒæœåŠ¡å™¨å»ºç«‹è¿æ¥å‰å°±è¦ç»è¿‡ä¸€ä¸ªè¢«å¹¿ä¸ºç†ŸçŸ¥çš„â€ä¸‰æ¬¡æ¡æ‰‹â€çš„è¿‡ç¨‹ï¼Œå®ƒå¸¦æ¥çš„æ„ä¹‰åœ¨äºå®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥æ˜¯å¯é çš„ï¼Œè€Œä¸”æ˜¯é¢å‘è¿æ¥ï¼Œä¸ºæ•°æ®çš„ä¼ è¾“æä¾›äº†å¯é çš„ä¿è¯ã€‚
2. FTPæœåŠ¡ä½¿ç”¨FTPåè®®ï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ¥è¿›è¡Œæ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„è¿›è¡Œè¿œè·ç¦»çš„æ–‡ä»¶ä¼ è¾“ï¼Œè¿˜æ”¯æŒæ–­ç‚¹ç»­ä¼ åŠŸèƒ½ï¼Œå¯ä»¥å¤§å¹…åº¦åœ°å‡å°CPUå’Œç½‘ç»œå¸¦å®½çš„å¼€é”€ï¼Œå¹¶å®ç°ç›¸åº”çš„å®‰å…¨æ§åˆ¶ã€‚
3. FTPåè®®ä¸­ï¼Œæ§åˆ¶è¿æ¥å‡æœ‰å®¢æˆ·ç«¯å‘èµ·ï¼Œè€Œæ•°æ®è¿æ¥æœ‰ä¸¤ç§å·¥ä½œæ–¹å¼ï¼šPORT(ä¸»åŠ¨)æ–¹å¼å’ŒPASV(è¢«åŠ¨)æ–¹å¼

**è¢«åŠ¨æ¨¡å¼ï¼š**
![e6d8f6b74e2aa10a6ba5947b653c7a47.png](https://s1.imagehub.cc/images/2023/11/20/e6d8f6b74e2aa10a6ba5947b653c7a47.png)

**ä¸»åŠ¨æ¨¡å¼ï¼š**
![0d5c3a6e20cc8f729ee0d27e7258ab76.png](https://s1.imagehub.cc/images/2023/11/20/0d5c3a6e20cc8f729ee0d27e7258ab76.png)

**2-FTPç™»å…¥æ¦‚è¿°ï¼š**
FTPå¯ä»¥æœ‰ä¸‰ç§ç™»å…¥æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ï¼š
1. åŒ¿åç™»å½•æ–¹å¼ï¼šä¸éœ€è¦ç”¨æˆ·å¯†ç 
2. æœ¬åœ°ç”¨æˆ·ç™»å…¥ï¼šä½¿ç”¨æœ¬åœ°ç”¨æˆ·å’Œå¯†ç ç™»å…¥
3. è™šæ‹Ÿç”¨æˆ·æ–¹å¼ï¼šä¹Ÿæ˜¯ä½¿ç”¨ç”¨æˆ·å’Œå¯†ç ç™»å…¥ï¼Œä½†æ˜¯è¯¥ç”¨æˆ·ä¸æ˜¯linuxä¸­åˆ›å»ºçš„ç”¨æˆ·

**ç¯å¢ƒä»‹ç»ï¼š**
|åç§°|IP|æ‰®æ¼”è§’è‰²|
|---|---|---|
|Rocky-Master|192.168.10.181|FTPæœåŠ¡å™¨|
|Win-Client|192.168.10.161|FTPå®¢æˆ·ç«¯|

## ã€1ã€‘å®‰è£…FTPæœåŠ¡ğŸ‘¨â€ğŸ’»
å‘½ä»¤ï¼š`yum -y install vsftpd`
![5e6e2b3b44340cda73c1a2a4853b546e.png](https://s1.imagehub.cc/images/2023/11/08/5e6e2b3b44340cda73c1a2a4853b546e.png)

## ã€2ã€‘ç¼–å†™vsftpdé…ç½®æ–‡ä»¶âœï¸
å®‰è£…å®Œä¹‹ååœ¨/etc/vsftpd/è·¯å¾„ä¸‹ä¼šå­˜åœ¨ä¸‰ä¸ªé…ç½®æ–‡ä»¶ï¼š
1. vsftpd.conf: vsftpä¸»é…ç½®æ–‡ä»¶
2. ftpusers: æŒ‡å®šå“ªäº›ç”¨æˆ·ä¸èƒ½è®¿é—®FTPæœåŠ¡å™¨,è¿™é‡Œçš„ç”¨æˆ·åŒ…æ‹¬rootåœ¨å†…çš„ä¸€äº›é‡è¦ç”¨æˆ·ã€‚
3. user_list: æŒ‡å®šçš„ç”¨æˆ·æ˜¯å¦å¯ä»¥è®¿é—®ftpæœåŠ¡å™¨ï¼Œé€šè¿‡vsftpd.confæ–‡ä»¶ä¸­çš„userlist_denyçš„é…ç½®æ¥å†³å®šé…ç½®ä¸­çš„ç”¨æˆ·æ˜¯å¦å¯ä»¥è®¿é—®ï¼Œuserlist_enable=YES ï¼Œuserlist_deny=YES ï¼Œuserlist_file=/etc/vsftpd/user_list è¿™ä¸‰ä¸ªé…ç½®å…è®¸æ–‡ä»¶ä¸­çš„ç”¨æˆ·è®¿é—®FTP

![8a825743db90991933b54a9f1a4cfa0b.png](https://s1.imagehub.cc/images/2023/11/08/8a825743db90991933b54a9f1a4cfa0b.png)

**æŸ¥çœ‹ä¸»é…ç½®æ–‡ä»¶ç¼ºçœé…ç½®ï¼š**
å‘½ä»¤ï¼š`cat /etc/vsftpd/vsftpd.conf | grep -v '^#';`
![5407a37abe209d68671af344503d6c6b.png](https://s1.imagehub.cc/images/2023/11/08/5407a37abe209d68671af344503d6c6b.png)

**å¤‡ä»½ä¸»é…ç½®æ–‡ä»¶ï¼š**
å‘½ä»¤ï¼š`cp -p vsftpd.conf vsftpd.conf.bak`
![a4822e665e3f03b3d6d35e02bd5cebea.png](https://s1.imagehub.cc/images/2023/11/08/a4822e665e3f03b3d6d35e02bd5cebea.png)

**é‡å»ºvsftpd.confï¼š**
æ¯”èµ·ç›´æ¥ä¿®æ”¹åŸæœ‰ftpé…ç½®æ–‡ä»¶ï¼Œæˆ‘æ›´å–œæ¬¢é‡å»ºftpé…ç½®æ–‡ä»¶ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨åŸé…ç½®æ–‡ä»¶ä¸Šæ”¹å†™ï¼Œçœ‹è‡ªå·±å¿ƒæƒ…å§
é‡å‘½å`vsftpd.conf`ä¸º`vsftpd.old`ï¼š
`mv /etc/vsftpd.conf vsftpd.old`
æ–°å»ºftpé…ç½®æ–‡ä»¶ï¼š
`touch /etc/vsftpd/vsftpd.conf`
**ç¼–å†™ftpé…ç½®æ–‡ä»¶ï¼š**
å‘½ä»¤ï¼š`vi /etc/vsftpd/vsftpd.conf`

## ã€3ã€‘é…ç½®æ–‡ä»¶è¯¦è§£ğŸ‘
**1-ç™»å½•è®¾ç½®ï¼š**
1. æ˜¯å¦å¯¹<font color=red>ç™»å½•ç”¨æˆ·</font>å¼€å¯å†™æƒé™ã€‚å±å…¨å±€æ€§è®¾ç½®ã€‚é»˜è®¤NO
`write_enable=YES`
2. æ˜¯å¦å…è®¸<font color=red>æœ¬åœ°ç”¨æˆ·</font>ç™»å½•FTPæœåŠ¡å™¨ã€‚é»˜è®¤ä¸ºNO
`local_enable=YES`
3. è®¾ç½®æ˜¯å¦å…è®¸<font color=red>åŒ¿åç”¨æˆ·</font>ç™»å½•FTPæœåŠ¡å™¨ã€‚é»˜è®¤ä¸ºYES
`anonymous_enable=YES`
4. å®šä¹‰<font color=red>åŒ¿åç”¨æˆ·</font>çš„è´¦æˆ·åç§°ï¼Œé»˜è®¤å€¼ä¸ºftp
`ftp_username=ftp`
5. <font color=red>åŒ¿åç”¨æˆ·</font>ç™»å½•æ—¶æ˜¯å¦è¯¢é—®å£ä»¤ã€‚è®¾ç½®ä¸ºYESï¼Œåˆ™ä¸è¯¢é—®ã€‚é»˜è®¤NO
`no_anon_password=YES`
6. <font color=red>åŒ¿åç”¨æˆ·</font>æ˜¯å¦å…è®¸ä¸‹è½½å¯é˜…è¯»çš„æ–‡æ¡£ï¼Œé»˜è®¤ä¸ºYES
`anon_world_readable_only=YES`
7. æ˜¯å¦å…è®¸<font color=red>åŒ¿åç”¨æˆ·</font>ä¸Šä¼ æ–‡ä»¶ã€‚åªæœ‰åœ¨write_enableè®¾ç½®ä¸ºYESæ—¶ï¼Œè¯¥é…ç½®é¡¹æ‰æœ‰æ•ˆã€‚è€Œä¸”åŒ¿åç”¨æˆ·å¯¹ç›¸åº”çš„ç›®å½•å¿…é¡»æœ‰å†™æƒé™ã€‚é»˜è®¤ä¸ºNO
`anon_upload_enable=YES`
8. æ˜¯å¦å…è®¸<font color=red>åŒ¿åç”¨æˆ·</font>åˆ›å»ºç›®å½•ã€‚åªæœ‰åœ¨write_enableè®¾ç½®ä¸ºYESæ—¶æœ‰æ•ˆã€‚ä¸”åŒ¿åç”¨æˆ·å¯¹ä¸Šå±‚ç›®å½•æœ‰å†™å…¥çš„æƒé™ã€‚é»˜è®¤ä¸ºNO
`anon_mkdir_write_enable=YES`
9. è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™<font color=red>åŒ¿åç”¨æˆ·</font>ä¼šè¢«å…è®¸æ‹¥æœ‰å¤šäºä¸Šä¼ å’Œå»ºç«‹ç›®å½•çš„æƒé™ï¼Œè¿˜ä¼šæ‹¥æœ‰åˆ é™¤å’Œæ›´åæƒé™ã€‚é»˜è®¤å€¼ä¸ºNO
`anon_other_write_enable=NO`

**2-æ¬¢è¿ä¿¡æ¯è®¾ç½®**
1. ç”¨æˆ·ç™»å½•FTPæœåŠ¡å™¨æˆåŠŸåï¼ŒæœåŠ¡å™¨å¯å‘ç™»å½•ç”¨æˆ·è¾“å‡ºé¢„è®¾ç½®çš„æ¬¢è¿ä¿¡æ¯ï¼Œè¯¥é…ç½®é¡¹ä»…ç”¨äºè®¾ç½®æ¯”è¾ƒç®€çŸ­çš„æ¬¢è¿ä¿¡æ¯
`ftpd_banner=Welcome To My FTP Site`
2. è‹¥æ¬¢è¿ä¿¡æ¯è¾ƒå¤šï¼Œåˆ™å¯ä½¿ç”¨banner_fileé…ç½®é¡¹
`banner_file=/etc/vsftpd/banner`
3. è®¾ç½®ç”¨æˆ·ç™»å½•æ—¶ï¼Œå°†è¦æ˜¾ç¤ºè¾“å‡ºçš„æ–‡ä»¶ã€‚è¯¥è®¾ç½®é¡¹å°†è¦†ç›–ftpd_bannerçš„è®¾ç½®
`dirmessage_enable=YES`
4. è®¾ç½®æ˜¯å¦æ˜¾ç¤ºç›®å½•æ¶ˆæ¯ã€‚è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™å½“ç”¨æˆ·è¿›å…¥ç‰¹å®šç›®å½•ï¼ˆæ¯”å¦‚/var/ftp/pubï¼‰æ—¶ï¼Œå°†æ˜¾ç¤ºè¯¥ç›®å½•ä¸­çš„ç”±message_fileé…ç½®é¡¹æŒ‡å®šçš„æ–‡ä»¶ï¼ˆ.messageï¼‰ä¸­çš„å†…å®¹
`message_file=.message`

**3-ç”¨æˆ·ç™»å½•åæ‰€åœ¨çš„ç›®å½•è®¾ç½®ï¼š**
1. è®¾ç½®æœ¬åœ°ç”¨æˆ·ç™»å½•åæ‰€åœ¨çš„ç›®å½•ã€‚é»˜è®¤é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰è®¾ç½®è¯¥é¡¹ï¼Œæ­¤æ—¶ç”¨æˆ·ç™»å½•FTPæœåŠ¡å™¨åï¼Œæ‰€åœ¨çš„ç›®å½•ä¸ºè¯¥ç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œå¯¹äºrootç”¨æˆ·ï¼Œåˆ™ä¸º/rootç›®å½•
`local_root=/var/ftp`
2. è®¾ç½®åŒ¿åç”¨æˆ·ç™»å½•åæ‰€åœ¨çš„ç›®å½•ã€‚è‹¥æœªæŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸º/var/ftpç›®å½•
`anon_root=/var/ftp`

**4-æ§åˆ¶ç”¨æˆ·æ˜¯å¦å…è®¸åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•è®¾ç½®ï¼š**
åœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨â€œcd..â€å‘½ååˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•ã€‚æ¯”å¦‚ï¼Œè‹¥ç”¨æˆ·ç™»å½•åæ‰€åœ¨çš„ç›®å½•ä¸º/var/ftpï¼Œåˆ™åœ¨"ftp>"å‘½ä»¤è¡Œä¸‹ï¼Œæ‰§è¡Œâ€œcd..â€å‘½ä»¤åï¼Œç”¨æˆ·å°†åˆ‡æ¢åˆ°å…¶ä¸Šçº§ç›®å½•/varï¼Œè‹¥ç»§ç»­æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œåˆ™å¯è¿›å…¥Linuxç³»ç»Ÿçš„æ ¹ç›®å½•ï¼Œä»è€Œå¯ä»¥å¯¹æ•´ä¸ªLinuxçš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ“ä½œ
å¦‚æœåŒæ—¶è®¾ç½®äº†`write_enable=YES`ï¼Œåˆ™ç”¨æˆ·è¿˜å¯å¯¹æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡Œæ”¹å†™æ“ä½œï¼Œä¼šç»™ç³»ç»Ÿå¸¦æ¥æå¤§çš„å®‰å…¨éšæ‚£ï¼Œå› æ­¤ï¼Œå¿…é¡»é˜²æ­¢ç”¨æˆ·åˆ‡æ¢åˆ°Linuxçš„æ ¹ç›®å½•

1. è®¾ç½®æ˜¯å¦å¯ç”¨chroot_list_fileé…ç½®é¡¹æŒ‡å®šçš„ç”¨æˆ·åˆ—è¡¨æ–‡ä»¶ã€‚è®¾ç½®ä¸ºYESåˆ™é™¤äº†åˆ—åœ¨j/etc/vsftpd/chroot_listæ–‡ä»¶ä¸­çš„çš„å¸å·å¤–ï¼Œæ‰€æœ‰ç™»å½•çš„ç”¨æˆ·éƒ½å¯ä»¥è¿›å…¥ftpæ ¹ç›®å½•ä¹‹å¤–çš„ç›®å½•ã€‚é»˜è®¤NO
`chroot_list_enable=YES`
2. ç”¨äºæŒ‡å®šç”¨æˆ·åˆ—è¡¨æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨äºæ§åˆ¶å“ªäº›ç”¨æˆ·å¯ä»¥åˆ‡æ¢åˆ°FTPç«™ç‚¹æ ¹ç›®å½•çš„ä¸Šçº§ç›®å½•
`chroot_list_file=/etc/vsftpd/chroot_list`
3. ç”¨äºæŒ‡å®šç”¨æˆ·åˆ—è¡¨æ–‡ä»¶ä¸­çš„ç”¨æˆ·ï¼Œæ˜¯å¦å…è®¸åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•ã€‚é»˜è®¤NO
`chroot_local_user=YES`

**å…·ä½“æƒ…å†µç¤ºä¾‹ï¼š**
1. å½“chroot_list_enable=YESï¼Œchroot_local_user=YESæ—¶:
åœ¨/etc/vsftpd/chroot_listæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç”¨æˆ·ï¼Œå¯ä»¥åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•ï¼›æœªåœ¨æ–‡ä»¶ä¸­åˆ—å‡ºçš„ç”¨æˆ·ï¼Œä¸èƒ½åˆ‡æ¢åˆ°ç«™ç‚¹æ ¹ç›®å½•çš„ä¸Šçº§ç›®å½•
2. å½“chroot_list_enable=YESï¼Œchroot_local_user=NOæ—¶:
åœ¨/etc/vsftpd/chroot_listæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç”¨æˆ·ï¼Œä¸èƒ½åˆ‡æ¢åˆ°ç«™ç‚¹æ ¹ç›®å½•çš„ä¸Šçº§ç›®å½•ï¼›æœªåœ¨æ–‡ä»¶ä¸­åˆ—å‡ºçš„ç”¨æˆ·ï¼Œå¯ä»¥åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•
3. å½“chroot_list_enable=NOï¼Œchroot_local_user=YESæ—¶:
æ‰€æœ‰ç”¨æˆ·å‡ä¸èƒ½åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•
4. å½“chroot_list_enable=NOï¼Œchroot_local_user=NOæ—¶:
æ‰€æœ‰ç”¨æˆ·å‡å¯ä»¥åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•
5. å½“ç”¨æˆ·ä¸å…è®¸åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•æ—¶ï¼Œç™»å½•åFTPç«™ç‚¹çš„æ ¹ç›®å½•â€œ/â€æ˜¯è¯¥FTPè´¦æˆ·çš„ä¸»ç›®å½•ï¼Œå³æ–‡ä»¶çš„ç³»ç»Ÿçš„/var/ftpç›®å½•

**5-è®¿é—®æ§åˆ¶è®¾ç½®ï¼š**
<font color=DeepSkyBlue>1):è®¾ç½®å…è®¸æˆ–ä¸å…è®¸è®¿é—®çš„ä¸»æœºï¼š</font>
tcp_wrappers=YESç”¨æ¥è®¾ç½®vsftpdæœåŠ¡å™¨æ˜¯å¦ä¸tcp wrapperç›¸ç»“åˆï¼Œè¿›è¡Œä¸»æœºçš„è®¿é—®æ§åˆ¶ã€‚é»˜è®¤è®¾ç½®ä¸ºYESï¼ŒvsftpdæœåŠ¡å™¨ä¼šæ£€æŸ¥/etc/hosts.allowå’Œ/etc/hosts.denyä¸­çš„è®¾ç½®ï¼Œä»¥å†³å®šè¯·æ±‚è¿æ¥çš„ä¸»æœºæ˜¯å¦å…è®¸è®¿é—®è¯¥FTPæœåŠ¡å™¨ã€‚è¿™ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥èµ·åˆ°ç®€æ˜“çš„é˜²ç«å¢™åŠŸèƒ½ã€‚
æ¯”å¦‚ï¼Œè‹¥è¦ä»…å…è®¸192.168.168.1ï½192.168.168.254çš„ç”¨æˆ·ï¼Œå¯ä»¥è®¿é—®è¿æ¥vsftpdæœåŠ¡å™¨ï¼Œåˆ™å¯åœ¨/etc/hosts.allowæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
```
vsftpd:192.168.168.0/255.255.255.0:allow
all:all:deny
```
<font color=DeepSkyBlue>2):è®¾ç½®å…è®¸æˆ–ä¸å…è®¸è®¿é—®çš„ç”¨æˆ·ï¼š</font>

å¯¹ç”¨æˆ·çš„è®¿é—®æ§åˆ¶ç”±<font color=Lime>/etc/vsftpd/user_list</font>å’Œ<font color=Lime>/etc/vsftpd/ftpusers</font>æ–‡ä»¶æ¥æ§åˆ¶å®ç°:
1. å†³å®š/etc/vsftpd/user_listæ–‡ä»¶æ˜¯å¦å¯ç”¨ç”Ÿæ•ˆã€‚YESåˆ™ç”Ÿæ•ˆï¼ŒNOä¸ç”Ÿæ•ˆ
`userlist_enable=YES`
2. å†³å®š/etc/vsftpd/user_listæ–‡ä»¶ä¸­çš„ç”¨æˆ·æ˜¯å…è®¸è®¿é—®è¿˜æ˜¯ä¸å…è®¸è®¿é—®ã€‚è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™/etc/vsftpd/user_listæ–‡ä»¶ä¸­çš„ç”¨æˆ·å°†ä¸å…è®¸è®¿é—®FTPæœåŠ¡å™¨ï¼›è‹¥è®¾ç½®ä¸ºNOï¼Œåˆ™åªæœ‰vsftpd.user_listæ–‡ä»¶ä¸­çš„ç”¨æˆ·ï¼Œæ‰èƒ½è®¿é—®FTPæœåŠ¡å™¨
`userlist_deny=YES`

**6-è®¿é—®é€Ÿåº¦è®¾ç½®ï¼š**

1. è®¾ç½®åŒ¿åç”¨æˆ·æ‰€èƒ½ä½¿ç”¨çš„æœ€å¤§ä¼ è¾“é€Ÿåº¦ï¼Œå•ä½ä¸ºb/sã€‚è‹¥è®¾ç½®ä¸º0ï¼Œåˆ™ä¸å—é€Ÿåº¦é™åˆ¶ï¼Œé»˜è®¤å€¼ä¸º0
`anon_max_rate=0`
2. è®¾ç½®æœ¬åœ°ç”¨æˆ·æ‰€èƒ½ä½¿ç”¨çš„æœ€å¤§ä¼ è¾“é€Ÿåº¦
`local_max_rate=0`

**7-å®šä¹‰ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼š**
åœ¨vsftpdæœåŠ¡å™¨ä¸­ï¼Œä¸åŒç”¨æˆ·è¿˜å¯ä½¿ç”¨ä¸åŒçš„é…ç½®ï¼Œè¿™è¦é€šè¿‡ç”¨æˆ·é…ç½®æ–‡ä»¶æ¥å®ç°ã€‚
user_config_dir=/etc/vsftpd/userconf
ç”¨äºè®¾ç½®ç”¨æˆ·é…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚
è®¾ç½®äº†è¯¥é…ç½®é¡¹åï¼Œå½“ç”¨æˆ·ç™»å½•FTPæœåŠ¡å™¨æ—¶ï¼Œç³»ç»Ÿå°±ä¼šåˆ°/etc/vsftpd/userconfç›®å½•ä¸‹è¯»å–ä¸å½“å‰ç”¨æˆ·åç›¸åŒçš„æ–‡ä»¶ï¼Œå¹¶æ ¹æ®æ–‡ä»¶ä¸­çš„é…ç½®å‘½ä»¤ï¼Œå¯¹å½“å‰ç”¨æˆ·è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„é…ç½®ã€‚æ¯”å¦‚ï¼Œåˆ©ç”¨ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼Œå¯å®ç°å¯¹ä¸åŒç”¨æˆ·è¿›è¡Œè®¿é—®çš„é€Ÿåº¦è¿›è¡Œæ§åˆ¶ï¼Œåœ¨å„ç”¨æˆ·é…ç½®æ–‡ä»¶ä¸­ï¼Œå®šä¹‰local_max_rateé…ç½®ï¼Œä»¥å†³å®šè¯¥ç”¨æˆ·å…è®¸çš„è®¿é—®é€Ÿåº¦ã€‚

**8-è¿æ¥è®¾ç½®ï¼š**
1. è®¾ç½®vsftpdæœåŠ¡å™¨æ˜¯å¦ä»¥standaloneæ¨¡å¼è¿è¡Œã€‚ä»¥standaloneæ¨¡å¼è¿è¡Œæ˜¯ä¸€ç§è¾ƒå¥½çš„æ–¹å¼ï¼Œæ­¤æ—¶listenå¿…é¡»è®¾ç½®ä¸ºYESï¼Œæ­¤ä¸ºé»˜è®¤å€¼ï¼Œå»ºè®®ä¸è¦æ›´æ”¹ã€‚å¾ˆå¤šä¸æœåŠ¡å™¨è¿è¡Œç›¸å…³çš„é…ç½®å‘½ä»¤ï¼Œéœ€è¦æ­¤è¿è¡Œæ¨¡å¼æ‰æœ‰æ•ˆã€‚è‹¥è®¾ç½®ä¸ºNOï¼Œåˆ™vsftpdä¸æ˜¯ä»¥ç‹¬ç«‹çš„æœåŠ¡è¿è¡Œï¼Œè¦å—xinetdæœåŠ¡çš„ç®¡ç†æ§åˆ¶ï¼ŒåŠŸèƒ½ä¸Šä¼šå—é™åˆ¶
`listen=YES`
2. è®¾ç½®vsftpdå…è®¸çš„æœ€å¤§è¿æ¥æ•°ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºä¸å—é™åˆ¶ã€‚è‹¥è®¾ç½®ä¸º150æ—¶ï¼Œåˆ™åŒæ—¶å…è®¸æœ‰150ä¸ªè¿æ¥ï¼Œè¶…å‡ºçš„å°†æ‹’ç»å»ºç«‹è¿æ¥ã€‚åªæœ‰åœ¨ä»¥standaloneæ¨¡å¼è¿è¡Œæ—¶æ‰æœ‰æ•ˆ
`max_clients=0`
3. è®¾ç½®åœ¨æŒ‡å®šçš„IPåœ°å€ä¸Šä¾¦å¬ç”¨æˆ·çš„FTPè¯·æ±‚ã€‚è‹¥ä¸è®¾ç½®ï¼Œåˆ™å¯¹æœåŠ¡å™¨æ‰€ç»‘å®šçš„æ‰€æœ‰IPåœ°å€è¿›è¡Œä¾¦å¬ã€‚åªæœ‰åœ¨ä»¥standaloneæ¨¡å¼è¿è¡Œæ—¶æ‰æœ‰æ•ˆã€‚å¯¹äºåªç»‘å®šäº†ä¸€ä¸ªIPåœ°å€çš„æœåŠ¡å™¨ï¼Œä¸éœ€è¦é…ç½®è¯¥é¡¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰è¯¥é…ç½®é¡¹ã€‚è‹¥æœåŠ¡å™¨åŒæ—¶ç»‘å®šäº†å¤šä¸ªIPåœ°å€ï¼Œåˆ™åº”é€šè¿‡è¯¥é…ç½®é¡¹ï¼ŒæŒ‡å®šåœ¨å“ªä¸ªIPåœ°å€ä¸Šæä¾›FTPæœåŠ¡ï¼Œå³æŒ‡å®šFTPæœåŠ¡å™¨æ‰€ä½¿ç”¨çš„IPåœ°å€ã€‚
æ³¨æ„ï¼šè®¾ç½®æ­¤å€¼å‰åï¼Œå¯ä»¥é€šè¿‡netstat -tnlå¯¹æ¯”ç«¯å£çš„ç›‘å¬æƒ…å†µ
`max_per_ip=0`
4. è®¾ç½®åœ¨æŒ‡å®šçš„IPåœ°å€ä¸Šä¾¦å¬ç”¨æˆ·çš„FTPè¯·æ±‚ã€‚è‹¥ä¸è®¾ç½®ï¼Œåˆ™å¯¹æœåŠ¡å™¨æ‰€ç»‘å®šçš„æ‰€æœ‰IPåœ°å€è¿›è¡Œä¾¦å¬ã€‚åªæœ‰åœ¨ä»¥standaloneæ¨¡å¼è¿è¡Œæ—¶æ‰æœ‰æ•ˆã€‚å¯¹äºåªç»‘å®šäº†ä¸€ä¸ªIPåœ°å€çš„æœåŠ¡å™¨ï¼Œä¸éœ€è¦é…ç½®è¯¥é¡¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰è¯¥é…ç½®é¡¹ã€‚è‹¥æœåŠ¡å™¨åŒæ—¶ç»‘å®šäº†å¤šä¸ªIPåœ°å€ï¼Œåˆ™åº”é€šè¿‡è¯¥é…ç½®é¡¹ï¼ŒæŒ‡å®šåœ¨å“ªä¸ªIPåœ°å€ä¸Šæä¾›FTPæœåŠ¡ï¼Œå³æŒ‡å®šFTPæœåŠ¡å™¨æ‰€ä½¿ç”¨çš„IPåœ°å€ã€‚
æ³¨æ„ï¼šè®¾ç½®æ­¤å€¼å‰åï¼Œå¯ä»¥é€šè¿‡netstat -tnlå¯¹æ¯”ç«¯å£çš„ç›‘å¬æƒ…å†µ
`listen_address=IPåœ°å€`
5. è®¾ç½®å»ºç«‹è¢«åŠ¨ï¼ˆPASVï¼‰æ•°æ®è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œé»˜è®¤å€¼ä¸º60
`accept_timeout=60`
6. PORTæ–¹å¼ä¸‹å»ºç«‹æ•°æ®è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’
`connect_timeout=60`
7. è®¾ç½®å»ºç«‹FTPæ•°æ®è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º300ç§’
`data_connection_timeout=300`
8. è®¾ç½®å¤šé•¿æ—¶é—´ä¸å¯¹FTPæœåŠ¡å™¨è¿›è¡Œä»»ä½•æ“ä½œï¼Œåˆ™æ–­å¼€è¯¥FTPè¿æ¥ï¼Œå•ä½ä¸ºç§’ï¼Œé»˜è®¤ä¸º600ç§’ã€‚å³è®¾ç½®å‘å‘†çš„é€¾æ—¶æ—¶é—´ï¼Œåœ¨è¿™ä¸ªæ—¶é—´å†…ï¼Œè‹¥æ²¡æœ‰æ•°æ®ä¼ é€æˆ–æŒ‡ä»¤çš„è¾“å…¥ï¼Œåˆ™ä¼šå¼ºè¡Œæ–­å¼€è¿æ¥
`idle_session_timeoutï¼600`
9. è®¾ç½®åœ¨PAMæ‰€ä½¿ç”¨çš„åç§°ï¼Œé»˜è®¤å€¼ä¸ºvsftpd
`pam_service_name=vsftpd`
10. è®¾ç½®æ¯ä¸ªä¸FTPæœåŠ¡å™¨çš„è¿æ¥ï¼Œæ˜¯å¦ä»¥ä¸åŒçš„è¿›ç¨‹è¡¨ç°å‡ºæ¥ï¼Œé»˜è®¤å€¼ä¸ºNOï¼Œæ­¤æ—¶åªæœ‰ä¸€ä¸ªåä¸ºvsftpdçš„è¿›ç¨‹ã€‚è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™æ¯ä¸ªè¿æ¥éƒ½ä¼šæœ‰ä¸€ä¸ªvsftpdè¿›ç¨‹ï¼Œä½¿ç”¨â€œps -ef|grep ftpâ€å‘½ä»¤å¯æŸ¥çœ‹åˆ°è¯¦ç»†çš„FTPè¿æ¥ä¿¡æ¯ã€‚å®‰å…¨èµ·è§ï¼Œå»ºè®®å…³é—­
`setproctitle_enable=NO|YES`

**9-FTPå·¥ä½œæ–¹å¼ä¸ç«¯å£è®¾ç½®ï¼š**
<font color=DeepSkyBlue>1):FTPå·¥ä½œæ–¹å¼ç®€ä»‹ï¼š</font>
|FTPå·¥ä½œæ¨¡å¼|å·¥ä½œæ–¹å¼|å®¢æˆ·ç«¯è¿æ¥æ¨¡å¼|å¤‡æ³¨|
|---|---|---|---|
|PORT(ä¸»åŠ¨)|æ•°æ®ä¼ è¾“ç«¯å£ç”±FTPæœåŠ¡å™¨æŒ‡å®š|PASV|è‹¥å®¢æˆ·ç«¯è¿æ¥ç±»å‹è®¾ç½®ä¸ºPORTï¼Œåˆ™èƒ½å»ºç«‹FTPè¿æ¥ï¼Œä½†åœ¨æ‰§è¡Œlsæˆ–getç­‰éœ€è¦æ•°æ®è¯·æ±‚çš„å‘½ä»¤æ—¶ï¼Œå°†ä¼šå‡ºç°æ— å“åº”å¹¶æœ€ç»ˆæŠ¥å‘Šæ— æ³•å»ºç«‹æ•°æ®è¿æ¥|
|PASV(è¢«åŠ¨)|æ•°æ®ä¼ è¾“ç«¯å£ç”±FTPå®¢æˆ·ç«¯æŒ‡å®š|/|/|

<font color=DeepSkyBlue>2):ç«¯å£ç›¸å…³é…ç½®ï¼š</font>

1. è®¾ç½®FTPæœåŠ¡å™¨å»ºç«‹è¿æ¥æ‰€ä¾¦å¬çš„ç«¯å£ï¼Œé»˜è®¤å€¼ä¸º21
`listen_port=21`
2. è¿æ¥éæ ‡å‡†ç«¯å£ç¤ºä¾‹ï¼šftp www.sunflower.org 7000
é»˜è®¤å€¼ä¸ºYESï¼ŒæŒ‡å®šFTPæ•°æ®ä¼ è¾“è¿æ¥ä½¿ç”¨20ç«¯å£ã€‚è‹¥è®¾ç½®ä¸ºNOï¼Œåˆ™è¿›è¡Œæ•°æ®è¿æ¥æ—¶ï¼Œæ‰€ä½¿ç”¨çš„ç«¯å£ç”±ftp_data_portæŒ‡å®š
`connect_from_port_20ï¼YES`
3. è®¾ç½®PORTæ–¹å¼ä¸‹FTPæ•°æ®è¿æ¥æ‰€ä½¿ç”¨çš„ç«¯å£ï¼Œé»˜è®¤å€¼ä¸º20
`ftp_data_port=20`
4. è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™ä½¿ç”¨PASVå·¥ä½œæ¨¡å¼ï¼›è‹¥è®¾ç½®ä¸ºNOï¼Œä½¿ç”¨PORTæ¨¡å¼ã€‚é»˜è®¤ä¸ºYESï¼Œå³ä½¿ç”¨PASVæ¨¡å¼
`pasv_enable=YES|NO`
5. è®¾ç½®åœ¨PASVå·¥ä½œæ–¹å¼ä¸‹ï¼Œæ•°æ®è¿æ¥å¯ä»¥ä½¿ç”¨çš„ç«¯å£èŒƒå›´çš„ä¸Šç•Œã€‚é»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºä»»æ„ç«¯å£
`pasv_max_port=0`
6. è®¾ç½®åœ¨PASVå·¥ä½œæ–¹å¼ä¸‹ï¼Œæ•°æ®è¿æ¥å¯ä»¥ä½¿ç”¨çš„ç«¯å£èŒƒå›´çš„ä¸‹ç•Œã€‚é»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºä»»æ„ç«¯å£
`pasv_mim_port=0`

**10-ä¼ è¾“æ¨¡å¼è®¾ç½®ï¼š**
FTPåœ¨ä¼ è¾“æ•°æ®æ—¶ï¼Œå¯ä½¿ç”¨äºŒè¿›åˆ¶ï¼ˆBinaryï¼‰æ–¹å¼ï¼Œä¹Ÿå¯ä½¿ç”¨ASCIIæ¨¡å¼æ¥ä¸Šä¼ æˆ–ä¸‹è½½æ•°æ®
1. è®¾ç½®æ˜¯å¦å¯ç”¨ASCIIæ¨¡å¼ä¸‹è½½æ•°æ®ã€‚é»˜è®¤ä¸ºNO
`ascii_download_enable=YES`
2. è®¾ç½®æ˜¯å¦å¯ç”¨ASCIIæ¨¡å¼ä¸Šä¼ æ•°æ®ã€‚é»˜è®¤ä¸ºNO
`ascii_upload_enable=YES`

**11-ä¸Šä¼ æ–‡æ¡£çš„æ‰€å±å…³ç³»å’Œæƒé™è®¾ç½®ï¼š**

<font color=DeepSkyBlue>1):è®¾ç½®åŒ¿åä¸Šä¼ æ–‡æ¡£çš„å±ä¸»ï¼š</font>

ç”¨äºè®¾ç½®æ˜¯å¦æ”¹å˜åŒ¿åç”¨æˆ·ä¸Šä¼ çš„æ–‡æ¡£çš„å±ä¸»ã€‚é»˜è®¤ä¸ºNOã€‚è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™åŒ¿åç”¨æˆ·ä¸Šä¼ çš„æ–‡æ¡£çš„å±ä¸»å°†è¢«è®¾ç½®ä¸ºchown_usernameé…ç½®é¡¹æ‰€è®¾ç½®çš„ç”¨æˆ·å
`chown_uploads=YES`
è®¾ç½®åŒ¿åç”¨æˆ·ä¸Šä¼ çš„æ–‡æ¡£çš„å±ä¸»åã€‚åªæœ‰chown_uploads=YESæ—¶æ‰æœ‰æ•ˆã€‚å»ºè®®ä¸è¦è®¾ç½®ä¸ºrootç”¨æˆ·ã€‚ ä½†ç³»ç»Ÿé»˜root
`chown_username=whoever`

<font color=DeepSkyBlue>2):æ–°å¢æ–‡æ¡£çš„æƒé™è®¾å®šï¼š</font>

è®¾ç½®æœ¬åœ°ç”¨æˆ·æ–°å¢æ–‡æ¡£çš„umaskï¼Œé»˜è®¤ä¸º022ï¼Œå¯¹åº”çš„æƒé™ä¸º755ã€‚umaskä¸º022ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶æ•°ä¸º000 010 010ï¼Œå°†å…¶å–åä¸º111 101 101ï¼Œè½¬æ¢æˆåè¿›åˆ¶æ•°ï¼Œå³ä¸ºæƒé™å€¼755ï¼Œä»£è¡¨æ–‡æ¡£çš„æ‰€æœ‰è€…ï¼ˆå±ä¸»ï¼‰æœ‰è¯»å†™æ‰§è¡Œæƒï¼Œæ‰€å±ç»„æœ‰è¯»å’Œæ‰§è¡Œæƒï¼Œå…¶ä»–ç”¨æˆ·æœ‰è¯»å’Œæ‰§è¡Œæƒã€‚022é€‚åˆäºå¤§å¤šæ•°æƒ…å†µï¼Œä¸€èˆ¬ä¸éœ€è¦æ›´æ”¹ã€‚è‹¥è®¾ç½®ä¸º077ï¼Œåˆ™å¯¹åº”çš„æƒé™ä¸º700
`local_umask=022`
è®¾ç½®åŒ¿åç”¨æˆ·æ–°å¢æ–‡æ¡£çš„umaskã€‚é»˜è®¤077
`anon_umask=022`
è®¾ç½®ä¸Šä¼ æ–‡æ¡£çš„æƒé™ã€‚æƒé™é‡‡ç”¨æ•°å­—æ ¼å¼ã€‚ é»˜è®¤0666
`file_open_mode=0755`

**12-æ—¥å¿—è®¾ç½®ï¼š**
1. æ˜¯å¦å¯ç”¨ä¸Šä¼ /ä¸‹è½½æ—¥å¿—è®°å½•ã€‚é»˜è®¤ä¸ºNO
`xferlog_enable=YES`
2. è®¾ç½®æ—¥å¿—æ–‡ä»¶ååŠè·¯å¾„ã€‚éœ€å¯ç”¨xferlog_enableé€‰é¡¹
`xferlog_file=var/log/vsftpd.log`
3. æ—¥å¿—æ–‡ä»¶æ˜¯å¦ä½¿ç”¨æ ‡å‡†çš„xferlogæ—¥å¿—æ–‡ä»¶æ ¼å¼ï¼ˆä¸wu-ftpdä½¿ç”¨çš„æ ¼å¼ç›¸åŒï¼‰ ã€‚é»˜è®¤ä¸ºNO
`xferlog_std_format=YES`

**13-å…¶ä»–è®¾ç½®ï¼š**
1. è®¾ç½®åœ¨æ‰§è¡Œlså‘½ä»¤æ—¶ï¼Œæ˜¯æ˜¾ç¤ºUIDã€GIDè¿˜æ˜¯æ˜¾ç¤ºå‡ºå…·ä½“çš„ç”¨æˆ·åæˆ–ç»„åç§°ã€‚é»˜è®¤ä¸ºNOï¼Œä»¥UIDå’ŒGIDæ–¹å¼æ˜¾ç¤ºï¼Œè‹¥å¸Œæœ›æ˜¾ç¤ºç”¨æˆ·åå’Œç»„åç§°ï¼Œåˆ™è®¾ç½®ä¸ºYES
`text_userdb_names=NO`
2. è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™å…è®¸æ‰§è¡Œâ€œls â€“Râ€è¿™ä¸ªå‘½ä»¤ï¼Œé»˜è®¤å€¼ä¸ºNOã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­è¯¥é…ç½®é¡¹è¢«æ³¨é‡Šæ‰äº†ï¼Œä¸æ­¤ç±»ä¼¼çš„è¿˜æœ‰ä¸€äº›é…ç½®ï¼Œéœ€è¦å¯ç”¨æ—¶ï¼Œå°†æ³¨é‡Šç¬¦å»æ‰å¹¶è¿›è¡ŒYESæˆ–NOçš„è®¾ç½®å³å¯
`ls_recurse_enable=YES`

## ã€4ã€‘ç¼–å†™vsftpd.conf
```
anonymous_enable=YES
write_enable=YES
local_umask=022
anon_upload_enable=YES
anon_mkdir_write_enable=YES
anon_other_write_enable=YES
anon_root=/var/ftp/pub
ftp_username=ftp
ftpd_banner=Welcome To My FTP Site
```
## ã€5ã€‘è®¾ç½®æ˜ å°„æ–‡ä»¶å¤¹æƒé™
è®¾ç½®FTPæ‰€æ˜ å°„çš„æ–‡ä»¶å¤¹/var/ftp/pubä¸º755
å‘½ä»¤ï¼š`chmod 755 /var/ftp/pub`
[è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-Linuxä¸»æœºæ–‡ä»¶777ï¼Œ755ï¼Œ644æƒé™è¯¦è§£[é€šä¿—æ˜“æ‡‚]](https://cloud.tencent.com/developer/article/2029893 "è…¾è®¯äº‘-Linuxä¸»æœºæ–‡ä»¶777ï¼Œ755ï¼Œ644æƒé™è¯¦è§£[é€šä¿—æ˜“æ‡‚]")

## ã€6ã€‘éªŒæ”¶ç¯èŠ‚
**é‡å¯vsftpdï¼š**
`systemctl restart vsftpd`
**é˜²ç«å¢™å…è®¸é€šè¿‡21ç«¯å£ï¼š**
`firewall-cmd --zone=public --add-port=21/tcp --permanent`
**æˆ–è€…ç›´æ¥å…³é—­é˜²ç«å¢™ï¼š**
`systemctl stop firewalld`
**å®¢æˆ·ç«¯å…³é—­é˜²ç«å¢™ï¼š**
![bc33a501ad698755774fd46fab76f8ca.png](https://s1.imagehub.cc/images/2023/11/22/bc33a501ad698755774fd46fab76f8ca.png)
**æµ‹è¯•è¿é€šï¼š**
![2b421ebe1191df14297a60c9bc9a8e66.png](https://s1.imagehub.cc/images/2023/11/22/2b421ebe1191df14297a60c9bc9a8e66.png)
**1):ä½¿ç”¨å‘½ä»¤è¡Œè¿æ¥FTPï¼š**
`ftp 192.168.10.181`
è¾“å…¥åŒ¿åç”¨æˆ·å"ftp"ï¼Œå¯†ç ç©ºï¼Œç„¶åå°±èƒ½è¿ä¸Šå’¯
![3d69e68ca830cfee3734d493b06a3823.png](https://s1.imagehub.cc/images/2023/11/22/3d69e68ca830cfee3734d493b06a3823.png)
**2):ä½¿ç”¨å¯è§†åŒ–å®¢æˆ·ç«¯"FileZilla"æµ‹è¯•ï¼š**
"ä¸»æœº"å¡«å†™FTPæœåŠ¡å™¨åœ°å€
"ç”¨æˆ·å"å¡«å†™åŒ¿åç”¨æˆ·å"ftp"
"å¯†ç "ä¸ºç©º
"ç«¯å£"å¡«å†™"21"
![b35c450c30148998786d59b5c27c55f3.png](https://s1.imagehub.cc/images/2023/11/22/b35c450c30148998786d59b5c27c55f3.png)
![a9414077c4a1ac9f6914dd3659176778.png](https://s1.imagehub.cc/images/2023/11/22/a9414077c4a1ac9f6914dd3659176778.png)
**å‚è€ƒèµ„æ–™ï¼š**
[CSDN-FTPæœåŠ¡](https://blog.csdn.net/liuhuanboke/article/details/104940796 "CSDN-FTPæœåŠ¡")
[CSDN-åœ¨linuxä¸Šæ­å»ºftpæœåŠ¡å™¨åŠå…¶é…ç½®æ–‡ä»¶å¸¸ç”¨å‚æ•°è¯¦è§£](https://blog.csdn.net/weixin_42499593/article/details/86666176?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169942076816800182751667%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169942076816800182751667&biz_id=0&spm=1018.2226.3001.4187 "CSDN-åœ¨linuxä¸Šæ­å»ºftpæœåŠ¡å™¨åŠå…¶é…ç½®æ–‡ä»¶å¸¸ç”¨å‚æ•°è¯¦è§£")ğŸ‘
[CSDN-Linux-vsftpdé…ç½®æ–‡ä»¶è§£æ](https://blog.csdn.net/qq_39720594/article/details/115300454 "CSDN-Linux-vsftpdé…ç½®æ–‡ä»¶è§£æ")ğŸ‘
[CSDN-LInuxçš„FTPæœåŠ¡](https://blog.csdn.net/m0_57515995/article/details/125363237?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169941985416800188523346%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169941985416800188523346&biz_id=0&spm=1018.2226.3001.4187 "CSDN-LInuxçš„FTPæœåŠ¡")ğŸ‘ğŸ‘ğŸ‘
[CSDN-ã€Linuxã€‘FTPæ–‡ä»¶æœåŠ¡å™¨](https://blog.csdn.net/qq_45277554/article/details/131452806?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169941985416800188523346%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169941985416800188523346&biz_id=0&spm=1018.2226.3001.4187 "CSDN-ã€Linuxã€‘FTPæ–‡ä»¶æœåŠ¡å™¨")ğŸ‘ğŸ‘ğŸ‘
[åšå®¢å›­-linuxä¸­ftpé…ç½®æ–‡ä»¶è¯¦è§£](https://www.cnblogs.com/chenjianhong/p/4144303.html "åšå®¢å›­-linuxä¸­ftpé…ç½®æ–‡ä»¶è¯¦è§£")ğŸ‘ğŸ‘ğŸ‘
[åšå®¢å›­-linuxä¸‹ftpé…ç½®æ–‡ä»¶è¯¦è§£](https://www.cnblogs.com/cqlb/p/9511186.html "åšå®¢å›­-linuxä¸‹ftpé…ç½®æ–‡ä»¶è¯¦è§£")ğŸ‘ğŸ‘ğŸ‘

# <font color=red>ã€9ã€‘DHCPæœåŠ¡å™¨é…ç½®</font>

**1):ä»€ä¹ˆæ˜¯DHCPï¼š**
åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCPï¼ˆDynamic Host Configuration Protocolï¼‰æ˜¯ä¸€ç§ç½‘ç»œç®¡ç†åè®®ï¼Œç”¨äºé›†ä¸­å¯¹ç”¨æˆ·IPåœ°å€è¿›è¡ŒåŠ¨æ€ç®¡ç†å’Œé…ç½®ã€‚
DHCPäº1993å¹´10æœˆæˆä¸ºæ ‡å‡†åè®®ï¼Œå…¶å‰èº«æ˜¯BOOTPåè®®ã€‚DHCPåè®®ç”±RFC 2131å®šä¹‰ï¼Œé‡‡ç”¨å®¢æˆ·ç«¯/æœåŠ¡å™¨é€šä¿¡æ¨¡å¼ï¼Œç”±å®¢æˆ·ç«¯ï¼ˆDHCP Clientï¼‰å‘æœåŠ¡å™¨ï¼ˆDHCP Serverï¼‰æå‡ºé…ç½®ç”³è¯·ï¼ŒDHCP Serverä¸ºç½‘ç»œä¸Šçš„æ¯ä¸ªè®¾å¤‡åŠ¨æ€åˆ†é…IPåœ°å€ã€å­ç½‘æ©ç ã€é»˜è®¤ç½‘å…³åœ°å€ï¼ŒåŸŸåæœåŠ¡å™¨ï¼ˆDNSï¼‰åœ°å€å’Œå…¶ä»–ç›¸å…³é…ç½®å‚æ•°ï¼Œä»¥ä¾¿å¯ä»¥ä¸å…¶ä»–IPç½‘ç»œé€šä¿¡ã€‚
è¯¦è§ï¼š[HUAWEI-ä»€ä¹ˆæ˜¯DHCPï¼Ÿ](https://info.support.huawei.com/info-finder/encyclopedia/zh/DHCP.html "HUAWEI-ä»€ä¹ˆæ˜¯DHCPï¼Ÿ")ğŸ‘ğŸ‘ğŸ‘

**2:)ç¯å¢ƒä»‹ç»ï¼š**
ä½¿ç”¨VMware Workstation Pro 17 NATæ¨¡å¼é…ç½®
|åç§°|IP|æ‰®æ¼”è§’è‰²|ç³»ç»Ÿç‰ˆæœ¬|
|---|---|---|---|
|DHCP-Master|192.168.2.137|DHCPæœåŠ¡å™¨|Rocky-Boot-9.1|
|DHCP-Client|DHCPè·å–|DHCPå®¢æˆ·ç«¯|Rocky-Boot-9.1|
|Win~`?#^*/!@&*|DHCPè·å–|DHCPå®¢æˆ·ç«¯|Windows Server 2022 Standard|

## ã€1ã€‘å®‰è£…DHCP
å‘½ä»¤ï¼š`yum -y install dhcp*`
![67b88c1e88b80ef81d32eacdeac4d066.png](https://s1.imagehub.cc/images/2023/11/23/67b88c1e88b80ef81d32eacdeac4d066.png)

## ã€2ã€‘ç¼–å†™DHCPé…ç½®æ–‡ä»¶
**é…ç½®æ–‡ä»¶è·¯å¾„ï¼š**`/etc/dhcp/dhcpd.conf`
è¿™æ—¶å€™çš„é…ç½®æ–‡ä»¶å•¥ä¹Ÿæ²¡æœ‰ï¼Œä½†å®ƒä¼šä¸ºä½ æŒ‡å‘ä¸€ä¸ªDHCPé…ç½®æ–‡ä»¶æ¨¡æ¿è·¯å¾„
ç°åœ¨æˆ‘ä»¬å»å¤åˆ¶é…ç½®æ¨¡æ¿ï¼Œåœ¨æ¨¡æ¿çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹å†™å°±è¡Œ
![7e3969c608bb4f47957bc9a3c2e2f9b1.png](https://s1.imagehub.cc/images/2023/11/23/7e3969c608bb4f47957bc9a3c2e2f9b1.png)
**å¤åˆ¶DHCPé…ç½®æ–‡ä»¶æ¨¡æ¿ï¼š**`cp -p /usr/share/doc/dhcp-server/dhcpd.conf.example /etc/dhcp/dhcpd.conf`
è¾“å…¥"y"è¦†ç›–ç°æœ‰çš„DHCPé…ç½®æ–‡ä»¶
![cda7455a08ebeacf12bc85325e9e6db7.png](https://s1.imagehub.cc/images/2023/11/23/cda7455a08ebeacf12bc85325e9e6db7.png)
10.11è¡Œé»˜è®¤å³å¯
![0d9f299140ec7cdb55d770faf52e1851.png](https://s1.imagehub.cc/images/2023/11/23/0d9f299140ec7cdb55d770faf52e1851.png)
å–æ¶ˆæ³¨é‡Š14è¡Œ
![9ac65986fe128349ae40167ab9593eac.png](https://s1.imagehub.cc/images/2023/11/23/9ac65986fe128349ae40167ab9593eac.png)
é»˜è®¤å³å¯
![f2ad437842e94f9bf25a45d4f6e21d41.png](https://s1.imagehub.cc/images/2023/11/23/f2ad437842e94f9bf25a45d4f6e21d41.png)
å£°æ˜è¦åˆ†é…çš„ç½‘æ®µIPï¼Œä¸»æœºä½ä¸º0
å­ç½‘æ©ç æ”¹ä¸º3ä¸ª255
![285a51a812fd2451af8ccce88575880f.png](https://s1.imagehub.cc/images/2023/11/23/285a51a812fd2451af8ccce88575880f.png)
ç½‘æ®µIPå¡«å†™è‡ªå·±åŒç½‘æ®µï¼Œä¸»æœºä½å¡«0
å­ç½‘æ©ç é»˜è®¤3ä¸ª255å³å¯
åœ°å€èŒƒå›´æŒ‰éœ€åˆ’åˆ†(èµ·å§‹åœ°å€é—´æœ‰ç©ºæ ¼åˆ†éš”)
é»˜è®¤ç½‘å…³æŒ‰éœ€å¡«å†™
![1062e78faade8ea6cdb35f66bb804706.png](https://s1.imagehub.cc/images/2023/11/23/1062e78faade8ea6cdb35f66bb804706.png)
36è¡Œåçš„å†…å®¹éƒ½å¯ä»¥åˆ æ‰äº†
![cb293a7ec8d57fc3d08245961c9afdef.png](https://s1.imagehub.cc/images/2023/11/23/cb293a7ec8d57fc3d08245961c9afdef.png)

## ã€3ã€‘éªŒæ”¶ç¯èŠ‚
**1.é‡å¯DHCPæœåŠ¡ï¼š**
`systemctl restart dhcpd`
**2.å°†DHCPæœåŠ¡åŠ å…¥å¼€æœºè‡ªå¯ï¼š**
`systemctl enable dhcpd`
**3.å…³é—­é˜²ç«å¢™ï¼š**
`systemctl stop firewalld`
**4.å…³é—­é˜²ç«å¢™å¼€æœºè‡ªå¯ï¼š**
`systemctl disable firewalld`
**5.ä¸´æ—¶å…³é—­SELinux(é‡å¯åå¤±æ•ˆ)ï¼š**
`setenforce 0`
**6.æŸ¥çœ‹DHCPè¿è¡ŒçŠ¶æ€ï¼š**
`systemctl status dhcpd`
![bb60bc3d428c83452b457497fb154312.png](https://s1.imagehub.cc/images/2023/11/23/bb60bc3d428c83452b457497fb154312.png)
**7.å–æ¶ˆVMware NAT DHCPæœåŠ¡ï¼š**
å¦‚æœä¸å–æ¶ˆï¼Œå®¢æˆ·ç«¯å°±ä¼šå»è·å–VMwareçš„DHCPï¼Œè€Œä¸æ˜¯å»è·å–æˆ‘ä»¬çš„DHCPæœåŠ¡
![1b5093a0697a1d66ffaea89cb1875b41.png](https://s1.imagehub.cc/images/2023/11/23/1b5093a0697a1d66ffaea89cb1875b41.png)
**8.å®¢æˆ·ç«¯IPè®¾ç½®ä¸ºè‡ªåŠ¨è·å–ï¼š**
![997b31c2cce6a35ea25a7951b9e02523.png](https://s1.imagehub.cc/images/2023/11/24/997b31c2cce6a35ea25a7951b9e02523.png)
**DHCP-ClientæˆåŠŸè‡ªåŠ¨è·å–IPï¼š**
IPä¹Ÿæ˜¯æˆ‘ä»¬åˆ’åˆ†çš„DHCPèŒƒå›´å†…çš„IPåœ°å€
![9971a29817eaaca7a6f059d73a4a0b41.png](https://s1.imagehub.cc/images/2023/11/23/9971a29817eaaca7a6f059d73a4a0b41.png)
**9.ç½‘å¡è®¾ç½®ä¸ºè‡ªåŠ¨è·å–ï¼š**
![7f6afb5105dc6174bf4113dafe68689a.png](https://s1.imagehub.cc/images/2023/11/24/7f6afb5105dc6174bf4113dafe68689a.png)
**Win~`?#^*/!@&*æˆåŠŸè‡ªåŠ¨è·å–IPï¼š**
![0a92b2e468b237e7ecf1904c4aa56bdb.png](https://s1.imagehub.cc/images/2023/11/23/0a92b2e468b237e7ecf1904c4aa56bdb.png)

**DHCPé…ç½®æ–‡ä»¶ä¸€é”®CVï¼š**
~~CVå·¥ç¨‹å¸ˆç‹‚å–œ~~
```
option domain-name "example.org";
option domain-name-servers ns1.example.org, ns2.example.org;
default-lease-time 600;
max-lease-time 7200;
ddns-update-style none;
log-facility local7;
subnet 192.168.2.0 netmask 255.255.255.0 {
}
subnet 192.168.2.0 netmask 255.255.255.0 {
  range 192.168.2.230 192.168.2.240;
  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;
}
```

èµ„æ–™å‚è€ƒï¼š
[CSDN-DHCPé…ç½®æ–¹å¼ dhcpd.confé…ç½®æ–‡ä»¶](https://blog.csdn.net/hotshortgg/article/details/113903837 "CSDN-DHCPé…ç½®æ–¹å¼ dhcpd.confé…ç½®æ–‡ä»¶")ğŸ‘ğŸ‘ğŸ‘
[CSDN-Linuxå®‰è£…é…ç½®DHCP](https://blog.csdn.net/renfeigui0/article/details/100130108 "CSDN-Linuxå®‰è£…é…ç½®DHCP")ğŸ‘ğŸ‘
[CSDN-Linuxç¯å¢ƒä¸‹é…ç½®DHCPæœåŠ¡å™¨](https://blog.csdn.net/mldl_/article/details/118282062 "CSDN-Linuxç¯å¢ƒä¸‹é…ç½®DHCPæœåŠ¡å™¨")ğŸ‘ğŸ‘
[åšå®¢å›­-linuxä¸­DHCPæœåŠ¡é…ç½®æ–‡ä»¶/etc/dhcpd.confè¯¦ç»†è¯´æ˜](https://www.cnblogs.com/wajika/p/6535175.html "åšå®¢å›­-linuxä¸­DHCPæœåŠ¡é…ç½®æ–‡ä»¶/etc/dhcpd.confè¯¦ç»†è¯´æ˜")ğŸ‘ğŸ‘ğŸ‘

# <font color=red>ã€10ã€‘SabmaæœåŠ¡å™¨é…ç½®</font>ğŸ‘€
**1): Sambaç®€ä»‹ï¼š**
Sambaæ˜¯åŸºäºSMBåè®®ï¼ˆServer Message Block ä¿¡æ¯æœåŠ¡å—ï¼‰çš„å¼€æºè½¯ä»¶ã€‚ä¸€ç§Linuxã€UNIXç³»ç»Ÿä¸Šå¯ç”¨äºå…±äº«æ–‡ä»¶å’Œæ‰“å°æœºç­‰èµ„æºçš„åè®®ï¼Œè¿™ç§åè®®åŸºäºClient/Serverå‹åè®®
SambaæœåŠ¡ç›®å½•ä¸»è¦æ˜¯ç”¨äºLinuxç³»ç»Ÿå’ŒWindowsç³»ç»Ÿä¹‹é—´å…±äº«æ–‡ä»¶çš„æœ€ä½³é€‰æ‹©

**2): ç¯å¢ƒä»‹ç»**
|åç§°|IP|æ‰®æ¼”è§’è‰²|ç³»ç»Ÿç‰ˆæœ¬|
|---|---|---|---|
|SMB-Server|192.168.10.181|SMBæœåŠ¡å™¨|Rocky_Boot_9.1|
|SMB-Client1|192.168.10.161|SMBå®¢æˆ·ç«¯|Windows Server 2022 Standard|
|SMB-Client1|192.168.10.183|SMBå®¢æˆ·ç«¯|Ubuntu 22.04.3 Desktop|
## ã€1ã€‘å®‰è£…Samaba
å‘½ä»¤ï¼š`dnf -y install samba`
![2ff2ff045bb45f00d9fa7ba41bc51f54.png](https://s1.imagehub.cc/images/2023/11/30/2ff2ff045bb45f00d9fa7ba41bc51f54.png)

## ã€2ã€‘åˆ›å»ºç”¨æˆ·
åˆ›å»ºä¸€ä¸ªç³»ç»Ÿç”¨æˆ·ï¼Œä¸ºåç»­æ·»åŠ sambaç”¨æˆ·å‡†å¤‡ï¼š`adduser username`
åˆ›å»ºå®Œæ¯•åä¸ºå…¶åˆ›å»ºç”¨æˆ·å¯†ç ï¼š`passwd username`
![d5fcf8cab86b79ed844a7506140f03ef.png](https://s1.imagehub.cc/images/2023/11/30/d5fcf8cab86b79ed844a7506140f03ef.png)

## ã€3ã€‘åˆ›å»ºå…±äº«æ–‡ä»¶å¤¹
å‘½ä»¤ï¼š`mkdir name`
ç„¶ååœ¨æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå†å¾€é‡Œè¾¹éšä¾¿å†™ç‚¹å†…å®¹
`touch filename`
![ab3fdb8d9bdc6524dec09eed21134ab9.png](https://s1.imagehub.cc/images/2023/11/30/ab3fdb8d9bdc6524dec09eed21134ab9.png)
## ã€4ã€‘SMBé…ç½®æ–‡ä»¶è¯¦è§£âœ”ï¸
### ã€1ã€‘å…¨å±€å‚æ•°
==================Global Settings ===================
[global]
1. `config file = /usr/local/samba/lib/smb.conf.%m`
config fileå¯ä»¥è®©ä½ ä½¿ç”¨å¦ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥è¦†ç›–ç¼ºçœçš„é…ç½®æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™è¯¥é¡¹æ— æ•ˆã€‚è¿™ä¸ªå‚æ•°å¾ˆæœ‰ç”¨ï¼Œå¯ä»¥ä½¿å¾—sambaé…ç½®æ›´çµæ´»ï¼Œå¯ä»¥è®©ä¸€å°sambaæœåŠ¡å™¨æ¨¡æ‹Ÿå¤šå°ä¸åŒé…ç½®çš„æœåŠ¡å™¨ã€‚æ¯”å¦‚ï¼Œä½ æƒ³è®©PC1ï¼ˆä¸»æœºåï¼‰è¿™å°ç”µè„‘åœ¨è®¿é—®SambaServeræ—¶ä½¿ç”¨å®ƒè‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆå…ˆåœ¨/etc/samba/host/ä¸‹ä¸ºPC1é…ç½®ä¸€ä¸ªåä¸ºsmb.conf.pc1çš„æ–‡ä»¶ï¼Œç„¶ååœ¨smb.confä¸­åŠ å…¥ï¼šconfig file = /etc/samba/host/smb.conf.%mã€‚è¿™æ ·å½“PC1è¯·æ±‚è¿æ¥Samba Serveræ—¶ï¼Œsmb.conf.%må°±è¢«æ›¿æ¢æˆsmb.conf.pc1ã€‚è¿™æ ·ï¼Œå¯¹äºPC1æ¥è¯´ï¼Œå®ƒæ‰€ä½¿ç”¨çš„SambaæœåŠ¡å°±æ˜¯ç”±smb.conf.pc1å®šä¹‰çš„ï¼Œè€Œå…¶ä»–æœºå™¨è®¿é—®Samba Serveråˆ™è¿˜æ˜¯åº”ç”¨smb.conf
2. `workgroup = WORKGROUP`
è®¾å®šSamba Server æ‰€è¦åŠ å…¥çš„å·¥ä½œç»„æˆ–è€…åŸŸ
3. `server string = Samba Server Version %v`
è®¾å®šSamba Serverçš„æ³¨é‡Šï¼Œå¯ä»¥æ˜¯ä»»ä½•å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä¸å¡«ã€‚å®%vè¡¨ç¤ºæ˜¾ç¤ºSambaçš„ç‰ˆæœ¬å·
4. `netbios name = smbserver`
è®¾ç½®Samba Serverçš„NetBIOSåç§°ã€‚å¦‚æœä¸å¡«ï¼Œåˆ™é»˜è®¤ä¼šä½¿ç”¨è¯¥æœåŠ¡å™¨çš„DNSåç§°çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚netbios nameå’Œworkgroupåå­—ä¸è¦è®¾ç½®æˆä¸€æ ·äº†
5. `interfaces = lo eth0 192.168.80.2/24 192.168.81.2/24`
è®¾ç½®Samba Serverç›‘å¬å“ªäº›ç½‘å¡ï¼Œå¯ä»¥å†™ç½‘å¡åï¼Œä¹Ÿå¯ä»¥å†™è¯¥ç½‘å¡çš„IPåœ°å€
6. `hosts allow = 127. 192.168.82. 192.168.80.130`
è¡¨ç¤ºå…è®¸è¿æ¥åˆ°samba server çš„å®¢æˆ·ç«¯ï¼Œå¤šä¸ªå‚æ•°ä»¥ç©ºæ ¼éš”å¼€ã€‚å¯ä»¥ç”¨ä¸€ä¸ªIPè¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªç½‘æ®µè¡¨ç¤º
hosts allowå’Œhosts denyåˆšå¥½ç›¸åï¼ˆ2é€‰1ï¼‰
ä¾‹ï¼š
hosts allow=192.168.80. EXCEPT192.168.80.130
è¡¨ç¤ºå…è®¸æ¥è‡ª192.168.80.* çš„ä¸»æœºè¿æ¥ï¼Œä½†æ’é™¤192.168.80.130
hosts allow=192.168.80.0/24
è¡¨ç¤ºå…è®¸æ¥è‡ª192.168.80.0/24å­ç½‘ä¸­çš„æ‰€æœ‰ä¸»æœºè¿æ¥
7. `hosts allow=M1ï¼ŒM2`
è¡¨ç¤ºå®¹è®¸æ¥è‡ªM1å’ŒM2ä¸¤å°è®¡ç®—æœºè¿æ¥
8. `hosts allow=@xq`
è¡¨ç¤ºå®¹è®¸æ¥è‡ªXQç½‘åŸŸçš„æ‰€æœ‰è®¡ç®—æœºè¿æ¥
9. `max connections = 0`
max connectionsç”¨æ¥æŒ‡å®šè¿æ¥Samba Serverçš„æœ€å¤§è¿æ¥æ•°ç›®ã€‚å¦‚æœè¶…å‡ºè¿æ¥æ•°ç›®ï¼Œåˆ™æ–°çš„è¿æ¥è¯·æ±‚å°†è¢«æ‹’ç»ã€‚0è¡¨ç¤ºä¸é™åˆ¶
10.  `deadtime = 0`
deadtimeç”¨æ¥è®¾ç½®æ–­æ‰ä¸€ä¸ªæ²¡æœ‰æ‰“å¼€ä»»ä½•æ–‡ä»¶çš„è¿æ¥çš„æ—¶é—´ã€‚å•ä½æ˜¯åˆ†é’Ÿï¼Œ0ä»£è¡¨Samba Serverä¸è‡ªåŠ¨åˆ‡æ–­ä»»ä½•è¿æ¥
11.  `time server = yes/no`
time serverç”¨æ¥è®¾ç½®è®©nmdbæˆä¸ºwindowså®¢æˆ·ç«¯çš„æ—¶é—´æœåŠ¡å™¨
12.  `log file = /var/log/samba/log.%m`
è®¾ç½®Samba Serveræ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨ä½ç½®ä»¥åŠæ—¥å¿—æ–‡ä»¶åç§°ã€‚åœ¨æ–‡ä»¶åååŠ ä¸ªå®%mï¼ˆä¸»æœºåï¼‰ï¼Œè¡¨ç¤ºå¯¹æ¯å°è®¿é—®Samba Serverçš„æœºå™¨éƒ½å•ç‹¬è®°å½•ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚å¦‚æœpc1ã€pc2è®¿é—®è¿‡Samba Serverï¼Œå°±ä¼šåœ¨/var/log/sambaç›®å½•ä¸‹ç•™ä¸‹log.pc1å’Œlog.pc2ä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶
13.  `max log size =50`
è®¾ç½®Samba Serveræ—¥å¿—æ–‡ä»¶çš„æœ€å¤§å®¹é‡ï¼Œå•ä½ä¸ºkBï¼Œ0ä»£è¡¨ä¸é™åˆ¶ã€‚
14.  `security = user`
    è®¾ç½®ç”¨æˆ·è®¿é—®Samba Serverçš„éªŒè¯æ–¹å¼ï¼Œä¸€å…±æœ‰å››ç§éªŒè¯æ–¹å¼ï¼š
    1)ï¼šshareï¼šç”¨æˆ·è®¿é—®Samba Serverä¸éœ€è¦æä¾›ç”¨æˆ·åå’Œå£ä»¤, å®‰å…¨æ€§èƒ½è¾ƒä½ã€‚
    2)ï¼šuserï¼šSamba Serverå…±äº«ç›®å½•åªèƒ½è¢«æˆæƒçš„ç”¨æˆ·è®¿é—®,ç”±Samba Serverè´Ÿè´£æ£€æŸ¥è´¦å·å’Œå¯†ç çš„æ­£ç¡®æ€§ã€‚è´¦å·å’Œå¯†ç è¦åœ¨æœ¬Samba Serverä¸­å»ºç«‹ã€‚
    3)ï¼šserverï¼šä¾é å…¶ä»–Windows NT/2000æˆ–Samba Serveræ¥éªŒè¯ç”¨æˆ·çš„è´¦å·å’Œå¯†ç ,æ˜¯ä¸€ç§ä»£ç†éªŒè¯ã€‚æ­¤ç§å®‰å…¨æ¨¡å¼ä¸‹,ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æŠŠæ‰€æœ‰çš„Windowsç”¨æˆ·å’Œå£ä»¤é›†ä¸­åˆ°ä¸€ä¸ªNTç³»ç»Ÿä¸Š,ä½¿ç”¨Windows NTè¿›è¡ŒSambaè®¤è¯, è¿œç¨‹æœåŠ¡å™¨å¯ä»¥è‡ªåŠ¨è®¤è¯å…¨éƒ¨ç”¨æˆ·å’Œå£ä»¤,å¦‚æœè®¤è¯å¤±è´¥,Sambaå°†ä½¿ç”¨ç”¨æˆ·çº§å®‰å…¨æ¨¡å¼ä½œä¸ºæ›¿ä»£çš„æ–¹å¼ã€‚
    4)ï¼šdomainï¼šåŸŸå®‰å…¨çº§åˆ«,ä½¿ç”¨ä¸»åŸŸæ§åˆ¶å™¨(PDC)æ¥å®Œæˆè®¤è¯ã€‚
15.  `passdb backend = tdbsam`
    passdb backendå°±æ˜¯ç”¨æˆ·åå°çš„æ„æ€ã€‚ç›®å‰æœ‰ä¸‰ç§åå°ï¼šsmbpasswdã€tdbsamå’Œldapsamã€‚samåº”è¯¥æ˜¯security account managerï¼ˆå®‰å…¨è´¦æˆ·ç®¡ç†ï¼‰çš„ç®€å†™
    1)ï¼šsmbpasswdï¼šè¯¥æ–¹å¼æ˜¯ä½¿ç”¨smbè‡ªå·±çš„å·¥å…·smbpasswdæ¥ç»™ç³»ç»Ÿç”¨æˆ·ï¼ˆçœŸå®ç”¨æˆ·æˆ–è€…è™šæ‹Ÿç”¨æˆ·ï¼‰è®¾ç½®ä¸€ä¸ªSambaå¯†ç ï¼Œå®¢æˆ·ç«¯å°±ç”¨è¿™ä¸ªå¯†ç æ¥è®¿é—®Sambaçš„èµ„æºã€‚smbpasswdæ–‡ä»¶é»˜è®¤åœ¨/etc/sambaç›®å½•ä¸‹ï¼Œä¸è¿‡æœ‰æ—¶å€™è¦æ‰‹å·¥å»ºç«‹è¯¥æ–‡ä»¶ã€‚
    2)ï¼štdbsamï¼šè¯¥æ–¹å¼åˆ™æ˜¯ä½¿ç”¨ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶æ¥å»ºç«‹ç”¨æˆ·æ•°æ®åº“ã€‚æ•°æ®åº“æ–‡ä»¶å«passdb.tdbï¼Œé»˜è®¤åœ¨/etc/sambaç›®å½•ä¸‹ã€‚passdb.tdbç”¨æˆ·æ•°æ®åº“å¯ä»¥ä½¿ç”¨smbpasswd â€“aæ¥å»ºç«‹Sambaç”¨æˆ·ï¼Œä¸è¿‡è¦å»ºç«‹çš„Sambaç”¨æˆ·å¿…é¡»å…ˆæ˜¯ç³»ç»Ÿç”¨æˆ·ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨pdbeditå‘½ä»¤æ¥å»ºç«‹Sambaè´¦æˆ·
16.  `encrypt passwords = yes/no`
æ˜¯å¦å°†è®¤è¯å¯†ç åŠ å¯†ã€‚å› ä¸ºç°åœ¨windowsæ“ä½œç³»ç»Ÿéƒ½æ˜¯ä½¿ç”¨åŠ å¯†å¯†ç ï¼Œæ‰€ä»¥ä¸€èˆ¬è¦å¼€å¯æ­¤é¡¹ã€‚ä¸è¿‡é…ç½®æ–‡ä»¶é»˜è®¤å·²å¼€å¯
17.  `smb passwd file = /etc/samba/smbpasswd`
ç”¨æ¥å®šä¹‰sambaç”¨æˆ·çš„å¯†ç æ–‡ä»¶ã€‚smbpasswdæ–‡ä»¶å¦‚æœæ²¡æœ‰é‚£å°±è¦æ‰‹å·¥æ–°å»º
18.  `username map = /etc/samba/smbusers`
ç”¨æ¥å®šä¹‰ç”¨æˆ·åæ˜ å°„ï¼Œæ¯”å¦‚å¯ä»¥å°†rootæ¢æˆadministratorã€adminç­‰ã€‚ä¸è¿‡è¦äº‹å…ˆåœ¨smbusersæ–‡ä»¶ä¸­å®šä¹‰å¥½ã€‚æ¯”å¦‚ï¼šroot = administrator adminï¼Œè¿™æ ·å°±å¯ä»¥ç”¨administratoræˆ–adminè¿™ä¸¤ä¸ªç”¨æˆ·æ¥ä»£æ›¿rootç™»é™†Samba Serverï¼Œæ›´è´´è¿‘windowsç”¨æˆ·çš„ä¹ æƒ¯
19.  `guest account = nobody`
ç”¨æ¥è®¾ç½®guestç”¨æˆ·å
20.  `socket options = TCP_NODELAY SO_RCVBUF=8192 SO_SNDBUF=8192`
ç”¨æ¥è®¾ç½®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´ä¼šè¯çš„Socketé€‰é¡¹ï¼Œå¯ä»¥ä¼˜åŒ–ä¼ è¾“é€Ÿåº¦
21.  `domain master = yes/no`
è®¾ç½®SambaæœåŠ¡å™¨æ˜¯å¦è¦æˆä¸ºç½‘åŸŸä¸»æµè§ˆå™¨ï¼Œç½‘åŸŸä¸»æµè§ˆå™¨å¯ä»¥ç®¡ç†è·¨å­ç½‘åŸŸçš„æµè§ˆæœåŠ¡
22.  `local master = yes/no`
local masterç”¨æ¥æŒ‡å®šSamba Serveræ˜¯å¦è¯•å›¾æˆä¸ºæœ¬åœ°ç½‘åŸŸä¸»æµè§ˆå™¨ã€‚å¦‚æœè®¾ä¸ºnoï¼Œåˆ™æ°¸è¿œä¸ä¼šæˆä¸ºæœ¬åœ°ç½‘åŸŸä¸»æµè§ˆå™¨ã€‚ä½†æ˜¯å³ä½¿è®¾ç½®ä¸ºyesï¼Œä¹Ÿä¸ç­‰äºè¯¥Samba Serverå°±èƒ½æˆä¸ºä¸»æµè§ˆå™¨ï¼Œè¿˜éœ€è¦å‚åŠ é€‰ä¸¾
23.  `preferred master = yes/no`
è®¾ç½®Samba Serverä¸€å¼€æœºå°±å¼ºè¿«è¿›è¡Œä¸»æµè§ˆå™¨é€‰ä¸¾ï¼Œå¯ä»¥æé«˜Samba Serveræˆä¸ºæœ¬åœ°ç½‘åŸŸä¸»æµè§ˆå™¨çš„æœºä¼šã€‚å¦‚æœè¯¥å‚æ•°æŒ‡å®šä¸ºyesæ—¶ï¼Œæœ€å¥½æŠŠdomain masterä¹ŸæŒ‡å®šä¸ºyesã€‚ä½¿ç”¨è¯¥å‚æ•°æ—¶è¦æ³¨æ„ï¼šå¦‚æœåœ¨æœ¬Samba Serveræ‰€åœ¨çš„å­ç½‘æœ‰å…¶ä»–çš„æœºå™¨ï¼ˆä¸è®ºæ˜¯windows NTè¿˜æ˜¯å…¶ä»–Samba Serverï¼‰ä¹ŸæŒ‡å®šä¸ºé¦–è¦ä¸»æµè§ˆå™¨æ—¶ï¼Œé‚£ä¹ˆè¿™äº›æœºå™¨å°†ä¼šå› ä¸ºäº‰å¤ºä¸»æµè§ˆå™¨è€Œåœ¨ç½‘ç»œä¸Šå¤§å‘å¹¿æ’­ï¼Œå½±å“ç½‘ç»œæ€§èƒ½ã€‚å¦‚æœåŒä¸€ä¸ªåŒºåŸŸå†…æœ‰å¤šå°Samba Serverï¼Œå°†ä¸Šé¢ä¸‰ä¸ªå‚æ•°è®¾å®šåœ¨ä¸€å°å³å¯
24.  `os level = 200`
è®¾ç½®sambaæœåŠ¡å™¨çš„os levelã€‚è¯¥å‚æ•°å†³å®šSamba Serveræ˜¯å¦æœ‰æœºä¼šæˆä¸ºæœ¬åœ°ç½‘åŸŸçš„ä¸»æµè§ˆå™¨ã€‚os levelä»0åˆ°255ï¼ŒwinNTçš„os levelæ˜¯32ï¼Œwin95/98çš„os levelæ˜¯1ã€‚Windows 2000çš„os levelæ˜¯64ã€‚å¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™æ„å‘³ç€Samba Serverå°†å¤±å»æµè§ˆé€‰æ‹©ã€‚å¦‚æœæƒ³è®©Samba Serveræˆä¸ºPDCï¼Œé‚£ä¹ˆå°†å®ƒçš„os levelå€¼è®¾å¤§äº›
25.  `domain logons = yes/no`
è®¾ç½®Samba Serveræ˜¯å¦è¦åšä¸ºæœ¬åœ°åŸŸæ§åˆ¶å™¨ã€‚ä¸»åŸŸæ§åˆ¶å™¨å’Œå¤‡ä»½åŸŸæ§åˆ¶å™¨éƒ½éœ€è¦å¼€å¯æ­¤é¡¹
26.  `logon . = %u.bat`
å½“ä½¿ç”¨è€…ç”¨windowså®¢æˆ·ç«¯ç™»é™†ï¼Œé‚£ä¹ˆSambaå°†æä¾›ä¸€ä¸ªç™»é™†æ¡£ã€‚å¦‚æœè®¾ç½®æˆ%u.batï¼Œé‚£ä¹ˆå°±è¦ä¸ºæ¯ä¸ªç”¨æˆ·æä¾›ä¸€ä¸ªç™»é™†æ¡£ã€‚å¦‚æœäººæ¯”è¾ƒå¤šï¼Œé‚£å°±æ¯”è¾ƒéº»çƒ¦ã€‚å¯ä»¥è®¾ç½®æˆä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶åï¼Œæ¯”å¦‚start.batï¼Œé‚£ä¹ˆç”¨æˆ·ç™»é™†åéƒ½ä¼šå»æ‰§è¡Œstart.batï¼Œè€Œä¸ç”¨ä¸ºæ¯ä¸ªç”¨æˆ·è®¾å®šä¸€ä¸ªç™»é™†æ¡£äº†ã€‚è¿™ä¸ªæ–‡ä»¶è¦æ”¾ç½®åœ¨[netlogon]çš„pathè®¾ç½®çš„ç›®å½•è·¯å¾„ä¸‹
27.  `wins support = yes/no`
è®¾ç½®sambaæœåŠ¡å™¨æ˜¯å¦æä¾›winsæœåŠ¡
28.  `wins server= winsæœåŠ¡å™¨IPåœ°å€`
è®¾ç½®Samba Serveræ˜¯å¦ä½¿ç”¨åˆ«çš„winsæœåŠ¡å™¨æä¾›winsæœåŠ¡
29.  `wins proxy = yes/no`
è®¾ç½®Samba Serveræ˜¯å¦å¼€å¯winsä»£ç†æœåŠ¡
30.  `dns proxy = yes/no`
è®¾ç½®Samba Serveræ˜¯å¦å¼€å¯dnsä»£ç†æœåŠ¡
31.  `load printers = yes/no`
è®¾ç½®æ˜¯å¦åœ¨å¯åŠ¨Sambaæ—¶å°±å…±äº«æ‰“å°æœº
32.  `printcap name = cups`
è®¾ç½®å…±äº«æ‰“å°æœºçš„é…ç½®æ–‡ä»¶
33.  `printing = cups`
è®¾ç½®Sambaå…±äº«æ‰“å°æœºçš„ç±»å‹ã€‚ç°åœ¨æ”¯æŒçš„æ‰“å°ç³»ç»Ÿæœ‰ï¼šbsd, sysv, plp, lprng, aix, hpux, qnx

### ã€2ã€‘å…±äº«å‚æ•°
================== Share Definitions ==================
[å…±äº«å]
1. `comment = ä»»æ„å­—ç¬¦ä¸²`
commentæ˜¯å¯¹è¯¥å…±äº«çš„æè¿°ï¼Œå¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²
2. `path = å…±äº«ç›®å½•è·¯å¾„`
pathç”¨æ¥æŒ‡å®šå…±äº«ç›®å½•çš„è·¯å¾„ã€‚å¯ä»¥ç”¨%uã€%mè¿™æ ·çš„å®æ¥ä»£æ›¿è·¯å¾„é‡Œçš„unixç”¨æˆ·å’Œå®¢æˆ·æœºçš„Netbiosåï¼Œç”¨å®è¡¨ç¤ºä¸»è¦ç”¨äº[homes]å…±äº«åŸŸã€‚ä¾‹å¦‚ï¼šå¦‚æœæˆ‘ä»¬ä¸æ‰“ç®—ç”¨homeæ®µåšä¸ºå®¢æˆ·çš„å…±äº«ï¼Œè€Œæ˜¯åœ¨/home/share/ä¸‹ä¸ºæ¯ä¸ªLinuxç”¨æˆ·ä»¥ä»–çš„ç”¨æˆ·åå»ºä¸ªç›®å½•ï¼Œä½œä¸ºä»–çš„å…±äº«ç›®å½•ï¼Œè¿™æ ·pathå°±å¯ä»¥å†™æˆï¼špath = /home/share/%u; ã€‚ç”¨æˆ·åœ¨è¿æ¥åˆ°è¿™å…±äº«æ—¶å…·ä½“çš„è·¯å¾„ä¼šè¢«ä»–çš„ç”¨æˆ·åä»£æ›¿ï¼Œè¦æ³¨æ„è¿™ä¸ªç”¨æˆ·åè·¯å¾„ä¸€å®šè¦å­˜åœ¨ï¼Œå¦åˆ™ï¼Œå®¢æˆ·æœºåœ¨è®¿é—®æ—¶ä¼šæ‰¾ä¸åˆ°ç½‘ç»œè·¯å¾„ã€‚åŒæ ·ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ˜¯ä»¥ç”¨æˆ·æ¥åˆ’åˆ†ç›®å½•ï¼Œè€Œæ˜¯ä»¥å®¢æˆ·æœºæ¥åˆ’åˆ†ç›®å½•ï¼Œä¸ºç½‘ç»œä¸Šæ¯å°å¯ä»¥è®¿é—®sambaçš„æœºå™¨éƒ½å„è‡ªå»ºä¸ªä»¥å®ƒçš„netbiosåçš„è·¯å¾„ï¼Œä½œä¸ºä¸åŒæœºå™¨çš„å…±äº«èµ„æºï¼Œå°±å¯ä»¥è¿™æ ·å†™ï¼špath = /home/share/%m
3. `browseable = yes/no`
browseableç”¨æ¥æŒ‡å®šè¯¥å…±äº«æ˜¯å¦å¯ä»¥æµè§ˆ
4. `writable = yes/no`
writableç”¨æ¥æŒ‡å®šè¯¥å…±äº«è·¯å¾„æ˜¯å¦å¯å†™
5. `available = yes/no`
availableç”¨æ¥æŒ‡å®šè¯¥å…±äº«èµ„æºæ˜¯å¦å¯ç”¨
6. `admin users = è¯¥å…±äº«çš„ç®¡ç†è€…`
admin usersç”¨æ¥æŒ‡å®šè¯¥å…±äº«çš„ç®¡ç†å‘˜ï¼ˆå¯¹è¯¥å…±äº«å…·æœ‰å®Œå…¨æ§åˆ¶æƒé™ï¼‰ã€‚åœ¨samba 3.0ä¸­ï¼Œå¦‚æœç”¨æˆ·éªŒè¯æ–¹å¼è®¾ç½®æˆâ€œsecurity=shareâ€æ—¶ï¼Œæ­¤é¡¹æ— æ•ˆ
ä¾‹å¦‚ï¼šadmin users =bobyuanï¼Œjaneï¼ˆå¤šä¸ªç”¨æˆ·ä¸­é—´ç”¨é€—å·éš”å¼€ï¼‰
7. `valid users = å…è®¸è®¿é—®è¯¥å…±äº«çš„ç”¨æˆ·`
valid usersç”¨æ¥æŒ‡å®šå…è®¸è®¿é—®è¯¥å…±äº«èµ„æºçš„ç”¨æˆ·
ä¾‹å¦‚ï¼švalid users =bobyuanï¼Œ@bobï¼Œ@techï¼ˆå¤šä¸ªç”¨æˆ·æˆ–è€…ç»„ä¸­é—´ç”¨é€—å·éš”å¼€ï¼Œå¦‚æœè¦åŠ å…¥ä¸€ä¸ªç»„å°±ç”¨â€œ@+ç»„åâ€è¡¨ç¤º
8. `invalid users = ç¦æ­¢è®¿é—®è¯¥å…±äº«çš„ç”¨æˆ·`
9. invalid usersç”¨æ¥æŒ‡å®šä¸å…è®¸è®¿é—®è¯¥å…±äº«èµ„æºçš„ç”¨æˆ·
ä¾‹å¦‚ï¼šinvalid users = rootï¼Œ@bobï¼ˆå¤šä¸ªç”¨æˆ·æˆ–è€…ç»„ä¸­é—´ç”¨é€—å·éš”å¼€
10. `write list = å…è®¸å†™å…¥è¯¥å…±äº«çš„ç”¨æˆ·`
write listç”¨æ¥æŒ‡å®šå¯ä»¥åœ¨è¯¥å…±äº«ä¸‹å†™å…¥æ–‡ä»¶çš„ç”¨æˆ·
ä¾‹å¦‚ï¼šwrite list = bobyuanï¼Œ@bob
11. `public = yes/no`
publicç”¨æ¥æŒ‡å®šè¯¥å…±äº«æ˜¯å¦å…è®¸guestè´¦æˆ·è®¿é—®
12. `guest ok = yes/no`
æ„ä¹‰åŒ"public"

### ã€3ã€‘ç‰¹æ®Šå…±äº«
```
[homes]
comment = Home Directories
browseable = no
writable = yes
valid users = %S
valid users = MYDOMAIN\%S

[printers]
comment = All Printers
path = /var/spool/sam
babrowseable = no
guest ok = no
writable = no
printable = yes

[netlogon]
comment = Network Logon Service
path = /var/lib/samba/netlogon
guest ok = yes
writable = no
share modes = no

[Profiles]
path = /var/lib/samba/profiles
browseable = no
guest ok = yes
```

## ã€5ã€‘ç¼–å†™Sambaé…ç½®æ–‡ä»¶âœï¸
**å¤‡ä»½é…ç½®æ–‡ä»¶ï¼š**
`cp -p /etc/samba/smb.conf smb.conf.bak`
å‘½ä»¤ï¼š`vi /etc/samba/smb.conf`
ç„¶ååœ¨é…ç½®æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
```
[test1]
       comment = '114514'
       path=/smbshare
       public=no
       writable = yes
       guest ok = yes
```
![01038d6826e2693c3a55b2363a0b8792.png](https://s1.imagehub.cc/images/2023/11/30/01038d6826e2693c3a55b2363a0b8792.png)

## ã€6ã€‘éªŒæ”¶ç¯èŠ‚
**1. é‡å¯SMBï¼š**
`systemctl restart smb`
**2. å…³é—­é˜²ç«å¢™ï¼š**
`systemctl stop firewalld`
**3. å…³é—­SELinuxï¼š**
`setenforce 0`

Windowså®¢æˆ·ç«¯æµ‹è¯•è¿é€šæ€§ï¼š
![a6414d4fbffaca60ea95ecd0ec987937.png](https://s1.imagehub.cc/images/2023/11/30/a6414d4fbffaca60ea95ecd0ec987937.png)
è¿™æ—¶å€™å»è®¿é—®ä¼šæ˜¾ç¤º"æ— æ³•è®¿é—®"
![60ce4d2140259e711648e3b41f4513e4.png](https://s1.imagehub.cc/images/2023/11/30/60ce4d2140259e711648e3b41f4513e4.png)
è¿™æ˜¯å› ä¸ºè¿˜æ²¡æœ‰å‘sambaä¸­æ·»åŠ æœ¬åœ°ç”¨æˆ·
ç„¶åå†è¾“å…¥ä¸¤æ¬¡å¯†ç å³å¯
`smbpasswd -a username`
![7289dc9bd598952192fad9c1e3ee5771.png](https://s1.imagehub.cc/images/2023/11/30/7289dc9bd598952192fad9c1e3ee5771.png)
**SMB-Client1éªŒè¯ï¼š**
SMB-Client1éªŒè¯æˆåŠŸ
![07ce311496db7c817a75b6456f017e75.png](https://s1.imagehub.cc/images/2023/11/30/07ce311496db7c817a75b6456f017e75.png)
**SMB-Client2éªŒè¯ï¼š**
åœ¨Ubuntu"æ–‡ä»¶"-"å…¶ä»–ä½ç½®"-"è¿æ¥åˆ°æœåŠ¡å™¨ä¸­è¾“å…¥"`smb://192.168.10.181`
![e03689a49bdcc10b106fff94501ff7f5.png](https://s1.imagehub.cc/images/2023/11/30/e03689a49bdcc10b106fff94501ff7f5.png)
é€‰æ‹©"åŒ¿å"ï¼Œç„¶åç‚¹å‡»"è¿æ¥"
![0d71ee93c5eaf0ad9263f769569b1550.png](https://s1.imagehub.cc/images/2023/11/30/0d71ee93c5eaf0ad9263f769569b1550.png)
SMB-Client2éªŒè¯æˆåŠŸ
![f92bc39076681c85119c473ee66eac4c.png](https://s1.imagehub.cc/images/2023/11/30/f92bc39076681c85119c473ee66eac4c.png)

å‚è€ƒèµ„æ–™ï¼š
[Linuxæ•™ç¨‹å’Œæ–‡ç« -å¦‚ä½•åœ¨RHELã€Rocky Linuxå’ŒAlmaLinuxä¸­è®¾ç½®SambaæœåŠ¡å™¨](https://cn.linux-console.net/?p=2605 "Linuxæ•™ç¨‹å’Œæ–‡ç« -å¦‚ä½•åœ¨RHELã€Rocky Linuxå’ŒAlmaLinuxä¸­è®¾ç½®SambaæœåŠ¡å™¨")â­ï¸â­ï¸
[è‡ªå¦‚åˆ-Rocky Linux 9.1å®‰è£…Samba](https://ziruchu.com/art/541 "è‡ªå¦‚åˆ-Rocky Linux 9.1å®‰è£…Samba")ğŸ‘ğŸ‘ğŸ‘
[åšå®¢å›­-SAMBAé…ç½®æ–‡ä»¶è¯¦è§£](https://www.cnblogs.com/sswind/p/12060842.html "åšå®¢å›­-SAMBAé…ç½®æ–‡ä»¶è¯¦è§£")ğŸ‘ğŸ‘ğŸ‘
[é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº-Sambaé…ç½®æ–‡ä»¶å¸¸ç”¨å‚æ•°è¯¦è§£](https://developer.aliyun.com/article/471201#:~:text=Samba%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3%201%20config%20file%20%3D%20%2Fusr%2Flocal%2Fsamba%2Flib%2Fsmb.conf.%25m%20%E8%AF%B4%E6%98%8E%EF%BC%9Aconfig%20file%E5%8F%AF%E4%BB%A5%E8%AE%A9%E4%BD%A0%E4%BD%BF%E7%94%A8%E5%8F%A6%E4%B8%80%E4%B8%AA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%9D%A5%E8%A6%86%E7%9B%96%E7%BC%BA%E7%9C%81%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E3%80%82,Server%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E7%9A%84%E5%AD%98%E5%82%A8%E4%BD%8D%E7%BD%AE%E4%BB%A5%E5%8F%8A%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0%E3%80%82%20...%205%20logon%20.%20%3D%20%25u.bat%20 "é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº-Sambaé…ç½®æ–‡ä»¶å¸¸ç”¨å‚æ•°è¯¦è§£")ğŸ‘ğŸ‘ğŸ‘
[åšå®¢å›­-å¦‚ä½•åœ¨Linuxä¸­å‘Sambaæ·»åŠ åˆ é™¤ç”¨æˆ·](https://www.cnblogs.com/a5idc/p/13533610.html "åšå®¢å›­-å¦‚ä½•åœ¨Linuxä¸­å‘Sambaæ·»åŠ åˆ é™¤ç”¨æˆ·")ğŸ‘ğŸ‘ğŸ‘
[CSDN-ubuntu16.04é€šè¿‡ç½‘ç»œè®¿é—®windowså…±äº«æ–‡ä»¶å¤¹ï¼ˆsambaï¼‰](https://blog.csdn.net/Yemiekai/article/details/113432451#:~:text=%E4%BB%8EUbuntu%20Desktop%E8%AE%BF%E9%97%AEWindows%E4%B8%8Bsamba%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9%201%201.%20%E5%AE%89%E8%A3%85samba%20windows%E7%9A%84%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9%E8%B2%8C%E4%BC%BC%E6%98%AF%E7%94%A8%E7%9A%84%20SMB%20%E5%8D%8F%E8%AE%AE%EF%BC%8C%E6%89%80%E4%BB%A5%E5%85%88%E7%BB%99ubuntu%E8%A3%85%E4%B8%8ASMB%EF%BC%9A,%E5%88%A0%E6%8E%89%E6%95%B4%E4%B8%AA%20%3Cbookmark%3E%20%E6%A0%87%E7%AD%BE%EF%BC%9A%20gedit%20~%2F.config%2Fnautilus%2Fservers%201%20%E7%84%B6%E5%90%8E%E5%88%A0%E6%8E%89%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E9%92%A5%EF%BC%9A%20 "CSDN-ubuntu16.04é€šè¿‡ç½‘ç»œè®¿é—®windowså…±äº«æ–‡ä»¶å¤¹ï¼ˆsambaï¼‰")â­ï¸â­ï¸

# <font color=red>ã€11ã€‘Nginx HTTPæœåŠ¡é…ç½®</font>
**Nginxç®€ä»‹ï¼š**
Nginx(engine x)æ˜¯ä¸€ä¸ªè½»é‡çº§é«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªé€šç”¨ä»£ç†æœåŠ¡å™¨ ï¼ˆTCP/UDP/IMAP/POP3/SMTPï¼‰ï¼Œæœ€åˆç”±ä¿„ç½—æ–¯äººIgor Sysoevç¼–å†™
Nginxæ˜¯ä¸€æ¬¾é¢å‘æ€§èƒ½è®¾è®¡çš„HTTPæœåŠ¡å™¨ï¼Œç›¸è¾ƒäºApacheã€lighttpdå…·æœ‰å æœ‰å†…å­˜å°‘ï¼Œç¨³å®šæ€§é«˜ç­‰ä¼˜åŠ¿

**ç¯å¢ƒä»‹ç»ï¼š**
|åç§°|IPåœ°å€|æ‰®æ¼”è§’è‰²|ç³»ç»Ÿç‰ˆæœ¬|
|---|---|---|---|
|Nginx-Server|192.168.10.183|NginxæœåŠ¡å™¨|Rocky_Boot_9.3|
|Nginx-Client|192.168.10.162|Nginxå®¢æˆ·ç«¯|Windows Server 2022 Standard|
## ã€1ã€‘å®‰è£…Nginx
å‘½ä»¤ï¼š`dnf -y install nginx`

## ã€2ã€‘è°ƒæ•´é˜²ç«å¢™ç­–ç•¥
**åœ¨ç«¯å£80ä¸Šæ°¸ä¹…å¯ç”¨HTTPè¿æ¥ï¼š**
`firewall-cmd --permanent --add-service=http`
**æ›´æ–°é˜²ç«å¢™æœåŠ¡ï¼š**
`firewall-cmd --reload`
**æˆ–è€…ç›´æ¥å…³é—­é˜²ç«å¢™ï¼š**
`systemctl stop firewalld`
**ä¸´æ—¶å…³é—­SELinux(é‡å¯å¤±æ•ˆ)ï¼š**
`setenforce 0`

## ã€3ã€‘ç¼–å†™Nginxé…ç½®æ–‡ä»¶
Nginxé…ç½®æ–‡ä»¶ä½äº`/etc/nginx/nginx.conf`
å¤‡ä»½Nginxé…ç½®æ–‡ä»¶ï¼š`cp -p /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak`

**1-ç›‘å¬ç«¯å£ï¼š**
ç¬¬39è¡Œæ˜¯Nginxç›‘å¬ç«¯å£ï¼Œæˆ‘è¿™é‡Œæ›´æ”¹ä¸º8079ç«¯å£
![a615924a771b398e4cb7f9f972d8d9c8.png](https://s1.imagehub.cc/images/2023/12/07/a615924a771b398e4cb7f9f972d8d9c8.png)

å®‰è£…å®ŒNginxåï¼Œå¯åŠ¨NginxæœåŠ¡ï¼Œåœ¨æµè§ˆå™¨åœ°å€æ å†…è¾“å…¥IP+ç«¯å£å¦‚æœèƒ½æ­£å¸¸è®¿é—®é‚£å°±æ²¡é—®é¢˜ï¼Œä¸‹é¢çš„æ›´æ”¹è®¿é—®è·¯å¾„åŠé»˜è®¤æ–‡æ¡£åšä¸åšéƒ½å¯ä»¥
![22fe3cfe065938d82743b0814cb4e234.png](https://s1.imagehub.cc/images/2023/12/07/22fe3cfe065938d82743b0814cb4e234.png)

**2-è®¿é—®è·¯å¾„åŠç«™ç‚¹é»˜è®¤æ–‡æ¡£ï¼š**
æŠŠ`root`åé¢åŸæ¥çš„`/usr/share/nginx/html;`æ”¹æˆä½ ç«™ç‚¹ä¸»é¡µçš„è·¯å¾„ï¼Œè®°å¾—åŠ åˆ†å·
å¢åŠ `index`è¡Œï¼Œå¹¶åœ¨åé¢å¡«å†™ç«™ç‚¹é»˜è®¤æ–‡æ¡£æ–‡ä»¶åï¼Œä¹Ÿè¦åŠ åˆ†å·
![4fa54e94b083827dc8afa18784f2c044.png](https://s1.imagehub.cc/images/2023/12/07/4fa54e94b083827dc8afa18784f2c044.png)

## ã€4ã€‘é‡å¯NginxæœåŠ¡
é‡å¯NginxæœåŠ¡å‘½ä»¤ï¼š`systemctl restart nginx`
æŸ¥çœ‹NginxæœåŠ¡çŠ¶æ€ï¼š`systemctl status nginx`
![0b224219498e541987d8550cbdfc057a.png](https://s1.imagehub.cc/images/2023/12/07/0b224219498e541987d8550cbdfc057a.png)

## ã€5ã€‘ç¼–å†™ç«™ç‚¹é»˜è®¤æ–‡æ¡£
åœ¨ç«™ç‚¹é»˜è®¤æ–‡æ¡£å†…éšä¾¿å†™ç‚¹å†…å®¹ä»¥éªŒè¯NginxæœåŠ¡é…ç½®æˆåŠŸ
è¦†ç›–å†…å®¹åˆ°114514.htmlä¸­ï¼š`echo "114514" > /114514.html`
![7a8015c35e3fbe47139a8e6640cdfb73.png](https://s1.imagehub.cc/images/2023/12/07/7a8015c35e3fbe47139a8e6640cdfb73.png)

## ã€6ã€‘éªŒæ”¶ç¯èŠ‚â­
**æµ‹è¯•å®¢æˆ·ç«¯ä¸NginxæœåŠ¡å™¨è¿é€šæ€§ï¼š**
![47c496144cfc5346c03a6a368208fac6.png](https://s1.imagehub.cc/images/2023/12/07/47c496144cfc5346c03a6a368208fac6.png)
æµè§ˆå™¨åœ°å€æ å†…è¾“å…¥`http://192.168.10.183:8079`
![498167e3bc947ffcf443de14936e4121.png](https://s1.imagehub.cc/images/2023/12/07/498167e3bc947ffcf443de14936e4121.png)

å‚è€ƒèµ„æ–™ï¼š
[Linuxæ•™ç¨‹å’Œæ–‡ç« -å¦‚ä½•åœ¨Rocky Linux 9ä¸Šå®‰è£…Nginx](https://cn.linux-console.net/?p=6592 "Linuxæ•™ç¨‹å’Œæ–‡ç« -å¦‚ä½•åœ¨Rocky Linux 9ä¸Šå®‰è£…Nginx")ğŸ‘ğŸ‘ğŸ‘
[é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº-nginxé…ç½®æ”¹å˜é»˜è®¤è®¿é—®è·¯å¾„](https://developer.aliyun.com/article/243316 "é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº-nginxé…ç½®æ”¹å˜é»˜è®¤è®¿é—®è·¯å¾„")ğŸ‘ğŸ‘ğŸ‘
[åšå®¢å›­-Nginxé…ç½®æ–‡ä»¶è¯¦è§£](https://www.cnblogs.com/hunttown/p/5759959.html "åšå®¢å›­-Nginxé…ç½®æ–‡ä»¶è¯¦è§£")
[åšå®¢å›­-Nginxé…ç½®æ–‡ä»¶è¯¦è§£](https://www.cnblogs.com/54chensongxia/p/12938929.html "åšå®¢å›­-Nginxé…ç½®æ–‡ä»¶è¯¦è§£")
[åšå®¢å›­-nginxè¯¦ç»†å‚æ•°é…ç½®(å²ä¸Šæœ€å…¨)](https://www.cnblogs.com/hanease/p/15890509.html "åšå®¢å›­-nginxè¯¦ç»†å‚æ•°é…ç½®(å²ä¸Šæœ€å…¨)")

# <font color=red>ã€12ã€‘LinuxåŠ å…¥WindowsåŸŸ</font>
**ç¯å¢ƒä»‹ç»ï¼š**
|åç§°|IP|æ‰®æ¼”è§’è‰²|DNSæŒ‡å‘|
|---|---|---|---|
|WinSer-1|192.168.10.100|ADä¸»åŸŸæ§åˆ¶å™¨|192.168.10.100|
|RocSer-1|192.168.10.183|ADåŸŸå†…ä¸»æœº|192.168.10.100|

## ã€1ã€‘é…ç½®ADä¸»åŸŸæ§åˆ¶å™¨
å…ˆæŠŠADä¸»åŸŸæ§åˆ¶å™¨é…ç½®å¥½ï¼Œå¹¶å…³é—­å…¨éƒ¨é˜²ç«å¢™
![ccacf2c5f48550747e615fe43882471b.png](https://s1.imagehub.cc/images/2023/12/12/ccacf2c5f48550747e615fe43882471b.png)

## ã€2ã€‘ä¿®æ”¹ä¸»æœºå
`vi /etc/hostname`
![a5d47cbb93739d3339c5b2c23177fb07.png](https://s1.imagehub.cc/images/2023/12/12/a5d47cbb93739d3339c5b2c23177fb07.png)

## ã€3ã€‘å®‰è£…realmdåŒ…
å‘½ä»¤ï¼š`yum -y install realmd`
å®‰è£…å¯¹åº”è½¯ä»¶åŒ…ï¼š`yum -y install oddjob oddjob-mkhomedir sssd samba-common-tools`

## ã€4ã€‘ä¿®æ”¹æœ¬åœ°DNSç¼“å­˜
å‘½ä»¤ï¼š`vim /etc/resolv.conf`
æ³¨é‡Šæ‰ç°æœ‰çš„DNS
![7c22dc3a21db1a7e96005713caa7447a.png](https://s1.imagehub.cc/images/2023/12/12/7c22dc3a21db1a7e96005713caa7447a.png)

## ã€5ã€‘ä¿®æ”¹DNSæŒ‡å‘
å‘½ä»¤ï¼š`vi /etc/NetworkManager/system-connections/ens33.nmconnection`
DNSæŒ‡å‘ADåŸŸæ§åˆ¶å™¨IPåœ°å€
![1d544a11c3eee65afcde5924b8d58130.png](https://s1.imagehub.cc/images/2023/12/12/1d544a11c3eee65afcde5924b8d58130.png)

## ã€6ã€‘æ¿€æ´»ç½‘å¡é…ç½®
```
mcli connection load /etc/NetworkManager/system-connections/ens33.nmconnection
mcli connection up /etc/NetworkManager/system-connections/ens33.nmconnection
```

## ã€7ã€‘å…³é—­é˜²ç«å¢™åŠSELinux
å…³é—­é˜²ç«å¢™ï¼š`systemctl stop firewalld`
ä¸´æ—¶å…³é—­SELinuxï¼š`setenforce 0`

## ã€8ã€‘åŠ å…¥ADåŸŸ
è¾“å…¥`realm join --user=åŸŸè´¦å·å åŸŸå`
ç„¶åè¾“å…¥Windowsç®¡ç†å‘˜å¯†ç ï¼Œæ— æŠ¥é”™å³åŠ åŸŸæˆåŠŸ
å†æ¬¡å°è¯•åŠ åŸŸä¼šæç¤º"å·²åŠ å…¥è¯¥åŸŸ"
![2d7f986417b6b382f4a15eeca0562c85.png](https://s1.imagehub.cc/images/2023/12/12/2d7f986417b6b382f4a15eeca0562c85.png)

## ã€9ã€‘éªŒæ”¶ç¯èŠ‚
åœ¨ADä¸»åŸŸæ§åˆ¶å™¨å†…çš„ADç”¨æˆ·å’Œè®¡ç®—æœº-Computerså¯ä»¥çœ‹åˆ°åˆšæ‰åŠ è¿›å»çš„"ROCSER-1"ä¸»æœº
![bebbf4cb54bf2e6ec35f1a792c7f204f.png](https://s1.imagehub.cc/images/2023/12/12/bebbf4cb54bf2e6ec35f1a792c7f204f.png)
![269a3a1e95121f071000a905b858f61f.png](https://s1.imagehub.cc/images/2023/12/12/269a3a1e95121f071000a905b858f61f.png)
![bf4e513e52cc9db8fb6c8e80b62139f3.png](https://s1.imagehub.cc/images/2023/12/12/bf4e513e52cc9db8fb6c8e80b62139f3.png)

å‚è€ƒèµ„æ–™ï¼š
[CSDN-LinuxåŠ å…¥WindowsåŸŸ](https://blog.csdn.net/m0_57695646/article/details/122038213 "CSDN-LinuxåŠ å…¥WindowsåŸŸ")ğŸ‘ğŸ‘ğŸ‘

# <font color=red>ã€13ã€‘Tomcat HTTPé…ç½®</font>

**ç¯å¢ƒä»‹ç»ï¼š**
|åç§°|IP|æ‰®æ¼”è§’è‰²|ç³»ç»Ÿç‰ˆæœ¬|
|---|---|---|---|
|Tomcat-Server|192.168.10.181|TomcatæœåŠ¡å™¨|Rocky_Linux_9.1|
|Tomcat-Client|192.168.10.161|Tomcatå®¢æˆ·ç«¯|Windows Server 2022 Standard|

## ã€1ã€‘ä¸‹è½½Tomcat
ä½¿ç”¨`wget`ä¸‹è½½å®˜ç½‘æœ€æ–°ç‰ˆTomcat10.1.17å®‰è£…åŒ…
`wget https://dlcdn.apache.org/tomcat/tomcat-10/v10.1.17/bin/apache-tomcat-10.1.17.tar.gz`

## ã€2ã€‘è§£å‹Tomcat tar.gz
1. åœ¨`/usr/local`å†…åˆ›å»º`tomcat`æ–‡ä»¶å¤¹ï¼š
`mkdir /usr/local/tomcat`
2. è§£å‹apache-tomcat-10.1.17.tar.gzåˆ°/usr/local/tomcatç›®å½•ä¸‹
`tar -zxvf apache-tomcat-10.1.17.tar.gz -C /usr/local/tomcat`

## ã€3ã€‘å®‰è£…javaç¯å¢ƒ
Tomcatéœ€è¦javaç¯å¢ƒæ”¯æŒ
å®‰è£…javaï¼š`yum -y install java`
![06c396520d6d878dde106f35a4d60088.png](https://s1.imagehub.cc/images/2023/12/13/06c396520d6d878dde106f35a4d60088.png)

## ã€4ã€‘å¯åŠ¨Tomcat
cdåˆ°binæ–‡ä»¶å¤¹å†…ï¼š`cd /usr/local/tomcat/apache-tomcat-10.1.17/bin`
å¯åŠ¨Tomcatè„šæœ¬æ–‡ä»¶ï¼š`./startup.sh`æˆ–`sh startup.sh`
![6a0bcfff9baaadcea5ebe493f0881df4.png](https://s1.imagehub.cc/images/2023/12/13/6a0bcfff9baaadcea5ebe493f0881df4.png)
æŠ¥é”™æœªæ‰¾åˆ°æ–‡ä»¶"catalina.sh"?
ä½†æ˜¯ls -lå¯ä»¥çœ‹åˆ°"catalina.sh"?
![23c137df501c38d83da91a450f20a53c.png](https://s1.imagehub.cc/images/2023/12/13/23c137df501c38d83da91a450f20a53c.png)
åªæ˜¯"catalina.sh"æ²¡æœ‰å¯æ‰§è¡Œæƒé™è€Œå·²
`chmod +x catalina.sh`
å†æ¬¡æ‰§è¡Œ`./startup.sh`æˆ–`sh startup.sh`

```
[root@Tomcat-Server bin]# ./startup.sh
Using CATALINA_BASE:   /usr/local/tomcat/apache-tomcat-10.1.17
Using CATALINA_HOME:   /usr/local/tomcat/apache-tomcat-10.1.17
Using CATALINA_TMPDIR: /usr/local/tomcat/apache-tomcat-10.1.17/temp
Using JRE_HOME:        /usr
Using CLASSPATH:       /usr/local/tomcat/apache-tomcat-10.1.17/bin/bootstrap.jar:/usr/local/tomcat/apache-tomcat-10.1.17/bin/tomcat-juli.jar
Using CATALINA_OPTS:   
Tomcat started.
```
å‡ºç°`Tomcat started`å­—æ®µå³ä¸ºå¯åŠ¨æˆåŠŸ

## ã€5ã€‘éªŒè¯Tomcat
å…³é—­é˜²ç«å¢™ï¼š`systemctl stop firewalld`
æˆ–æ”¾è¡Œ8080ç«¯å£ï¼š`firewall-cmd --zone=public --permanent --add-port=8080/tcp`
æ›´æ–°é˜²ç«å¢™ç­–ç•¥ï¼š`firewall-cmd --reload`
> æµè§ˆå™¨åœ°å€æ å†…è¾“å…¥`TomcatæœåŠ¡å™¨IP:8080`

![5f41c5695898fd9fa79ec48757c3b650.png](https://s1.imagehub.cc/images/2023/12/13/5f41c5695898fd9fa79ec48757c3b650.png)

## ã€6ã€‘æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·å¯†ç 
è´¦æˆ·æ–‡ä»¶ä½äº`apache-tomcat-10.1.17/conf/tomcat-users.xml`æ–‡ä»¶å†…ï¼š`vi /usr/local/tomcat/apache-tomcat-10.1.17/conf/tomcat-users.xml`
åœ¨å€’æ•°ç¬¬2è¡Œå†…å†™å…¥ä»¥ä¸‹å†…å®¹
```
<role rolename="manager-gui">
<user username="username" password="password" roles="manager-gui"/>
```
![5536a7ae9fb3055352f1c21671f0f35f.png](https://s1.imagehub.cc/images/2023/12/13/5536a7ae9fb3055352f1c21671f0f35f.png)
ç°åœ¨ç‚¹å‡»"Server Status"
![50b37bfe52a3a8a7833421b41aa704a2.png](https://s1.imagehub.cc/images/2023/12/13/50b37bfe52a3a8a7833421b41aa704a2.png)
ä¼šæŠ¥é”™"401"
![b06e8c8798af8c97abb2c02da10f33d1.png](https://s1.imagehub.cc/images/2023/12/13/b06e8c8798af8c97abb2c02da10f33d1.png)
è¿™æ˜¯å› ä¸ºtomcatè¿›è¡Œäº†ipé™åˆ¶ï¼Œè¿˜éœ€è¦å°†é™åˆ¶å–æ¶ˆæ‰
`vi /etc/local/tomcat/apache-tomcat-10.1.17/webapps/manager/META-INF/context.xml`
![37198709dec6112168e22680b9941e04.png](https://s1.imagehub.cc/images/2023/12/13/37198709dec6112168e22680b9941e04.png)
åˆ·æ–°ç•Œé¢ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç å³å¯ç™»å½•
å¿˜è®°ç”¨æˆ·åæˆ–å¯†ç äº†?ï¼š`cat /usr/local/tomcat/apache-tomcat-10.1.17/conf/tomcat-users.xml`
![36502fa91f72ddaa875d71df11763645.png](https://s1.imagehub.cc/images/2023/12/13/36502fa91f72ddaa875d71df11763645.png)
![366394e14475561b239aaa2afc068191.png](https://s1.imagehub.cc/images/2023/12/13/366394e14475561b239aaa2afc068191.png)

## ã€7ã€‘æ›´æ¢ç›‘å¬ç«¯å£
`vi /usr/local/tomcat/apache-tomcat-10.1.17/conf/server.xml`
æŠŠ68è¡Œçš„`port=`å†…çš„æ•°å­—æ”¹ä¸ºä½ å–œæ¬¢çš„ç«¯å£
![6f3af18f0e85935b77c124ef2e7fc97e.png](https://s1.imagehub.cc/images/2023/12/13/6f3af18f0e85935b77c124ef2e7fc97e.png)
æ”¾è¡Œç«¯å£ï¼š`firewall-cmd --zone=public --permanent --add-port=ç«¯å£/tcp`
æ›´æ–°é˜²ç«å¢™ç­–ç•¥ï¼š`firewall-cmd --reload`

æˆ‘æŠŠtomcatè§£å‹åˆ°äº†`/usr/local/tomcat`ç›®å½•ï¼Œä½ å¦‚æœè§£å‹åˆ°äº†å…¶ä»–çš„ç›®å½•ï¼Œè¯·`cd`åˆ°é‚£ä¸ªç›®å½•è¿›è¡Œé…ç½®
> å¿˜äº†ä½ çš„è§£å‹ç›®å½•?

ä»æ ¹ç›®å½•å¼€å§‹æŸ¥æ‰¾åä¸º`server.xml`çš„æ–‡ä»¶ï¼š`find / -name "server.xml"`
![b9862473877b6251e8e3ca530d59ecac.png](https://s1.imagehub.cc/images/2023/12/13/b9862473877b6251e8e3ca530d59ecac.png)

## ã€8ã€‘æ›´æ”¹é»˜è®¤ç›®å½•
`vi /usr/local/tomcat/apache-tomcat-10.1.17/conf/server.xml`
åœ¨141è¡Œå†…çš„`appBase=`å†…ä¿®æ”¹ä¸ºç«™ç‚¹é»˜è®¤æ–‡æ¡£çš„è·¯å¾„
![db54562aed60981bfa5c43878254746a.png](https://s1.imagehub.cc/images/2023/12/13/db54562aed60981bfa5c43878254746a.png)
åœ¨wwwç›®å½•ä¸‹åˆ›å»ºROOTæ–‡ä»¶å¤¹ï¼š`mkdir -p /usr/local/tomcat/www/ROOT`
è¾“å‡º`Tomcat Yes!`åˆ°`index.html`å†…ï¼š`echo "Tomcat Yes!" > index.html`

## ã€9ã€‘éªŒæ”¶ç¯èŠ‚
åœ¨æµè§ˆå™¨åœ°å€æ å†…å¡«å†™`TomcatæœåŠ¡å™¨IP+ç«¯å£`
å¦‚æœä½ çš„ç«¯å£æ”¹çš„æ˜¯`80`çš„è¯å°±ä¸ç”¨åŠ ç«¯å£äº†ï¼Œç›´æ¥è¾“å…¥IPå³å¯
![9ce005d220cd3a90acf7d64f13026d36.png](https://s1.imagehub.cc/images/2023/12/13/9ce005d220cd3a90acf7d64f13026d36.png)

> æ³¨æ„ï¼š
å¯¹Tomcaté…ç½®æ–‡ä»¶è¿›è¡Œæ›´æ”¹åï¼Œè¦æ‰§è¡Œä¸€éconfç›®å½•ä¸‹çš„`shutdown.sh`å’Œ`startup.sh`ï¼Œå³é‡å¯TomcatæœåŠ¡
éœ€è¦cdåˆ°binæ–‡ä»¶å¤¹å†…æ‰§è¡Œï¼šcd /usr/local/tomcat/apache-tomcat-10.1.17/bin
```
./shutdown.sh
./startup.sh
```

å‚è€ƒèµ„æ–™ï¼š
[CSDN-Linuxä¸‹å¯åŠ¨ã€é…ç½®ã€ä¿®æ”¹tomcat](https://blog.csdn.net/u011435933/article/details/80748531 "CSDN-Linuxä¸‹å¯åŠ¨ã€é…ç½®ã€ä¿®æ”¹tomcat") 
[CSDN-Tomcatè®¿é—®Manager APPæŠ¥403é”™è¯¯è§£å†³æ–¹æ¡ˆ](https://blog.csdn.net/qq_36935391/article/details/81814505 "CSDN-Tomcatè®¿é—®Manager APPæŠ¥403é”™è¯¯è§£å†³æ–¹æ¡ˆ")

# <font color=red>ã€14ã€‘Keepalived+Nginxå®ç°é«˜å¯ç”¨Webè´Ÿè½½å‡è¡¡ </font>

**KeepalivedåŸç†ï¼š**
![3872e42c3153bfe568fb095443ec7b4d.png](https://s1.imagehub.cc/images/2023/12/26/3872e42c3153bfe568fb095443ec7b4d.png)
![07f6d184d7c0c0481ab675b4d8a4d664.png](https://s1.imagehub.cc/images/2023/12/26/07f6d184d7c0c0481ab675b4d8a4d664.png)
è¯¦è§ï¼š
[åšå®¢å›­-keepalivedåŸç†](https://www.cnblogs.com/aaronthon/p/9548633.html "åšå®¢å›­-keepalivedåŸç†")ğŸ‘ğŸ‘ğŸ‘
[çŸ¥ä¹-KeepalivedåŸç†ä¸å®æˆ˜](https://zhuanlan.zhihu.com/p/143295216 "çŸ¥ä¹-KeepalivedåŸç†ä¸å®æˆ˜")ğŸ‘ğŸ‘

**ç¯å¢ƒä»‹ç»ï¼š**
|åç§°|IP|æ‰®æ¼”è§’è‰²|ç³»ç»Ÿç‰ˆæœ¬|
|--|---|---|---|
|Keepalive-Master|192.168.10.191|Keepaliveä¸»æœåŠ¡å™¨|Rocky_Linux_9.1|
|Keepalive-Slave|192.168.10.192|Keepaliveå¤‡æœåŠ¡å™¨|Rocky_Linux_9.1|
|/|192.168.10.190|Keepaliveè™šæ‹ŸIP|/|
|Keepalive-Client|192.168.10.161|Nginxå®¢æˆ·ç«¯|Windows Server 2022 Standard|

## ã€1ã€‘ä¸‹è½½Keepalivedæºç 
yumåŒ…ç®¡ç†å™¨æä¾›çš„è™½ç„¶ä¹Ÿæ˜¯2.2.8ç‰ˆæœ¬çš„KeepaliveåŒ…ï¼Œä½†æ˜¯æœ‰BUGï¼Œæ‰€ä»¥æ‰ä¼šä½¿ç”¨Keepaliveæºç ç¼–è¯‘
Keepaliveå®˜ç½‘ï¼š[Keepalived for Linux](https://keepalived.org/index.html "Keepalived for Linux")
æ¥åˆ°Keepaliveå®˜ç½‘åï¼Œç‚¹å‡»"Download"
![63051241bb1d3fa3cb9e34dde301d536.png](https://s1.imagehub.cc/images/2023/12/16/63051241bb1d3fa3cb9e34dde301d536.png)
å³é”®æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå¤åˆ¶ä¸‹è½½é“¾æ¥è‡³å‰ªè´´æ¿
![4ca1610cf02cd58e0616fe961b7896e4.png](https://s1.imagehub.cc/images/2023/12/16/4ca1610cf02cd58e0616fe961b7896e4.png)
ç„¶åä½¿ç”¨`wget`å‘½ä»¤ä¸‹è½½Keepalive-v2.2.8æºç ï¼Œç­‰å¾…ä¸‹è½½å®Œæˆ
`wget https://keepalived.org/software/keepalived-2.2.8.tar.gz`
![31026f7fb944be9d11d41385323c9fa5.png](https://s1.imagehub.cc/images/2023/12/16/31026f7fb944be9d11d41385323c9fa5.png)

## ã€2ã€‘åŸºç¡€ä¾èµ–åŒ…å®‰è£…
æˆ‘åªç¼ºå°‘å‰ä¸¤æ¬¾åŸºç¡€ä¾èµ–åŒ…ï¼Œå®‰è£…å‰ä¸¤æ¬¾å³å¯
`yum -y install gcc openssl-devel`
```
yum -y install gcc
yum -y install openssl-devel
yum -y install libnl libnl-devel
yum -y install libnfnetlink-devel
yum -y install net-tools
yum -y install vim
```

## ã€3ã€‘è§£å‹Keepalivedæºç 
åœ¨/usr/localç›®å½•ä¸‹åˆ›å»ºkeepalivedæ–‡ä»¶å¤¹ï¼š`mkdir /usr/local/keepalived`
è§£å‹taråŒ…è‡³keepalivedç›®å½•ä¸‹ï¼š`tar -zxvf keepalived-2.2.8.tar.gz -C /usr/local/keepalived/`

## ã€4ã€‘ç¼–è¯‘å®‰è£…Keepalivedæºç 
é¦–å…ˆæ¥åˆ°Keepalivedå®‰è£…ç›®å½•å†…ï¼š
`cd /usr/local/keepalived/keepalived-2.2.8/`
ç”Ÿæˆmakefileæ–‡ä»¶ï¼Œå¹¶æŠŠKeepalivedå®‰è£…è‡³/etcä¸‹ï¼š
`./configure --prefix=/usr/local/keepalived --sysconf=/etc`
å®‰è£…æ‰§è¡Œï¼š
`make && make install`
æ‰§è¡Œå®Œè¿™äº›å‘½ä»¤åï¼Œå±å¹•ä¸Šä¼šä¹Œå¤®ä¹Œå¤®çš„å‡ºç°ä¸€å¤§å †å†…å®¹ï¼Œè¯·æ”¾å¿ƒï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡

## ã€5ã€‘å¤åˆ¶Keepalivedé…ç½®æ–‡ä»¶
å¦‚æœä½ ç°åœ¨ç›´æ¥å¯åŠ¨Keepalivedçš„è¯ï¼Œä¼šæŠ¥é”™é…ç½®æ–‡ä»¶ä¸¢å¤±
![0b5fa2843470746cdbde4037ac76b590.png](https://s1.imagehub.cc/images/2023/12/16/0b5fa2843470746cdbde4037ac76b590.png)
è§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦æŠŠ`/etc/keepalived`æ–‡ä»¶å¤¹ä¸‹çš„keepalivedé…ç½®æ–‡ä»¶ç¤ºä¾‹å¤åˆ¶ä¸€ä»½å³å¯
`cp -p /etc/keepalived/keepalived.conf.sample keepalived.conf`
**Slaveä¹Ÿåˆ«å¿˜äº†å¤åˆ¶ä¸€ä»½**

## ã€6ã€‘ç¼–å†™Keepalivedé…ç½®æ–‡ä»¶
`vim /etc/keepalived/keepalived.conf`
### ã€1ã€‘Master Keepalivedé…ç½®æ–‡ä»¶
**å…¨å±€å®šä¹‰æ¨¡å—ï¼š**
é™¤12è¡Œå¤–å…¨éƒ¨æ³¨é‡Šï¼Œ12è¡Œçš„`router_id`å¯ä»¥æ”¹ä¸ºåˆ«çš„åç§°ï¼Œæ¯”å¦‚Keepalived-Masterç±»ä¼¼çš„
12è¡Œçš„`router_id`ä¸ºå…¨å±€å”¯ä¸€æ ‡è¯†ï¼Œä¸èƒ½é‡å¤
![82e19fa0689dfe58c25eb63cb47b0a3e.png](https://s1.imagehub.cc/images/2023/12/16/82e19fa0689dfe58c25eb63cb47b0a3e.png)

**Nginxè„šæœ¬æ£€æµ‹æ¨¡å—ï¼š**
CVå·¥ç¨‹å¸ˆç‹‚å–œï¼š
ä¸è¦å¿˜äº†å¤åˆ¶æœ€åä¸€è¡Œçš„èŠ±æ‹¬å·

```
vrrp_script chk_nginx {
         script "/etc/keepalived/nginx_check.sh" 
         interval 2 
         weight -20 
}
```
![fe87e6e8a24875d8e73dd6e5dd601344.png](https://s1.imagehub.cc/images/2023/12/16/fe87e6e8a24875d8e73dd6e5dd601344.png)

**VRRPå®ä¾‹å®šä¹‰æ¨¡å—ï¼š**
è‡ªå·±çœ‹å›¾å§
![0656374e03910782c5299afdf656e8ee.png](https://s1.imagehub.cc/images/2023/12/16/0656374e03910782c5299afdf656e8ee.png)
åé¢çš„å†…å®¹å¯ä»¥åˆ æ‰äº†ï¼ŒæŒ‰ä¸‹"Esc"é”®ï¼Œç„¶åç‚¹å‡»`dG`å³å¯åˆ é™¤å…‰æ ‡åæ‰€æœ‰å†…å®¹
![d29ddbfccbd1e7a9ee9a824e2e4cec90.png](https://s1.imagehub.cc/images/2023/12/16/d29ddbfccbd1e7a9ee9a824e2e4cec90.png)

**é‡å¯Keepalivedå¹¶åŠ å…¥å¼€æœºè‡ªå¯ï¼š**
`systemctl restart keepalived&&systemctl enable keepalived`

**æŸ¥çœ‹KeepalivedçŠ¶æ€ï¼š**
`systemctl status keepalived`
![fc832f78469cf138ed76c871a6912fcb.png](https://s1.imagehub.cc/images/2023/12/25/fc832f78469cf138ed76c871a6912fcb.png)

### ã€2ã€‘Slave Keepalivedé…ç½®æ–‡ä»¶
BACKUPä¸MASTERé…ç½®æœ‰3å¤„ä¸åŒï¼Œå…¶ä»–åœ°æ–¹å‡æ˜¯ç›¸åŒçš„
ç¬¬1å¤„æ˜¯router idä¸MASTERä¸åŒ
ç¬¬2å¤„å°†`MASTER`æ›´æ”¹ä¸º`BACKUP`
ç¬¬3å¤„å°†ä¼˜å…ˆçº§ä¿®æ”¹ä¸ºæ¯”`MASTER`ä¼˜å…ˆçº§ä½50ç‚¹
![837dcd18cd2cd02e6a0a7b7365c776bd.png](https://s1.imagehub.cc/images/2023/12/25/837dcd18cd2cd02e6a0a7b7365c776bd.png)
**é‡å¯Keepalivedå¹¶åŠ å…¥å¼€æœºè‡ªå¯ï¼š**
`systemctl restart keepalived&&systemctl enable keepalived`

**æŸ¥çœ‹KeepalivedçŠ¶æ€ï¼š**
![b8a75de9645a029d35840286fa1b5416.png](https://s1.imagehub.cc/images/2023/12/25/b8a75de9645a029d35840286fa1b5416.png)

## ã€7ã€‘ç¼–å†™Nginxæ£€æµ‹è„šæœ¬
### ã€1ã€‘Master
è„šæœ¬è·¯å¾„å¡«å†™ä½ åœ¨Keepaliveé…ç½®æ–‡ä»¶20è¡Œä¸­å¡«å†™çš„è·¯å¾„
`vi /etc/keepalived/nginx_check.sh`
![c0d904d74ca0f3f5462dde4eab0286ae.png](https://s1.imagehub.cc/images/2023/12/25/c0d904d74ca0f3f5462dde4eab0286ae.png)
```
# vi /etc/keepalived/nginx_check.sh
#!/bin/bash
A=`ps -C nginx â€“no-header |wc -l`
if [ $A -eq 0 ];then
/usr/local/nginx/sbin/nginx
sleep 2
if [ `ps -C nginx --no-header |wc -l` -eq 0 ];then
	killall keepalived
fi
fi
```
ç„¶åç»™è„šæœ¬æ–‡ä»¶èµ‹äºˆå¯æ‰§è¡Œæƒé™
`chmod +x /etc/keepalived/nginx_check.sh`
**é‡å¯Keepalivedï¼š**
`systemctl restart keepalived`

### ã€2ã€‘Slave
![262853ed1973690ac2d752f94a3da8d2.png](https://s1.imagehub.cc/images/2023/12/25/262853ed1973690ac2d752f94a3da8d2.png)
ç„¶åç»™è„šæœ¬æ–‡ä»¶èµ‹äºˆå¯æ‰§è¡Œæƒé™
`chmod +x /etc/keepalived/nginx_check.sh`
**é‡å¯Keepalivedï¼š**
`systemctl restart keepalived`

## ã€8ã€‘Nginxé…ç½®
### ã€1ã€‘Masteré…ç½®Nginx
å®‰è£…Nginxï¼š`yum -y install nginx`
ç¼–å†™Nginxé…ç½®æ–‡ä»¶ï¼š`vi /etc/nginx/nginx.conf`
![dd51bd782a8de6589a63a3d0ce7766d0.png](https://s1.imagehub.cc/images/2023/12/25/dd51bd782a8de6589a63a3d0ce7766d0.png)
åœ¨`server_name`åå¡«å†™Keepalivedè™šæ‹ŸIP
å¦‚æœéœ€è¦æ”¹å˜Nginxä¸»é¡µçš„è¯é‚£å°±ä¿®æ”¹42,43è¡Œ

è¾“å‡ºThis is Master!åˆ°/etc/nginx/index.htmlæ–‡ä»¶å†…
`echo "This is Master!" > /etc/nginx/index.html`

é‡å¯Nginxå¹¶åŠ å…¥å¼€æœºè‡ªå¯ï¼š`systemctl restart nginx&&systemctl enable nginx`
æŸ¥çœ‹NginxçŠ¶æ€ï¼š`systemctl status nginx`
![e057db9b1a5c67fdb53c0ee4a63cf9d3.png](https://s1.imagehub.cc/images/2023/12/25/e057db9b1a5c67fdb53c0ee4a63cf9d3.png)

### ã€2ã€‘Slaveé…ç½®Nginx
å®‰è£…Nginxï¼š`yum -y install nginx`
ç¼–å†™Nginxé…ç½®æ–‡ä»¶ï¼š`vi /etc/nginx/nginx.conf`
![51776e2e57bf81fee22b6a071838725c.png](https://s1.imagehub.cc/images/2023/12/25/51776e2e57bf81fee22b6a071838725c.png)

è¾“å‡ºThis is Slave!åˆ°/etc/nginx/index.htmlæ–‡ä»¶å†…
`echo "This is Slave!" > /etc/nginx/index.html`

é‡å¯Nginxå¹¶åŠ å…¥å¼€æœºè‡ªå¯ï¼š`systemctl restart nginx&&systemctl enable nginx`
æŸ¥çœ‹NginxçŠ¶æ€ï¼š`systemctl status nginx`
![c7950c80edf03fa86ded4ac0aa15bb0d.png](https://s1.imagehub.cc/images/2023/12/25/c7950c80edf03fa86ded4ac0aa15bb0d.png)

## ã€9ã€‘éªŒæ”¶ç¯èŠ‚
å®¢æˆ·ç«¯æµè§ˆå™¨åœ°å€æ å†…è¾“å…¥Keepalivedè™šæ‹ŸIPï¼š`http://192.168.10.190`
![2ba335abe0db7feb8db533856b275e31.png](https://s1.imagehub.cc/images/2023/12/25/2ba335abe0db7feb8db533856b275e31.png)
ç„¶åæŒ‚èµ·Masterï¼Œæ¨¡æ‹ŸMasterå®•æœº
æˆ–è€…åœæ­¢KeepalivedæœåŠ¡ï¼š`systemctl stop keepalived`
![aadd60073ae13cde20326b3be59abe81.png](https://s1.imagehub.cc/images/2023/12/25/aadd60073ae13cde20326b3be59abe81.png)
å†æ¬¡åˆ·æ–°ç½‘é¡µåï¼ŒSlaveæ¥æ›¿NginxæœåŠ¡
![fedf600080a5e62f640aafeb4fab7a02.png](https://s1.imagehub.cc/images/2023/12/25/fedf600080a5e62f640aafeb4fab7a02.png)
è¿˜åŸMaster
æˆ–è€…é‡å¯KeepalivedæœåŠ¡ï¼š`systemctl restart keepalived`
![01ab02342b528fb8b454f2e47ffdcf69.png](https://s1.imagehub.cc/images/2023/12/25/01ab02342b528fb8b454f2e47ffdcf69.png)
ç”±äºMasterçš„ä¼˜å…ˆçº§ä¸º200ï¼Œæ¯”Slaveä¼˜å…ˆçº§100é«˜ï¼Œæ‰€ä»¥ç”±Masteré‡æ–°æ¥æ›¿NginxæœåŠ¡ï¼Œæœ¬æ¬¡å®éªŒæˆåŠŸ
![d097a20a58fd37ef00659ae15e9e8ade.png](https://s1.imagehub.cc/images/2023/12/25/d097a20a58fd37ef00659ae15e9e8ade.png)
F12-ç½‘ç»œï¼š
![8d6dd8aa65d7bdca53c911d07ddf60cb.png](https://s1.imagehub.cc/images/2023/12/25/8d6dd8aa65d7bdca53c911d07ddf60cb.png)

å‚è€ƒèµ„æ–™ï¼š
[CSDN-Keepalivedä¹‹â€”â€”Keepalived + Nginx å®ç°é«˜å¯ç”¨ Web è´Ÿè½½å‡è¡¡](https://blog.csdn.net/l1028386804/article/details/72801492 "CSDN-Keepalivedä¹‹â€”â€”Keepalived + Nginx å®ç°é«˜å¯ç”¨ Web è´Ÿè½½å‡è¡¡")ğŸ‘ğŸ‘ğŸ‘
[åšå®¢å›­-centos8 keepalivedå®‰è£…](https://www.cnblogs.com/chenwenchao123/p/15109290.html "åšå®¢å›­-centos8 keepalivedå®‰è£…")ğŸ‘ğŸ‘ğŸ‘
[çŸ¥ä¹-nginx(å…­) æ­é…keepalivedé«˜å¯ç”¨ã€å››å±‚è´Ÿè½½å‡è¡¡](https://zhuanlan.zhihu.com/p/455502306 "çŸ¥ä¹-nginx(å…­) æ­é…keepalivedé«˜å¯ç”¨ã€å››å±‚è´Ÿè½½å‡è¡¡")ğŸ‘ğŸ‘
[CSDN-keepalived æºç ç¼–è¯‘å®‰è£…éƒ¨ç½²](https://blog.csdn.net/qq_43584691/article/details/116483789 "CSDN-keepalived æºç ç¼–è¯‘å®‰è£…éƒ¨ç½²")
